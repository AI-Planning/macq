<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 13.1.1"/>
    <title>macq.generate.pddl API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent }nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .pdoc-alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:1rem center;margin-bottom:1rem;}.pdoc .pdoc-alert > *:last-child{margin-bottom:0;}.pdoc .pdoc-alert-note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--code);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style><script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\\(', '\\)']]
        }
    };
</script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script>
    /* Re-invoke MathJax when DOM content changes, for example during search. */
    document.addEventListener("DOMContentLoaded", () => {
        new MutationObserver(() => MathJax.typeset()).observe(
            document.querySelector("main.pdoc").parentNode,
            {childList: true}
        );
    })
</script>
<style>
    mjx-container {
        overflow-x: auto;
    }
</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../generate.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;macq.generate</a>


            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="class" href="#Generator">Generator</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Generator.__init__">Generator</a>
                        </li>
                        <li>
                                <a class="function" href="#Generator.extract_action_typing">extract_action_typing</a>
                        </li>
                        <li>
                                <a class="function" href="#Generator.extract_predicate_typing">extract_predicate_typing</a>
                        </li>
                        <li>
                                <a class="function" href="#Generator.tarski_state_to_macq">tarski_state_to_macq</a>
                        </li>
                        <li>
                                <a class="function" href="#Generator.tarski_act_to_macq">tarski_act_to_macq</a>
                        </li>
                        <li>
                                <a class="function" href="#Generator.change_init">change_init</a>
                        </li>
                        <li>
                                <a class="function" href="#Generator.change_goal">change_goal</a>
                        </li>
                        <li>
                                <a class="function" href="#Generator.generate_plan">generate_plan</a>
                        </li>
                        <li>
                                <a class="function" href="#Generator.generate_single_trace_from_plan">generate_single_trace_from_plan</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#VanillaSampling">VanillaSampling</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#VanillaSampling.__init__">VanillaSampling</a>
                        </li>
                        <li>
                                <a class="function" href="#VanillaSampling.generate_traces">generate_traces</a>
                        </li>
                        <li>
                                <a class="function" href="#VanillaSampling.generate_single_trace_setup">generate_single_trace_setup</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#TraceFromGoal">TraceFromGoal</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#TraceFromGoal.__init__">TraceFromGoal</a>
                        </li>
                        <li>
                                <a class="function" href="#TraceFromGoal.generate_trace">generate_trace</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#RandomGoalSampling">RandomGoalSampling</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#RandomGoalSampling.__init__">RandomGoalSampling</a>
                        </li>
                        <li>
                                <a class="function" href="#RandomGoalSampling.goal_sampling">goal_sampling</a>
                        </li>
                        <li>
                                <a class="function" href="#RandomGoalSampling.generate_goals_setup">generate_goals_setup</a>
                        </li>
                        <li>
                                <a class="function" href="#RandomGoalSampling.generate_traces">generate_traces</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#FDRandomWalkSampling">FDRandomWalkSampling</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#FDRandomWalkSampling.__init__">FDRandomWalkSampling</a>
                        </li>
                </ul>

            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../../macq.html">macq</a><wbr>.<a href="./../generate.html">generate</a><wbr>.pddl    </h1>

                
                        <input id="mod-pddl-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-pddl-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">1</span></a><span class="kn">from</span> <span class="nn">.generator</span> <span class="kn">import</span> <span class="n">Generator</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">2</span></a><span class="kn">from</span> <span class="nn">.vanilla_sampling</span> <span class="kn">import</span> <span class="n">VanillaSampling</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">3</span></a><span class="kn">from</span> <span class="nn">.trace_from_goal</span> <span class="kn">import</span> <span class="n">TraceFromGoal</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">4</span></a><span class="kn">from</span> <span class="nn">.random_goal_sampling</span> <span class="kn">import</span> <span class="n">RandomGoalSampling</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">5</span></a><span class="kn">from</span> <span class="nn">.fd_random_walk</span> <span class="kn">import</span> <span class="n">FDRandomWalkSampling</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">6</span></a>
</span><span id="L-7"><a href="#L-7"><span class="linenos">7</span></a><span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Generator&quot;</span><span class="p">,</span> <span class="s2">&quot;VanillaSampling&quot;</span><span class="p">,</span> <span class="s2">&quot;TraceFromGoal&quot;</span><span class="p">,</span> <span class="s2">&quot;RandomGoalSampling&quot;</span><span class="p">,</span> <span class="s2">&quot;FDRandomWalkSampling&quot;</span><span class="p">]</span>
</span></pre></div>


            </section>
                <section id="Generator">
                            <input id="Generator-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Generator</span>:

                <label class="view-source-button" for="Generator-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Generator"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Generator-44"><a href="#Generator-44"><span class="linenos"> 44</span></a><span class="k">class</span> <span class="nc">Generator</span><span class="p">:</span>
</span><span id="Generator-45"><a href="#Generator-45"><span class="linenos"> 45</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A Generator.</span>
</span><span id="Generator-46"><a href="#Generator-46"><span class="linenos"> 46</span></a>
</span><span id="Generator-47"><a href="#Generator-47"><span class="linenos"> 47</span></a><span class="sd">    A basic PDDL state trace generator. Handles all parsing and stores the problem,</span>
</span><span id="Generator-48"><a href="#Generator-48"><span class="linenos"> 48</span></a><span class="sd">    language, and grounded instance for the child generators to easily access and use.</span>
</span><span id="Generator-49"><a href="#Generator-49"><span class="linenos"> 49</span></a>
</span><span id="Generator-50"><a href="#Generator-50"><span class="linenos"> 50</span></a><span class="sd">    Attributes:</span>
</span><span id="Generator-51"><a href="#Generator-51"><span class="linenos"> 51</span></a><span class="sd">        pddl_dom (str):</span>
</span><span id="Generator-52"><a href="#Generator-52"><span class="linenos"> 52</span></a><span class="sd">            The name of the local PDDL domain filename (relevant if the problem ID is not provided.)</span>
</span><span id="Generator-53"><a href="#Generator-53"><span class="linenos"> 53</span></a><span class="sd">        pddl_prob (str):</span>
</span><span id="Generator-54"><a href="#Generator-54"><span class="linenos"> 54</span></a><span class="sd">            The name of the local PDDL problem filename (relevant if the problem ID is not provided.)</span>
</span><span id="Generator-55"><a href="#Generator-55"><span class="linenos"> 55</span></a><span class="sd">        problem_id (int):</span>
</span><span id="Generator-56"><a href="#Generator-56"><span class="linenos"> 56</span></a><span class="sd">            The ID of the problem to be accessed (relevant if local files are not provided.)</span>
</span><span id="Generator-57"><a href="#Generator-57"><span class="linenos"> 57</span></a><span class="sd">        problem (tarski.fstrips.problem.Problem):</span>
</span><span id="Generator-58"><a href="#Generator-58"><span class="linenos"> 58</span></a><span class="sd">            The problem definition.</span>
</span><span id="Generator-59"><a href="#Generator-59"><span class="linenos"> 59</span></a><span class="sd">        lang (tarski.fol.FirstOrderLanguage):</span>
</span><span id="Generator-60"><a href="#Generator-60"><span class="linenos"> 60</span></a><span class="sd">            The language definition.</span>
</span><span id="Generator-61"><a href="#Generator-61"><span class="linenos"> 61</span></a><span class="sd">        instance (GroundForwardSearchModel):</span>
</span><span id="Generator-62"><a href="#Generator-62"><span class="linenos"> 62</span></a><span class="sd">            The grounded instance of the problem.</span>
</span><span id="Generator-63"><a href="#Generator-63"><span class="linenos"> 63</span></a><span class="sd">        grounded_fluents (list):</span>
</span><span id="Generator-64"><a href="#Generator-64"><span class="linenos"> 64</span></a><span class="sd">            A list of all grounded (macq) fluents extracted from the given problem definition.</span>
</span><span id="Generator-65"><a href="#Generator-65"><span class="linenos"> 65</span></a><span class="sd">        op_dict (dict):</span>
</span><span id="Generator-66"><a href="#Generator-66"><span class="linenos"> 66</span></a><span class="sd">            The problem&#39;s ground operators, formatted to a dictionary for easy access during plan generation.</span>
</span><span id="Generator-67"><a href="#Generator-67"><span class="linenos"> 67</span></a><span class="sd">        observe_pres_effs (bool):</span>
</span><span id="Generator-68"><a href="#Generator-68"><span class="linenos"> 68</span></a><span class="sd">            Option to observe action preconditions and effects upon generation.</span>
</span><span id="Generator-69"><a href="#Generator-69"><span class="linenos"> 69</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Generator-70"><a href="#Generator-70"><span class="linenos"> 70</span></a>
</span><span id="Generator-71"><a href="#Generator-71"><span class="linenos"> 71</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="Generator-72"><a href="#Generator-72"><span class="linenos"> 72</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="Generator-73"><a href="#Generator-73"><span class="linenos"> 73</span></a>        <span class="n">dom</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Generator-74"><a href="#Generator-74"><span class="linenos"> 74</span></a>        <span class="n">prob</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Generator-75"><a href="#Generator-75"><span class="linenos"> 75</span></a>        <span class="n">problem_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Generator-76"><a href="#Generator-76"><span class="linenos"> 76</span></a>        <span class="n">observe_pres_effs</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="Generator-77"><a href="#Generator-77"><span class="linenos"> 77</span></a>    <span class="p">):</span>
</span><span id="Generator-78"><a href="#Generator-78"><span class="linenos"> 78</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Creates a basic PDDL state trace generator. Takes either the raw filenames</span>
</span><span id="Generator-79"><a href="#Generator-79"><span class="linenos"> 79</span></a><span class="sd">        of the domain and problem, or a problem ID.</span>
</span><span id="Generator-80"><a href="#Generator-80"><span class="linenos"> 80</span></a>
</span><span id="Generator-81"><a href="#Generator-81"><span class="linenos"> 81</span></a><span class="sd">        Args:</span>
</span><span id="Generator-82"><a href="#Generator-82"><span class="linenos"> 82</span></a><span class="sd">            dom (str):</span>
</span><span id="Generator-83"><a href="#Generator-83"><span class="linenos"> 83</span></a><span class="sd">                The domain filename.</span>
</span><span id="Generator-84"><a href="#Generator-84"><span class="linenos"> 84</span></a><span class="sd">            prob (str):</span>
</span><span id="Generator-85"><a href="#Generator-85"><span class="linenos"> 85</span></a><span class="sd">                The problem filename.</span>
</span><span id="Generator-86"><a href="#Generator-86"><span class="linenos"> 86</span></a><span class="sd">            problem_id (int):</span>
</span><span id="Generator-87"><a href="#Generator-87"><span class="linenos"> 87</span></a><span class="sd">                The ID of the problem to access.</span>
</span><span id="Generator-88"><a href="#Generator-88"><span class="linenos"> 88</span></a><span class="sd">            observe_pres_effs (bool):</span>
</span><span id="Generator-89"><a href="#Generator-89"><span class="linenos"> 89</span></a><span class="sd">                Option to observe action preconditions and effects upon generation.</span>
</span><span id="Generator-90"><a href="#Generator-90"><span class="linenos"> 90</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Generator-91"><a href="#Generator-91"><span class="linenos"> 91</span></a>        <span class="c1"># get attributes</span>
</span><span id="Generator-92"><a href="#Generator-92"><span class="linenos"> 92</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pddl_dom</span> <span class="o">=</span> <span class="n">dom</span>
</span><span id="Generator-93"><a href="#Generator-93"><span class="linenos"> 93</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pddl_prob</span> <span class="o">=</span> <span class="n">prob</span>
</span><span id="Generator-94"><a href="#Generator-94"><span class="linenos"> 94</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">problem_id</span> <span class="o">=</span> <span class="n">problem_id</span>
</span><span id="Generator-95"><a href="#Generator-95"><span class="linenos"> 95</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">observe_pres_effs</span> <span class="o">=</span> <span class="n">observe_pres_effs</span>
</span><span id="Generator-96"><a href="#Generator-96"><span class="linenos"> 96</span></a>        <span class="c1"># read the domain and problem</span>
</span><span id="Generator-97"><a href="#Generator-97"><span class="linenos"> 97</span></a>        <span class="n">reader</span> <span class="o">=</span> <span class="n">PDDLReader</span><span class="p">(</span><span class="n">raise_on_error</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Generator-98"><a href="#Generator-98"><span class="linenos"> 98</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">problem_id</span><span class="p">:</span>
</span><span id="Generator-99"><a href="#Generator-99"><span class="linenos"> 99</span></a>            <span class="n">reader</span><span class="o">.</span><span class="n">parse_domain</span><span class="p">(</span><span class="n">dom</span><span class="p">)</span>
</span><span id="Generator-100"><a href="#Generator-100"><span class="linenos">100</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">problem</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">parse_instance</span><span class="p">(</span><span class="n">prob</span><span class="p">)</span>
</span><span id="Generator-101"><a href="#Generator-101"><span class="linenos">101</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Generator-102"><a href="#Generator-102"><span class="linenos">102</span></a>            <span class="n">dom</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">get_problem</span><span class="p">(</span><span class="n">problem_id</span><span class="p">,</span> <span class="n">formalism</span><span class="o">=</span><span class="s1">&#39;classical&#39;</span><span class="p">)[</span><span class="s2">&quot;domain_url&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">text</span>
</span><span id="Generator-103"><a href="#Generator-103"><span class="linenos">103</span></a>            <span class="n">prob</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">get_problem</span><span class="p">(</span><span class="n">problem_id</span><span class="p">,</span> <span class="n">formalism</span><span class="o">=</span><span class="s1">&#39;classical&#39;</span><span class="p">)[</span><span class="s2">&quot;problem_url&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">text</span>
</span><span id="Generator-104"><a href="#Generator-104"><span class="linenos">104</span></a>            <span class="n">reader</span><span class="o">.</span><span class="n">parse_domain_string</span><span class="p">(</span><span class="n">dom</span><span class="p">)</span>
</span><span id="Generator-105"><a href="#Generator-105"><span class="linenos">105</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">problem</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">parse_instance_string</span><span class="p">(</span><span class="n">prob</span><span class="p">)</span>
</span><span id="Generator-106"><a href="#Generator-106"><span class="linenos">106</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">lang</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="o">.</span><span class="n">language</span>
</span><span id="Generator-107"><a href="#Generator-107"><span class="linenos">107</span></a>        <span class="c1"># ground the problem</span>
</span><span id="Generator-108"><a href="#Generator-108"><span class="linenos">108</span></a>        <span class="n">operators</span> <span class="o">=</span> <span class="n">ground_problem_schemas_into_plain_operators</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="p">)</span>
</span><span id="Generator-109"><a href="#Generator-109"><span class="linenos">109</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">instance</span> <span class="o">=</span> <span class="n">GroundForwardSearchModel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="p">,</span> <span class="n">operators</span><span class="p">)</span>
</span><span id="Generator-110"><a href="#Generator-110"><span class="linenos">110</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grounded_fluents</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_all_grounded_fluents</span><span class="p">()</span>
</span><span id="Generator-111"><a href="#Generator-111"><span class="linenos">111</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">op_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_op_dict</span><span class="p">()</span>
</span><span id="Generator-112"><a href="#Generator-112"><span class="linenos">112</span></a>
</span><span id="Generator-113"><a href="#Generator-113"><span class="linenos">113</span></a>    <span class="k">def</span> <span class="nf">extract_action_typing</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Generator-114"><a href="#Generator-114"><span class="linenos">114</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Retrieves a dictionary mapping all of this problem&#39;s actions and the types</span>
</span><span id="Generator-115"><a href="#Generator-115"><span class="linenos">115</span></a><span class="sd">        of objects they act upon.</span>
</span><span id="Generator-116"><a href="#Generator-116"><span class="linenos">116</span></a>
</span><span id="Generator-117"><a href="#Generator-117"><span class="linenos">117</span></a><span class="sd">        i.e. given the standard blocks problem/domain, this function would return:</span>
</span><span id="Generator-118"><a href="#Generator-118"><span class="linenos">118</span></a><span class="sd">        {&#39;pick-up&#39;: [&#39;object&#39;], &#39;put-down&#39;: [&#39;object&#39;], &#39;stack&#39;: [&#39;object&#39;, &#39;object&#39;],</span>
</span><span id="Generator-119"><a href="#Generator-119"><span class="linenos">119</span></a><span class="sd">        &#39;unstack&#39;: [&#39;object&#39;, &#39;object&#39;]}</span>
</span><span id="Generator-120"><a href="#Generator-120"><span class="linenos">120</span></a>
</span><span id="Generator-121"><a href="#Generator-121"><span class="linenos">121</span></a><span class="sd">        Returns:</span>
</span><span id="Generator-122"><a href="#Generator-122"><span class="linenos">122</span></a><span class="sd">            The dictionary that indicates the types of all the objects each action in</span>
</span><span id="Generator-123"><a href="#Generator-123"><span class="linenos">123</span></a><span class="sd">            the problem acts upon.</span>
</span><span id="Generator-124"><a href="#Generator-124"><span class="linenos">124</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Generator-125"><a href="#Generator-125"><span class="linenos">125</span></a>        <span class="n">extracted_act_types</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Generator-126"><a href="#Generator-126"><span class="linenos">126</span></a>        <span class="n">actions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="o">.</span><span class="n">actions</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="Generator-127"><a href="#Generator-127"><span class="linenos">127</span></a>        <span class="k">for</span> <span class="n">act</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
</span><span id="Generator-128"><a href="#Generator-128"><span class="linenos">128</span></a>            <span class="n">types</span> <span class="o">=</span> <span class="p">[</span><span class="nb">type</span><span class="o">.</span><span class="n">sort</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="nb">type</span> <span class="ow">in</span> <span class="n">act</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">variables</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>
</span><span id="Generator-129"><a href="#Generator-129"><span class="linenos">129</span></a>            <span class="n">extracted_act_types</span><span class="p">[</span><span class="n">act</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">types</span>
</span><span id="Generator-130"><a href="#Generator-130"><span class="linenos">130</span></a>        <span class="k">return</span> <span class="n">extracted_act_types</span>
</span><span id="Generator-131"><a href="#Generator-131"><span class="linenos">131</span></a>
</span><span id="Generator-132"><a href="#Generator-132"><span class="linenos">132</span></a>    <span class="k">def</span> <span class="nf">extract_predicate_typing</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Generator-133"><a href="#Generator-133"><span class="linenos">133</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Retrieves a dictionary mapping all of this problem&#39;s predicates and the types</span>
</span><span id="Generator-134"><a href="#Generator-134"><span class="linenos">134</span></a><span class="sd">        of objects they act upon.</span>
</span><span id="Generator-135"><a href="#Generator-135"><span class="linenos">135</span></a>
</span><span id="Generator-136"><a href="#Generator-136"><span class="linenos">136</span></a><span class="sd">        i.e. given the standard blocks problem/domain, this function would return:</span>
</span><span id="Generator-137"><a href="#Generator-137"><span class="linenos">137</span></a><span class="sd">        {&#39;=&#39;: [&#39;object&#39;, &#39;object&#39;], &#39;!=&#39;: [&#39;object&#39;, &#39;object&#39;], &#39;on&#39;: [&#39;object&#39;, &#39;object&#39;],</span>
</span><span id="Generator-138"><a href="#Generator-138"><span class="linenos">138</span></a><span class="sd">        &#39;ontable&#39;: [&#39;object&#39;], &#39;clear&#39;: [&#39;object&#39;], &#39;handempty&#39;: [], &#39;holding&#39;: [&#39;object&#39;]}</span>
</span><span id="Generator-139"><a href="#Generator-139"><span class="linenos">139</span></a>
</span><span id="Generator-140"><a href="#Generator-140"><span class="linenos">140</span></a><span class="sd">        Returns:</span>
</span><span id="Generator-141"><a href="#Generator-141"><span class="linenos">141</span></a><span class="sd">            The dictionary that indicates the types of all the objects each predicate in</span>
</span><span id="Generator-142"><a href="#Generator-142"><span class="linenos">142</span></a><span class="sd">            the problem acts upon.</span>
</span><span id="Generator-143"><a href="#Generator-143"><span class="linenos">143</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Generator-144"><a href="#Generator-144"><span class="linenos">144</span></a>        <span class="n">predicates</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lang</span><span class="o">.</span><span class="n">predicates</span>
</span><span id="Generator-145"><a href="#Generator-145"><span class="linenos">145</span></a>        <span class="n">extracted_pred_types</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Generator-146"><a href="#Generator-146"><span class="linenos">146</span></a>        <span class="k">for</span> <span class="n">pred</span> <span class="ow">in</span> <span class="n">predicates</span><span class="p">:</span>
</span><span id="Generator-147"><a href="#Generator-147"><span class="linenos">147</span></a>            <span class="n">info</span> <span class="o">=</span> <span class="n">pred</span><span class="o">.</span><span class="n">signature</span>
</span><span id="Generator-148"><a href="#Generator-148"><span class="linenos">148</span></a>            <span class="n">name</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Generator-149"><a href="#Generator-149"><span class="linenos">149</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">BuiltinPredicateSymbol</span><span class="p">):</span>
</span><span id="Generator-150"><a href="#Generator-150"><span class="linenos">150</span></a>                <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">value</span>
</span><span id="Generator-151"><a href="#Generator-151"><span class="linenos">151</span></a>            <span class="n">extracted_pred_types</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">type</span> <span class="k">for</span> <span class="nb">type</span> <span class="ow">in</span> <span class="n">info</span><span class="p">[</span><span class="mi">1</span><span class="p">:]]</span>
</span><span id="Generator-152"><a href="#Generator-152"><span class="linenos">152</span></a>        <span class="k">return</span> <span class="n">extracted_pred_types</span>
</span><span id="Generator-153"><a href="#Generator-153"><span class="linenos">153</span></a>
</span><span id="Generator-154"><a href="#Generator-154"><span class="linenos">154</span></a>    <span class="k">def</span> <span class="nf">__get_op_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Generator-155"><a href="#Generator-155"><span class="linenos">155</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Converts this problem&#39;s ground operators into a dictionary format so that the appropriate</span>
</span><span id="Generator-156"><a href="#Generator-156"><span class="linenos">156</span></a><span class="sd">        tarski PlainOperators can be referenced when a plan is generated (see `generate_plan`).</span>
</span><span id="Generator-157"><a href="#Generator-157"><span class="linenos">157</span></a>
</span><span id="Generator-158"><a href="#Generator-158"><span class="linenos">158</span></a><span class="sd">        Returns:</span>
</span><span id="Generator-159"><a href="#Generator-159"><span class="linenos">159</span></a><span class="sd">            The problem&#39;s ground operators, in a formatted dictionary.</span>
</span><span id="Generator-160"><a href="#Generator-160"><span class="linenos">160</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Generator-161"><a href="#Generator-161"><span class="linenos">161</span></a>        <span class="n">op_dict</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Generator-162"><a href="#Generator-162"><span class="linenos">162</span></a>        <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">instance</span><span class="o">.</span><span class="n">operators</span><span class="p">:</span>
</span><span id="Generator-163"><a href="#Generator-163"><span class="linenos">163</span></a>            <span class="c1"># special case for actions that don&#39;t take parameters</span>
</span><span id="Generator-164"><a href="#Generator-164"><span class="linenos">164</span></a>            <span class="k">if</span> <span class="s2">&quot;()&quot;</span> <span class="ow">in</span> <span class="n">o</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
</span><span id="Generator-165"><a href="#Generator-165"><span class="linenos">165</span></a>                <span class="n">op_dict</span><span class="p">[</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot;(&quot;</span><span class="p">,</span> <span class="n">o</span><span class="o">.</span><span class="n">name</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;)&quot;</span><span class="p">])]</span> <span class="o">=</span> <span class="n">o</span>
</span><span id="Generator-166"><a href="#Generator-166"><span class="linenos">166</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Generator-167"><a href="#Generator-167"><span class="linenos">167</span></a>                <span class="c1"># reformat so that operators can be referenced by the same string format the planner uses for actions</span>
</span><span id="Generator-168"><a href="#Generator-168"><span class="linenos">168</span></a>                <span class="n">op_dict</span><span class="p">[</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot;(&quot;</span><span class="p">,</span> <span class="n">o</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;(&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)])]</span> <span class="o">=</span> <span class="n">o</span>
</span><span id="Generator-169"><a href="#Generator-169"><span class="linenos">169</span></a>        <span class="k">return</span> <span class="n">op_dict</span>
</span><span id="Generator-170"><a href="#Generator-170"><span class="linenos">170</span></a>
</span><span id="Generator-171"><a href="#Generator-171"><span class="linenos">171</span></a>    <span class="k">def</span> <span class="nf">__get_all_grounded_fluents</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Generator-172"><a href="#Generator-172"><span class="linenos">172</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Extracts all the grounded fluents in the problem.</span>
</span><span id="Generator-173"><a href="#Generator-173"><span class="linenos">173</span></a>
</span><span id="Generator-174"><a href="#Generator-174"><span class="linenos">174</span></a><span class="sd">        Returns:</span>
</span><span id="Generator-175"><a href="#Generator-175"><span class="linenos">175</span></a><span class="sd">            A list of all the grounded fluents in the problem, in the form of macq Fluents.</span>
</span><span id="Generator-176"><a href="#Generator-176"><span class="linenos">176</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Generator-177"><a href="#Generator-177"><span class="linenos">177</span></a>        <span class="k">return</span> <span class="p">[</span>
</span><span id="Generator-178"><a href="#Generator-178"><span class="linenos">178</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__tarski_atom_to_macq_fluent</span><span class="p">(</span><span class="n">grounded_fluent</span><span class="o">.</span><span class="n">to_atom</span><span class="p">())</span>
</span><span id="Generator-179"><a href="#Generator-179"><span class="linenos">179</span></a>            <span class="k">for</span> <span class="n">grounded_fluent</span> <span class="ow">in</span> <span class="n">LPGroundingStrategy</span><span class="p">(</span>
</span><span id="Generator-180"><a href="#Generator-180"><span class="linenos">180</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="p">,</span> <span class="n">include_variable_inequalities</span><span class="o">=</span><span class="kc">True</span>
</span><span id="Generator-181"><a href="#Generator-181"><span class="linenos">181</span></a>            <span class="p">)</span>
</span><span id="Generator-182"><a href="#Generator-182"><span class="linenos">182</span></a>            <span class="o">.</span><span class="n">ground_state_variables</span><span class="p">()</span>
</span><span id="Generator-183"><a href="#Generator-183"><span class="linenos">183</span></a>            <span class="o">.</span><span class="n">objects</span>
</span><span id="Generator-184"><a href="#Generator-184"><span class="linenos">184</span></a>        <span class="p">]</span>
</span><span id="Generator-185"><a href="#Generator-185"><span class="linenos">185</span></a>
</span><span id="Generator-186"><a href="#Generator-186"><span class="linenos">186</span></a>    <span class="k">def</span> <span class="nf">__effect_split</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">act</span><span class="p">:</span> <span class="n">PlainOperator</span><span class="p">):</span>
</span><span id="Generator-187"><a href="#Generator-187"><span class="linenos">187</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Converts the effects of an action as defined by tarski to fluents as defined by macq.</span>
</span><span id="Generator-188"><a href="#Generator-188"><span class="linenos">188</span></a>
</span><span id="Generator-189"><a href="#Generator-189"><span class="linenos">189</span></a><span class="sd">        Args:</span>
</span><span id="Generator-190"><a href="#Generator-190"><span class="linenos">190</span></a><span class="sd">            act (PlainOperator from tarski.fstrips.action):</span>
</span><span id="Generator-191"><a href="#Generator-191"><span class="linenos">191</span></a><span class="sd">                The supplied action, defined using the tarski PlainOperator class.</span>
</span><span id="Generator-192"><a href="#Generator-192"><span class="linenos">192</span></a>
</span><span id="Generator-193"><a href="#Generator-193"><span class="linenos">193</span></a><span class="sd">        Returns:</span>
</span><span id="Generator-194"><a href="#Generator-194"><span class="linenos">194</span></a><span class="sd">            The lists of add and delete effects, in the form of a tuple macq Fluents (add, delete).</span>
</span><span id="Generator-195"><a href="#Generator-195"><span class="linenos">195</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Generator-196"><a href="#Generator-196"><span class="linenos">196</span></a>        <span class="n">effects</span> <span class="o">=</span> <span class="n">act</span><span class="o">.</span><span class="n">effects</span>
</span><span id="Generator-197"><a href="#Generator-197"><span class="linenos">197</span></a>        <span class="n">add</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="Generator-198"><a href="#Generator-198"><span class="linenos">198</span></a>        <span class="n">delete</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="Generator-199"><a href="#Generator-199"><span class="linenos">199</span></a>        <span class="k">for</span> <span class="n">effect</span> <span class="ow">in</span> <span class="n">effects</span><span class="p">:</span>
</span><span id="Generator-200"><a href="#Generator-200"><span class="linenos">200</span></a>            <span class="n">fluent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__tarski_atom_to_macq_fluent</span><span class="p">(</span><span class="n">effect</span><span class="o">.</span><span class="n">atom</span><span class="p">)</span>
</span><span id="Generator-201"><a href="#Generator-201"><span class="linenos">201</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">effect</span><span class="p">,</span> <span class="n">AddEffect</span><span class="p">):</span>
</span><span id="Generator-202"><a href="#Generator-202"><span class="linenos">202</span></a>                <span class="n">add</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">fluent</span><span class="p">)</span>
</span><span id="Generator-203"><a href="#Generator-203"><span class="linenos">203</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Generator-204"><a href="#Generator-204"><span class="linenos">204</span></a>                <span class="n">delete</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">fluent</span><span class="p">)</span>
</span><span id="Generator-205"><a href="#Generator-205"><span class="linenos">205</span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">add</span><span class="p">,</span> <span class="n">delete</span><span class="p">)</span>
</span><span id="Generator-206"><a href="#Generator-206"><span class="linenos">206</span></a>
</span><span id="Generator-207"><a href="#Generator-207"><span class="linenos">207</span></a>    <span class="k">def</span> <span class="nf">__tarski_atom_to_macq_fluent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">atom</span><span class="p">:</span> <span class="n">Atom</span><span class="p">):</span>
</span><span id="Generator-208"><a href="#Generator-208"><span class="linenos">208</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Converts a tarski Atom to a fluent as defined by macq.</span>
</span><span id="Generator-209"><a href="#Generator-209"><span class="linenos">209</span></a>
</span><span id="Generator-210"><a href="#Generator-210"><span class="linenos">210</span></a><span class="sd">        Args:</span>
</span><span id="Generator-211"><a href="#Generator-211"><span class="linenos">211</span></a><span class="sd">            atom (Atom):</span>
</span><span id="Generator-212"><a href="#Generator-212"><span class="linenos">212</span></a><span class="sd">                The supplied atom, defined using the tarski Atom class.</span>
</span><span id="Generator-213"><a href="#Generator-213"><span class="linenos">213</span></a>
</span><span id="Generator-214"><a href="#Generator-214"><span class="linenos">214</span></a><span class="sd">        Returns:</span>
</span><span id="Generator-215"><a href="#Generator-215"><span class="linenos">215</span></a><span class="sd">            A fluent, defined using the macq Fluent class.</span>
</span><span id="Generator-216"><a href="#Generator-216"><span class="linenos">216</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Generator-217"><a href="#Generator-217"><span class="linenos">217</span></a>        <span class="c1"># ignore functions for now</span>
</span><span id="Generator-218"><a href="#Generator-218"><span class="linenos">218</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">atom</span><span class="p">,</span> <span class="n">Atom</span><span class="p">):</span>
</span><span id="Generator-219"><a href="#Generator-219"><span class="linenos">219</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="Generator-220"><a href="#Generator-220"><span class="linenos">220</span></a>        <span class="n">fluent_name</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">predicate</span><span class="o">.</span><span class="n">name</span>
</span><span id="Generator-221"><a href="#Generator-221"><span class="linenos">221</span></a>        <span class="n">terms</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">subterms</span>
</span><span id="Generator-222"><a href="#Generator-222"><span class="linenos">222</span></a>        <span class="n">objects</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Generator-223"><a href="#Generator-223"><span class="linenos">223</span></a>        <span class="k">for</span> <span class="n">term</span> <span class="ow">in</span> <span class="n">terms</span><span class="p">:</span>
</span><span id="Generator-224"><a href="#Generator-224"><span class="linenos">224</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fluent_name</span><span class="p">,</span> <span class="n">BuiltinPredicateSymbol</span><span class="p">):</span>
</span><span id="Generator-225"><a href="#Generator-225"><span class="linenos">225</span></a>                <span class="n">fluent_name</span> <span class="o">=</span> <span class="n">fluent_name</span><span class="o">.</span><span class="n">value</span>
</span><span id="Generator-226"><a href="#Generator-226"><span class="linenos">226</span></a>            <span class="n">objects</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PlanningObject</span><span class="p">(</span><span class="n">term</span><span class="o">.</span><span class="n">sort</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">term</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
</span><span id="Generator-227"><a href="#Generator-227"><span class="linenos">227</span></a>        <span class="n">fluent</span> <span class="o">=</span> <span class="n">Fluent</span><span class="p">(</span><span class="n">fluent_name</span><span class="p">,</span> <span class="n">objects</span><span class="p">)</span>
</span><span id="Generator-228"><a href="#Generator-228"><span class="linenos">228</span></a>        <span class="k">return</span> <span class="n">fluent</span>
</span><span id="Generator-229"><a href="#Generator-229"><span class="linenos">229</span></a>
</span><span id="Generator-230"><a href="#Generator-230"><span class="linenos">230</span></a>    <span class="k">def</span> <span class="nf">tarski_state_to_macq</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tarski_state</span><span class="p">:</span> <span class="n">Model</span><span class="p">):</span>
</span><span id="Generator-231"><a href="#Generator-231"><span class="linenos">231</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Converts a state as defined by tarski to a state as defined by macq.</span>
</span><span id="Generator-232"><a href="#Generator-232"><span class="linenos">232</span></a>
</span><span id="Generator-233"><a href="#Generator-233"><span class="linenos">233</span></a><span class="sd">        Args:</span>
</span><span id="Generator-234"><a href="#Generator-234"><span class="linenos">234</span></a><span class="sd">            tarski_state (Model):</span>
</span><span id="Generator-235"><a href="#Generator-235"><span class="linenos">235</span></a><span class="sd">                The supplied state, defined using the tarski Model class.</span>
</span><span id="Generator-236"><a href="#Generator-236"><span class="linenos">236</span></a>
</span><span id="Generator-237"><a href="#Generator-237"><span class="linenos">237</span></a><span class="sd">        Returns:</span>
</span><span id="Generator-238"><a href="#Generator-238"><span class="linenos">238</span></a><span class="sd">            A state, defined using the macq State class.</span>
</span><span id="Generator-239"><a href="#Generator-239"><span class="linenos">239</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Generator-240"><a href="#Generator-240"><span class="linenos">240</span></a>        <span class="n">state_fluents</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Generator-241"><a href="#Generator-241"><span class="linenos">241</span></a>        <span class="n">true_fluents</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="Generator-242"><a href="#Generator-242"><span class="linenos">242</span></a>        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">tarski_state</span><span class="o">.</span><span class="n">as_atoms</span><span class="p">():</span>
</span><span id="Generator-243"><a href="#Generator-243"><span class="linenos">243</span></a>            <span class="n">fluent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__tarski_atom_to_macq_fluent</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span><span id="Generator-244"><a href="#Generator-244"><span class="linenos">244</span></a>            <span class="c1"># ignore functions for now</span>
</span><span id="Generator-245"><a href="#Generator-245"><span class="linenos">245</span></a>            <span class="k">if</span> <span class="n">fluent</span><span class="p">:</span>
</span><span id="Generator-246"><a href="#Generator-246"><span class="linenos">246</span></a>                <span class="n">true_fluents</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">fluent</span><span class="p">))</span>
</span><span id="Generator-247"><a href="#Generator-247"><span class="linenos">247</span></a>        <span class="k">for</span> <span class="n">grounded_fluent</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">grounded_fluents</span><span class="p">:</span>
</span><span id="Generator-248"><a href="#Generator-248"><span class="linenos">248</span></a>            <span class="n">state_fluents</span><span class="p">[</span><span class="n">grounded_fluent</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">grounded_fluent</span><span class="p">)</span> <span class="ow">in</span> <span class="n">true_fluents</span>
</span><span id="Generator-249"><a href="#Generator-249"><span class="linenos">249</span></a>
</span><span id="Generator-250"><a href="#Generator-250"><span class="linenos">250</span></a>        <span class="k">return</span> <span class="n">State</span><span class="p">(</span><span class="n">state_fluents</span><span class="p">)</span>
</span><span id="Generator-251"><a href="#Generator-251"><span class="linenos">251</span></a>
</span><span id="Generator-252"><a href="#Generator-252"><span class="linenos">252</span></a>    <span class="k">def</span> <span class="nf">tarski_act_to_macq</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tarski_act</span><span class="p">:</span> <span class="n">PlainOperator</span><span class="p">):</span>
</span><span id="Generator-253"><a href="#Generator-253"><span class="linenos">253</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Converts an action as defined by tarski to an action as defined by macq.</span>
</span><span id="Generator-254"><a href="#Generator-254"><span class="linenos">254</span></a>
</span><span id="Generator-255"><a href="#Generator-255"><span class="linenos">255</span></a><span class="sd">        Args:</span>
</span><span id="Generator-256"><a href="#Generator-256"><span class="linenos">256</span></a><span class="sd">            tarski_act (PlainOperator):</span>
</span><span id="Generator-257"><a href="#Generator-257"><span class="linenos">257</span></a><span class="sd">                The supplied action, defined using the tarski PlainOperator class.</span>
</span><span id="Generator-258"><a href="#Generator-258"><span class="linenos">258</span></a>
</span><span id="Generator-259"><a href="#Generator-259"><span class="linenos">259</span></a><span class="sd">        Returns:</span>
</span><span id="Generator-260"><a href="#Generator-260"><span class="linenos">260</span></a><span class="sd">            An action, defined using the macq Action class.</span>
</span><span id="Generator-261"><a href="#Generator-261"><span class="linenos">261</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Generator-262"><a href="#Generator-262"><span class="linenos">262</span></a>        <span class="n">name_split</span> <span class="o">=</span> <span class="n">tarski_act</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;)&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;(&quot;</span><span class="p">)</span>
</span><span id="Generator-263"><a href="#Generator-263"><span class="linenos">263</span></a>        <span class="n">name</span> <span class="o">=</span> <span class="n">name_split</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Generator-264"><a href="#Generator-264"><span class="linenos">264</span></a>        <span class="n">obj_names</span> <span class="o">=</span> <span class="n">name_split</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">)</span>
</span><span id="Generator-265"><a href="#Generator-265"><span class="linenos">265</span></a>
</span><span id="Generator-266"><a href="#Generator-266"><span class="linenos">266</span></a>        <span class="n">tarski_objs_mapping</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Generator-267"><a href="#Generator-267"><span class="linenos">267</span></a>        <span class="n">precond</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="Generator-268"><a href="#Generator-268"><span class="linenos">268</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tarski_act</span><span class="o">.</span><span class="n">precondition</span><span class="p">,</span> <span class="n">CompoundFormula</span><span class="p">):</span>
</span><span id="Generator-269"><a href="#Generator-269"><span class="linenos">269</span></a>            <span class="n">raw_precond</span> <span class="o">=</span> <span class="n">tarski_act</span><span class="o">.</span><span class="n">precondition</span><span class="o">.</span><span class="n">subformulas</span>
</span><span id="Generator-270"><a href="#Generator-270"><span class="linenos">270</span></a>            <span class="k">for</span> <span class="n">raw_p</span> <span class="ow">in</span> <span class="n">raw_precond</span><span class="p">:</span>
</span><span id="Generator-271"><a href="#Generator-271"><span class="linenos">271</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">raw_p</span><span class="p">,</span> <span class="n">CompoundFormula</span><span class="p">):</span>
</span><span id="Generator-272"><a href="#Generator-272"><span class="linenos">272</span></a>                    <span class="n">precond</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__tarski_atom_to_macq_fluent</span><span class="p">(</span><span class="n">raw_p</span><span class="o">.</span><span class="n">subformulas</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</span><span id="Generator-273"><a href="#Generator-273"><span class="linenos">273</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Generator-274"><a href="#Generator-274"><span class="linenos">274</span></a>                    <span class="n">precond</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__tarski_atom_to_macq_fluent</span><span class="p">(</span><span class="n">raw_p</span><span class="p">))</span>
</span><span id="Generator-275"><a href="#Generator-275"><span class="linenos">275</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Generator-276"><a href="#Generator-276"><span class="linenos">276</span></a>            <span class="n">precond</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__tarski_atom_to_macq_fluent</span><span class="p">(</span><span class="n">tarski_act</span><span class="o">.</span><span class="n">precondition</span><span class="p">))</span>
</span><span id="Generator-277"><a href="#Generator-277"><span class="linenos">277</span></a>        <span class="p">(</span><span class="n">add</span><span class="p">,</span> <span class="n">delete</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__effect_split</span><span class="p">(</span><span class="n">tarski_act</span><span class="p">)</span>
</span><span id="Generator-278"><a href="#Generator-278"><span class="linenos">278</span></a>
</span><span id="Generator-279"><a href="#Generator-279"><span class="linenos">279</span></a>        <span class="n">tarski_objs_mapping</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">o</span><span class="o">.</span><span class="n">name</span><span class="p">:</span><span class="n">o</span> <span class="k">for</span> <span class="n">fluent</span> <span class="ow">in</span> <span class="n">add</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">fluent</span><span class="o">.</span><span class="n">objects</span> <span class="p">})</span>
</span><span id="Generator-280"><a href="#Generator-280"><span class="linenos">280</span></a>        <span class="n">tarski_objs_mapping</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">o</span><span class="o">.</span><span class="n">name</span><span class="p">:</span><span class="n">o</span> <span class="k">for</span> <span class="n">fluent</span> <span class="ow">in</span> <span class="n">delete</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">fluent</span><span class="o">.</span><span class="n">objects</span> <span class="p">})</span>
</span><span id="Generator-281"><a href="#Generator-281"><span class="linenos">281</span></a>        <span class="n">tarski_objs_mapping</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">o</span><span class="o">.</span><span class="n">name</span><span class="p">:</span><span class="n">o</span> <span class="k">for</span> <span class="n">fluent</span> <span class="ow">in</span> <span class="n">precond</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">fluent</span><span class="o">.</span><span class="n">objects</span> <span class="p">})</span>
</span><span id="Generator-282"><a href="#Generator-282"><span class="linenos">282</span></a>
</span><span id="Generator-283"><a href="#Generator-283"><span class="linenos">283</span></a>        <span class="n">obj_params</span> <span class="o">=</span> <span class="p">[</span><span class="n">tarski_objs_mapping</span><span class="p">[</span><span class="n">o</span><span class="p">]</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">obj_names</span><span class="p">]</span>
</span><span id="Generator-284"><a href="#Generator-284"><span class="linenos">284</span></a>
</span><span id="Generator-285"><a href="#Generator-285"><span class="linenos">285</span></a>        <span class="k">return</span> <span class="p">(</span>
</span><span id="Generator-286"><a href="#Generator-286"><span class="linenos">286</span></a>            <span class="n">Action</span><span class="p">(</span>
</span><span id="Generator-287"><a href="#Generator-287"><span class="linenos">287</span></a>                <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
</span><span id="Generator-288"><a href="#Generator-288"><span class="linenos">288</span></a>                <span class="n">obj_params</span><span class="o">=</span><span class="n">obj_params</span><span class="p">,</span>
</span><span id="Generator-289"><a href="#Generator-289"><span class="linenos">289</span></a>                <span class="n">precond</span><span class="o">=</span><span class="n">precond</span><span class="p">,</span>
</span><span id="Generator-290"><a href="#Generator-290"><span class="linenos">290</span></a>                <span class="n">add</span><span class="o">=</span><span class="n">add</span><span class="p">,</span>
</span><span id="Generator-291"><a href="#Generator-291"><span class="linenos">291</span></a>                <span class="n">delete</span><span class="o">=</span><span class="n">delete</span><span class="p">,</span>
</span><span id="Generator-292"><a href="#Generator-292"><span class="linenos">292</span></a>            <span class="p">)</span>
</span><span id="Generator-293"><a href="#Generator-293"><span class="linenos">293</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">observe_pres_effs</span>
</span><span id="Generator-294"><a href="#Generator-294"><span class="linenos">294</span></a>            <span class="k">else</span> <span class="n">Action</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">obj_params</span><span class="o">=</span><span class="n">obj_params</span><span class="p">)</span>
</span><span id="Generator-295"><a href="#Generator-295"><span class="linenos">295</span></a>        <span class="p">)</span>
</span><span id="Generator-296"><a href="#Generator-296"><span class="linenos">296</span></a>
</span><span id="Generator-297"><a href="#Generator-297"><span class="linenos">297</span></a>    <span class="k">def</span> <span class="nf">change_init</span><span class="p">(</span>
</span><span id="Generator-298"><a href="#Generator-298"><span class="linenos">298</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="Generator-299"><a href="#Generator-299"><span class="linenos">299</span></a>        <span class="n">init_fluents</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Set</span><span class="p">[</span><span class="n">Fluent</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="n">Fluent</span><span class="p">]],</span>
</span><span id="Generator-300"><a href="#Generator-300"><span class="linenos">300</span></a>        <span class="n">new_domain</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;new_domain.pddl&quot;</span><span class="p">,</span>
</span><span id="Generator-301"><a href="#Generator-301"><span class="linenos">301</span></a>        <span class="n">new_prob</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;new_prob.pddl&quot;</span><span class="p">,</span>
</span><span id="Generator-302"><a href="#Generator-302"><span class="linenos">302</span></a>    <span class="p">):</span>
</span><span id="Generator-303"><a href="#Generator-303"><span class="linenos">303</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Changes the initial state of the `Generator`. The domain and problem PDDL files</span>
</span><span id="Generator-304"><a href="#Generator-304"><span class="linenos">304</span></a><span class="sd">        are rewritten to accomodate the new goal for later use by a planner.</span>
</span><span id="Generator-305"><a href="#Generator-305"><span class="linenos">305</span></a>
</span><span id="Generator-306"><a href="#Generator-306"><span class="linenos">306</span></a><span class="sd">        Args:</span>
</span><span id="Generator-307"><a href="#Generator-307"><span class="linenos">307</span></a><span class="sd">            init_fluents (Union[Set[Fluent], List[Fluent]]):</span>
</span><span id="Generator-308"><a href="#Generator-308"><span class="linenos">308</span></a><span class="sd">                The collection of fluents that will make up the new initial state.</span>
</span><span id="Generator-309"><a href="#Generator-309"><span class="linenos">309</span></a><span class="sd">            new_domain (str):</span>
</span><span id="Generator-310"><a href="#Generator-310"><span class="linenos">310</span></a><span class="sd">                The name of the new domain file.</span>
</span><span id="Generator-311"><a href="#Generator-311"><span class="linenos">311</span></a><span class="sd">            new_prob (str):</span>
</span><span id="Generator-312"><a href="#Generator-312"><span class="linenos">312</span></a><span class="sd">                The name of the new problem file.</span>
</span><span id="Generator-313"><a href="#Generator-313"><span class="linenos">313</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Generator-314"><a href="#Generator-314"><span class="linenos">314</span></a>        <span class="n">init</span> <span class="o">=</span> <span class="n">create</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lang</span><span class="p">)</span>
</span><span id="Generator-315"><a href="#Generator-315"><span class="linenos">315</span></a>        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">init_fluents</span><span class="p">:</span>
</span><span id="Generator-316"><a href="#Generator-316"><span class="linenos">316</span></a>            <span class="c1"># convert fluents to tarski Atoms</span>
</span><span id="Generator-317"><a href="#Generator-317"><span class="linenos">317</span></a>            <span class="n">atom</span> <span class="o">=</span> <span class="n">Atom</span><span class="p">(</span>
</span><span id="Generator-318"><a href="#Generator-318"><span class="linenos">318</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">lang</span><span class="o">.</span><span class="n">get_predicate</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">name</span><span class="p">),</span>
</span><span id="Generator-319"><a href="#Generator-319"><span class="linenos">319</span></a>                <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">lang</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">o</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">objects</span><span class="p">],</span>
</span><span id="Generator-320"><a href="#Generator-320"><span class="linenos">320</span></a>            <span class="p">)</span>
</span><span id="Generator-321"><a href="#Generator-321"><span class="linenos">321</span></a>            <span class="n">init</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">atom</span><span class="o">.</span><span class="n">predicate</span><span class="p">,</span> <span class="o">*</span><span class="n">atom</span><span class="o">.</span><span class="n">subterms</span><span class="p">)</span>
</span><span id="Generator-322"><a href="#Generator-322"><span class="linenos">322</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="o">.</span><span class="n">init</span> <span class="o">=</span> <span class="n">init</span>
</span><span id="Generator-323"><a href="#Generator-323"><span class="linenos">323</span></a>
</span><span id="Generator-324"><a href="#Generator-324"><span class="linenos">324</span></a>        <span class="c1"># rewrite PDDL files appropriately</span>
</span><span id="Generator-325"><a href="#Generator-325"><span class="linenos">325</span></a>        <span class="n">writer</span> <span class="o">=</span> <span class="n">iofs</span><span class="o">.</span><span class="n">FstripsWriter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="p">)</span>
</span><span id="Generator-326"><a href="#Generator-326"><span class="linenos">326</span></a>        <span class="n">writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">new_domain</span><span class="p">,</span> <span class="n">new_prob</span><span class="p">)</span>
</span><span id="Generator-327"><a href="#Generator-327"><span class="linenos">327</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pddl_dom</span> <span class="o">=</span> <span class="n">new_domain</span>
</span><span id="Generator-328"><a href="#Generator-328"><span class="linenos">328</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pddl_prob</span> <span class="o">=</span> <span class="n">new_prob</span>
</span><span id="Generator-329"><a href="#Generator-329"><span class="linenos">329</span></a>
</span><span id="Generator-330"><a href="#Generator-330"><span class="linenos">330</span></a>    <span class="k">def</span> <span class="nf">change_goal</span><span class="p">(</span>
</span><span id="Generator-331"><a href="#Generator-331"><span class="linenos">331</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="Generator-332"><a href="#Generator-332"><span class="linenos">332</span></a>        <span class="n">goal_fluents</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Set</span><span class="p">[</span><span class="n">Fluent</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="n">Fluent</span><span class="p">]],</span>
</span><span id="Generator-333"><a href="#Generator-333"><span class="linenos">333</span></a>        <span class="n">new_domain</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;new_domain.pddl&quot;</span><span class="p">,</span>
</span><span id="Generator-334"><a href="#Generator-334"><span class="linenos">334</span></a>        <span class="n">new_prob</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;new_prob.pddl&quot;</span><span class="p">,</span>
</span><span id="Generator-335"><a href="#Generator-335"><span class="linenos">335</span></a>    <span class="p">):</span>
</span><span id="Generator-336"><a href="#Generator-336"><span class="linenos">336</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Changes the goal of the `Generator`. The domain and problem PDDL files</span>
</span><span id="Generator-337"><a href="#Generator-337"><span class="linenos">337</span></a><span class="sd">        are rewritten to accomodate the new goal for later use by a planner.</span>
</span><span id="Generator-338"><a href="#Generator-338"><span class="linenos">338</span></a>
</span><span id="Generator-339"><a href="#Generator-339"><span class="linenos">339</span></a><span class="sd">        Args:</span>
</span><span id="Generator-340"><a href="#Generator-340"><span class="linenos">340</span></a><span class="sd">            goal_fluents (Union[Set[Fluent], List[Fluent]]):</span>
</span><span id="Generator-341"><a href="#Generator-341"><span class="linenos">341</span></a><span class="sd">                The collection of fluents that will make up the new goal.</span>
</span><span id="Generator-342"><a href="#Generator-342"><span class="linenos">342</span></a><span class="sd">            new_domain (str):</span>
</span><span id="Generator-343"><a href="#Generator-343"><span class="linenos">343</span></a><span class="sd">                The name of the new domain file.</span>
</span><span id="Generator-344"><a href="#Generator-344"><span class="linenos">344</span></a><span class="sd">            new_prob (str):</span>
</span><span id="Generator-345"><a href="#Generator-345"><span class="linenos">345</span></a><span class="sd">                The name of the new problem file.</span>
</span><span id="Generator-346"><a href="#Generator-346"><span class="linenos">346</span></a>
</span><span id="Generator-347"><a href="#Generator-347"><span class="linenos">347</span></a><span class="sd">        Raises:</span>
</span><span id="Generator-348"><a href="#Generator-348"><span class="linenos">348</span></a><span class="sd">            InvalidGoalFluent:</span>
</span><span id="Generator-349"><a href="#Generator-349"><span class="linenos">349</span></a><span class="sd">                Raised if any of the fluents supplied do not exist in this domain.</span>
</span><span id="Generator-350"><a href="#Generator-350"><span class="linenos">350</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Generator-351"><a href="#Generator-351"><span class="linenos">351</span></a>        <span class="c1"># check if the fluents to add are valid</span>
</span><span id="Generator-352"><a href="#Generator-352"><span class="linenos">352</span></a>        <span class="n">available_f</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grounded_fluents</span>
</span><span id="Generator-353"><a href="#Generator-353"><span class="linenos">353</span></a>        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">goal_fluents</span><span class="p">:</span>
</span><span id="Generator-354"><a href="#Generator-354"><span class="linenos">354</span></a>            <span class="k">if</span> <span class="n">f</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">available_f</span><span class="p">:</span>
</span><span id="Generator-355"><a href="#Generator-355"><span class="linenos">355</span></a>                <span class="k">raise</span> <span class="n">InvalidGoalFluent</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span><span id="Generator-356"><a href="#Generator-356"><span class="linenos">356</span></a>
</span><span id="Generator-357"><a href="#Generator-357"><span class="linenos">357</span></a>        <span class="c1"># convert the given set of fluents into a formula</span>
</span><span id="Generator-358"><a href="#Generator-358"><span class="linenos">358</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">goal_fluents</span><span class="p">:</span>
</span><span id="Generator-359"><a href="#Generator-359"><span class="linenos">359</span></a>            <span class="n">goal</span> <span class="o">=</span> <span class="n">land</span><span class="p">()</span>
</span><span id="Generator-360"><a href="#Generator-360"><span class="linenos">360</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Generator-361"><a href="#Generator-361"><span class="linenos">361</span></a>            <span class="n">goal</span> <span class="o">=</span> <span class="n">land</span><span class="p">(</span>
</span><span id="Generator-362"><a href="#Generator-362"><span class="linenos">362</span></a>                <span class="o">*</span><span class="p">[</span>
</span><span id="Generator-363"><a href="#Generator-363"><span class="linenos">363</span></a>                    <span class="n">Atom</span><span class="p">(</span>
</span><span id="Generator-364"><a href="#Generator-364"><span class="linenos">364</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">lang</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">name</span><span class="p">),</span>
</span><span id="Generator-365"><a href="#Generator-365"><span class="linenos">365</span></a>                        <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">lang</span><span class="o">.</span><span class="n">get_constant</span><span class="p">(</span><span class="n">o</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">objects</span><span class="p">],</span>
</span><span id="Generator-366"><a href="#Generator-366"><span class="linenos">366</span></a>                    <span class="p">)</span>
</span><span id="Generator-367"><a href="#Generator-367"><span class="linenos">367</span></a>                    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">goal_fluents</span>
</span><span id="Generator-368"><a href="#Generator-368"><span class="linenos">368</span></a>                <span class="p">]</span>
</span><span id="Generator-369"><a href="#Generator-369"><span class="linenos">369</span></a>            <span class="p">)</span>
</span><span id="Generator-370"><a href="#Generator-370"><span class="linenos">370</span></a>        <span class="c1"># reset the goal</span>
</span><span id="Generator-371"><a href="#Generator-371"><span class="linenos">371</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="o">.</span><span class="n">goal</span> <span class="o">=</span> <span class="n">flatten</span><span class="p">(</span><span class="n">goal</span><span class="p">)</span>
</span><span id="Generator-372"><a href="#Generator-372"><span class="linenos">372</span></a>
</span><span id="Generator-373"><a href="#Generator-373"><span class="linenos">373</span></a>        <span class="c1"># rewrite PDDL files appropriately</span>
</span><span id="Generator-374"><a href="#Generator-374"><span class="linenos">374</span></a>        <span class="n">writer</span> <span class="o">=</span> <span class="n">iofs</span><span class="o">.</span><span class="n">FstripsWriter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="p">)</span>
</span><span id="Generator-375"><a href="#Generator-375"><span class="linenos">375</span></a>        <span class="n">writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">new_domain</span><span class="p">,</span> <span class="n">new_prob</span><span class="p">)</span>
</span><span id="Generator-376"><a href="#Generator-376"><span class="linenos">376</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pddl_dom</span> <span class="o">=</span> <span class="n">new_domain</span>
</span><span id="Generator-377"><a href="#Generator-377"><span class="linenos">377</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pddl_prob</span> <span class="o">=</span> <span class="n">new_prob</span>
</span><span id="Generator-378"><a href="#Generator-378"><span class="linenos">378</span></a>
</span><span id="Generator-379"><a href="#Generator-379"><span class="linenos">379</span></a>    <span class="k">def</span> <span class="nf">generate_plan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">from_ipc_file</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="Generator-380"><a href="#Generator-380"><span class="linenos">380</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Generates a plan. If reading from an IPC file, the `Plan` is read directly. Otherwise, if the initial state or</span>
</span><span id="Generator-381"><a href="#Generator-381"><span class="linenos">381</span></a><span class="sd">        goal was changed, these changes are taken into account through the updated PDDL files. If no changes were made, the</span>
</span><span id="Generator-382"><a href="#Generator-382"><span class="linenos">382</span></a><span class="sd">        default nitial state/goal in the initial problem file is used.</span>
</span><span id="Generator-383"><a href="#Generator-383"><span class="linenos">383</span></a>
</span><span id="Generator-384"><a href="#Generator-384"><span class="linenos">384</span></a><span class="sd">        Args:</span>
</span><span id="Generator-385"><a href="#Generator-385"><span class="linenos">385</span></a><span class="sd">            from_ipc_file (bool):</span>
</span><span id="Generator-386"><a href="#Generator-386"><span class="linenos">386</span></a><span class="sd">                Option to read a `Plan` from an IPC file instead of the `Generator`&#39;s problem file. Defaults to False.</span>
</span><span id="Generator-387"><a href="#Generator-387"><span class="linenos">387</span></a><span class="sd">            filename (str):</span>
</span><span id="Generator-388"><a href="#Generator-388"><span class="linenos">388</span></a><span class="sd">                The name of the file to read the plan from.</span>
</span><span id="Generator-389"><a href="#Generator-389"><span class="linenos">389</span></a>
</span><span id="Generator-390"><a href="#Generator-390"><span class="linenos">390</span></a><span class="sd">        Returns:</span>
</span><span id="Generator-391"><a href="#Generator-391"><span class="linenos">391</span></a><span class="sd">            A `Plan` object that holds all the actions taken.</span>
</span><span id="Generator-392"><a href="#Generator-392"><span class="linenos">392</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Generator-393"><a href="#Generator-393"><span class="linenos">393</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">from_ipc_file</span><span class="p">:</span>
</span><span id="Generator-394"><a href="#Generator-394"><span class="linenos">394</span></a>            <span class="c1"># if the files are only being generated from the problem ID and are unaltered, retrieve the existing plan (note that</span>
</span><span id="Generator-395"><a href="#Generator-395"><span class="linenos">395</span></a>            <span class="c1"># if any changes were made, the local files would be used as the PDDL files are rewritten when changes are made).</span>
</span><span id="Generator-396"><a href="#Generator-396"><span class="linenos">396</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">problem_id</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">pddl_dom</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">pddl_prob</span><span class="p">:</span>
</span><span id="Generator-397"><a href="#Generator-397"><span class="linenos">397</span></a>                <span class="n">plan</span> <span class="o">=</span> <span class="n">get_plan</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">problem_id</span><span class="p">,</span> <span class="n">formalism</span><span class="o">=</span><span class="s1">&#39;classical&#39;</span><span class="p">)</span>
</span><span id="Generator-398"><a href="#Generator-398"><span class="linenos">398</span></a>            <span class="c1"># if you are not just using the unaltered files, use the local files instead</span>
</span><span id="Generator-399"><a href="#Generator-399"><span class="linenos">399</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Generator-400"><a href="#Generator-400"><span class="linenos">400</span></a>                <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="Generator-401"><a href="#Generator-401"><span class="linenos">401</span></a>                    <span class="s2">&quot;domain&quot;</span><span class="p">:</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pddl_dom</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span>
</span><span id="Generator-402"><a href="#Generator-402"><span class="linenos">402</span></a>                    <span class="s2">&quot;problem&quot;</span><span class="p">:</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pddl_prob</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span>
</span><span id="Generator-403"><a href="#Generator-403"><span class="linenos">403</span></a>                <span class="p">}</span>
</span><span id="Generator-404"><a href="#Generator-404"><span class="linenos">404</span></a>
</span><span id="Generator-405"><a href="#Generator-405"><span class="linenos">405</span></a>                <span class="k">def</span> <span class="nf">get_api_response</span><span class="p">(</span><span class="n">delays</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]):</span>
</span><span id="Generator-406"><a href="#Generator-406"><span class="linenos">406</span></a>                    <span class="k">if</span> <span class="n">delays</span><span class="p">:</span>
</span><span id="Generator-407"><a href="#Generator-407"><span class="linenos">407</span></a>                        <span class="n">sleep</span><span class="p">(</span><span class="n">delays</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="Generator-408"><a href="#Generator-408"><span class="linenos">408</span></a>                        <span class="k">try</span><span class="p">:</span>
</span><span id="Generator-409"><a href="#Generator-409"><span class="linenos">409</span></a>                            <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
</span><span id="Generator-410"><a href="#Generator-410"><span class="linenos">410</span></a>                                <span class="s2">&quot;http://solver.planning.domains/solve&quot;</span><span class="p">,</span>
</span><span id="Generator-411"><a href="#Generator-411"><span class="linenos">411</span></a>                                <span class="n">verify</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="Generator-412"><a href="#Generator-412"><span class="linenos">412</span></a>                                <span class="n">json</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
</span><span id="Generator-413"><a href="#Generator-413"><span class="linenos">413</span></a>                            <span class="p">)</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</span><span id="Generator-414"><a href="#Generator-414"><span class="linenos">414</span></a>                            <span class="k">return</span> <span class="p">[</span><span class="n">act</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">act</span> <span class="ow">in</span> <span class="n">resp</span><span class="p">[</span><span class="s2">&quot;result&quot;</span><span class="p">][</span><span class="s2">&quot;plan&quot;</span><span class="p">]]</span>
</span><span id="Generator-415"><a href="#Generator-415"><span class="linenos">415</span></a>                        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
</span><span id="Generator-416"><a href="#Generator-416"><span class="linenos">416</span></a>                            <span class="k">return</span> <span class="n">get_api_response</span><span class="p">(</span><span class="n">delays</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
</span><span id="Generator-417"><a href="#Generator-417"><span class="linenos">417</span></a>
</span><span id="Generator-418"><a href="#Generator-418"><span class="linenos">418</span></a>                <span class="n">plan</span> <span class="o">=</span> <span class="n">get_api_response</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
</span><span id="Generator-419"><a href="#Generator-419"><span class="linenos">419</span></a>                <span class="k">if</span> <span class="n">plan</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Generator-420"><a href="#Generator-420"><span class="linenos">420</span></a>                    <span class="k">raise</span> <span class="n">PlanningDomainsAPIError</span><span class="p">(</span>
</span><span id="Generator-421"><a href="#Generator-421"><span class="linenos">421</span></a>                        <span class="s2">&quot;Could not get a valid response from the planning.domains solver after 5 attempts.&quot;</span><span class="p">,</span>
</span><span id="Generator-422"><a href="#Generator-422"><span class="linenos">422</span></a>                    <span class="p">)</span>
</span><span id="Generator-423"><a href="#Generator-423"><span class="linenos">423</span></a>
</span><span id="Generator-424"><a href="#Generator-424"><span class="linenos">424</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Generator-425"><a href="#Generator-425"><span class="linenos">425</span></a>            <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
</span><span id="Generator-426"><a href="#Generator-426"><span class="linenos">426</span></a>            <span class="n">plan</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s2">&quot;;&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()))</span>
</span><span id="Generator-427"><a href="#Generator-427"><span class="linenos">427</span></a>
</span><span id="Generator-428"><a href="#Generator-428"><span class="linenos">428</span></a>        <span class="c1"># convert to a list of tarski PlainOperators (actions)</span>
</span><span id="Generator-429"><a href="#Generator-429"><span class="linenos">429</span></a>        <span class="k">return</span> <span class="n">Plan</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">op_dict</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">plan</span> <span class="k">if</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">op_dict</span><span class="p">])</span>
</span><span id="Generator-430"><a href="#Generator-430"><span class="linenos">430</span></a>
</span><span id="Generator-431"><a href="#Generator-431"><span class="linenos">431</span></a>    <span class="k">def</span> <span class="nf">generate_single_trace_from_plan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plan</span><span class="p">:</span> <span class="n">Plan</span><span class="p">):</span>
</span><span id="Generator-432"><a href="#Generator-432"><span class="linenos">432</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Generates a single trace from the plan taken as input.</span>
</span><span id="Generator-433"><a href="#Generator-433"><span class="linenos">433</span></a>
</span><span id="Generator-434"><a href="#Generator-434"><span class="linenos">434</span></a><span class="sd">        Args:</span>
</span><span id="Generator-435"><a href="#Generator-435"><span class="linenos">435</span></a><span class="sd">            plan (Plan):</span>
</span><span id="Generator-436"><a href="#Generator-436"><span class="linenos">436</span></a><span class="sd">                The plan to generate a trace from.</span>
</span><span id="Generator-437"><a href="#Generator-437"><span class="linenos">437</span></a>
</span><span id="Generator-438"><a href="#Generator-438"><span class="linenos">438</span></a><span class="sd">        Returns:</span>
</span><span id="Generator-439"><a href="#Generator-439"><span class="linenos">439</span></a><span class="sd">            The trace generated from the plan.</span>
</span><span id="Generator-440"><a href="#Generator-440"><span class="linenos">440</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Generator-441"><a href="#Generator-441"><span class="linenos">441</span></a>        <span class="n">trace</span> <span class="o">=</span> <span class="n">Trace</span><span class="p">()</span>
</span><span id="Generator-442"><a href="#Generator-442"><span class="linenos">442</span></a>        <span class="n">actions</span> <span class="o">=</span> <span class="n">plan</span><span class="o">.</span><span class="n">actions</span>
</span><span id="Generator-443"><a href="#Generator-443"><span class="linenos">443</span></a>        <span class="n">plan_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">actions</span><span class="p">)</span>
</span><span id="Generator-444"><a href="#Generator-444"><span class="linenos">444</span></a>        <span class="c1"># get initial state</span>
</span><span id="Generator-445"><a href="#Generator-445"><span class="linenos">445</span></a>        <span class="n">state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="o">.</span><span class="n">init</span>
</span><span id="Generator-446"><a href="#Generator-446"><span class="linenos">446</span></a>        <span class="c1"># note that we add 1 because the states represented take place BEFORE their subsequent action,</span>
</span><span id="Generator-447"><a href="#Generator-447"><span class="linenos">447</span></a>        <span class="c1"># so if we need to take x actions, we need x + 1 states and therefore x + 1 steps in the trace.</span>
</span><span id="Generator-448"><a href="#Generator-448"><span class="linenos">448</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">plan_len</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="Generator-449"><a href="#Generator-449"><span class="linenos">449</span></a>            <span class="n">macq_state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarski_state_to_macq</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
</span><span id="Generator-450"><a href="#Generator-450"><span class="linenos">450</span></a>            <span class="c1"># if we have not yet reached the end of the trace</span>
</span><span id="Generator-451"><a href="#Generator-451"><span class="linenos">451</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">trace</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">plan_len</span><span class="p">:</span>
</span><span id="Generator-452"><a href="#Generator-452"><span class="linenos">452</span></a>                <span class="n">act</span> <span class="o">=</span> <span class="n">actions</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="Generator-453"><a href="#Generator-453"><span class="linenos">453</span></a>                <span class="n">trace</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Step</span><span class="p">(</span><span class="n">macq_state</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarski_act_to_macq</span><span class="p">(</span><span class="n">act</span><span class="p">),</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="Generator-454"><a href="#Generator-454"><span class="linenos">454</span></a>                <span class="n">state</span> <span class="o">=</span> <span class="n">progress</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">act</span><span class="p">)</span>
</span><span id="Generator-455"><a href="#Generator-455"><span class="linenos">455</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Generator-456"><a href="#Generator-456"><span class="linenos">456</span></a>                <span class="n">trace</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Step</span><span class="p">(</span><span class="n">macq_state</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="Generator-457"><a href="#Generator-457"><span class="linenos">457</span></a>        <span class="k">return</span> <span class="n">trace</span>
</span></pre></div>


            <div class="docstring"><p>A Generator.</p>

<p>A basic PDDL state trace generator. Handles all parsing and stores the problem,
language, and grounded instance for the child generators to easily access and use.</p>

<p>Attributes:
    pddl_dom (str):
        The name of the local PDDL domain filename (relevant if the problem ID is not provided.)
    pddl_prob (str):
        The name of the local PDDL problem filename (relevant if the problem ID is not provided.)
    problem_id (int):
        The ID of the problem to be accessed (relevant if local files are not provided.)
    problem (tarski.fstrips.problem.Problem):
        The problem definition.
    lang (tarski.fol.FirstOrderLanguage):
        The language definition.
    instance (GroundForwardSearchModel):
        The grounded instance of the problem.
    grounded_fluents (list):
        A list of all grounded (macq) fluents extracted from the given problem definition.
    op_dict (dict):
        The problem's ground operators, formatted to a dictionary for easy access during plan generation.
    observe_pres_effs (bool):
        Option to observe action preconditions and effects upon generation.</p>
</div>


                            <div id="Generator.__init__" class="classattr">
                                        <input id="Generator.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Generator</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">dom</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">prob</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">problem_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">observe_pres_effs</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span>)</span>

                <label class="view-source-button" for="Generator.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Generator.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Generator.__init__-71"><a href="#Generator.__init__-71"><span class="linenos"> 71</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="Generator.__init__-72"><a href="#Generator.__init__-72"><span class="linenos"> 72</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="Generator.__init__-73"><a href="#Generator.__init__-73"><span class="linenos"> 73</span></a>        <span class="n">dom</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Generator.__init__-74"><a href="#Generator.__init__-74"><span class="linenos"> 74</span></a>        <span class="n">prob</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Generator.__init__-75"><a href="#Generator.__init__-75"><span class="linenos"> 75</span></a>        <span class="n">problem_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Generator.__init__-76"><a href="#Generator.__init__-76"><span class="linenos"> 76</span></a>        <span class="n">observe_pres_effs</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="Generator.__init__-77"><a href="#Generator.__init__-77"><span class="linenos"> 77</span></a>    <span class="p">):</span>
</span><span id="Generator.__init__-78"><a href="#Generator.__init__-78"><span class="linenos"> 78</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Creates a basic PDDL state trace generator. Takes either the raw filenames</span>
</span><span id="Generator.__init__-79"><a href="#Generator.__init__-79"><span class="linenos"> 79</span></a><span class="sd">        of the domain and problem, or a problem ID.</span>
</span><span id="Generator.__init__-80"><a href="#Generator.__init__-80"><span class="linenos"> 80</span></a>
</span><span id="Generator.__init__-81"><a href="#Generator.__init__-81"><span class="linenos"> 81</span></a><span class="sd">        Args:</span>
</span><span id="Generator.__init__-82"><a href="#Generator.__init__-82"><span class="linenos"> 82</span></a><span class="sd">            dom (str):</span>
</span><span id="Generator.__init__-83"><a href="#Generator.__init__-83"><span class="linenos"> 83</span></a><span class="sd">                The domain filename.</span>
</span><span id="Generator.__init__-84"><a href="#Generator.__init__-84"><span class="linenos"> 84</span></a><span class="sd">            prob (str):</span>
</span><span id="Generator.__init__-85"><a href="#Generator.__init__-85"><span class="linenos"> 85</span></a><span class="sd">                The problem filename.</span>
</span><span id="Generator.__init__-86"><a href="#Generator.__init__-86"><span class="linenos"> 86</span></a><span class="sd">            problem_id (int):</span>
</span><span id="Generator.__init__-87"><a href="#Generator.__init__-87"><span class="linenos"> 87</span></a><span class="sd">                The ID of the problem to access.</span>
</span><span id="Generator.__init__-88"><a href="#Generator.__init__-88"><span class="linenos"> 88</span></a><span class="sd">            observe_pres_effs (bool):</span>
</span><span id="Generator.__init__-89"><a href="#Generator.__init__-89"><span class="linenos"> 89</span></a><span class="sd">                Option to observe action preconditions and effects upon generation.</span>
</span><span id="Generator.__init__-90"><a href="#Generator.__init__-90"><span class="linenos"> 90</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Generator.__init__-91"><a href="#Generator.__init__-91"><span class="linenos"> 91</span></a>        <span class="c1"># get attributes</span>
</span><span id="Generator.__init__-92"><a href="#Generator.__init__-92"><span class="linenos"> 92</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pddl_dom</span> <span class="o">=</span> <span class="n">dom</span>
</span><span id="Generator.__init__-93"><a href="#Generator.__init__-93"><span class="linenos"> 93</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pddl_prob</span> <span class="o">=</span> <span class="n">prob</span>
</span><span id="Generator.__init__-94"><a href="#Generator.__init__-94"><span class="linenos"> 94</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">problem_id</span> <span class="o">=</span> <span class="n">problem_id</span>
</span><span id="Generator.__init__-95"><a href="#Generator.__init__-95"><span class="linenos"> 95</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">observe_pres_effs</span> <span class="o">=</span> <span class="n">observe_pres_effs</span>
</span><span id="Generator.__init__-96"><a href="#Generator.__init__-96"><span class="linenos"> 96</span></a>        <span class="c1"># read the domain and problem</span>
</span><span id="Generator.__init__-97"><a href="#Generator.__init__-97"><span class="linenos"> 97</span></a>        <span class="n">reader</span> <span class="o">=</span> <span class="n">PDDLReader</span><span class="p">(</span><span class="n">raise_on_error</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Generator.__init__-98"><a href="#Generator.__init__-98"><span class="linenos"> 98</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">problem_id</span><span class="p">:</span>
</span><span id="Generator.__init__-99"><a href="#Generator.__init__-99"><span class="linenos"> 99</span></a>            <span class="n">reader</span><span class="o">.</span><span class="n">parse_domain</span><span class="p">(</span><span class="n">dom</span><span class="p">)</span>
</span><span id="Generator.__init__-100"><a href="#Generator.__init__-100"><span class="linenos">100</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">problem</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">parse_instance</span><span class="p">(</span><span class="n">prob</span><span class="p">)</span>
</span><span id="Generator.__init__-101"><a href="#Generator.__init__-101"><span class="linenos">101</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Generator.__init__-102"><a href="#Generator.__init__-102"><span class="linenos">102</span></a>            <span class="n">dom</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">get_problem</span><span class="p">(</span><span class="n">problem_id</span><span class="p">,</span> <span class="n">formalism</span><span class="o">=</span><span class="s1">&#39;classical&#39;</span><span class="p">)[</span><span class="s2">&quot;domain_url&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">text</span>
</span><span id="Generator.__init__-103"><a href="#Generator.__init__-103"><span class="linenos">103</span></a>            <span class="n">prob</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">get_problem</span><span class="p">(</span><span class="n">problem_id</span><span class="p">,</span> <span class="n">formalism</span><span class="o">=</span><span class="s1">&#39;classical&#39;</span><span class="p">)[</span><span class="s2">&quot;problem_url&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">text</span>
</span><span id="Generator.__init__-104"><a href="#Generator.__init__-104"><span class="linenos">104</span></a>            <span class="n">reader</span><span class="o">.</span><span class="n">parse_domain_string</span><span class="p">(</span><span class="n">dom</span><span class="p">)</span>
</span><span id="Generator.__init__-105"><a href="#Generator.__init__-105"><span class="linenos">105</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">problem</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">parse_instance_string</span><span class="p">(</span><span class="n">prob</span><span class="p">)</span>
</span><span id="Generator.__init__-106"><a href="#Generator.__init__-106"><span class="linenos">106</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">lang</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="o">.</span><span class="n">language</span>
</span><span id="Generator.__init__-107"><a href="#Generator.__init__-107"><span class="linenos">107</span></a>        <span class="c1"># ground the problem</span>
</span><span id="Generator.__init__-108"><a href="#Generator.__init__-108"><span class="linenos">108</span></a>        <span class="n">operators</span> <span class="o">=</span> <span class="n">ground_problem_schemas_into_plain_operators</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="p">)</span>
</span><span id="Generator.__init__-109"><a href="#Generator.__init__-109"><span class="linenos">109</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">instance</span> <span class="o">=</span> <span class="n">GroundForwardSearchModel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="p">,</span> <span class="n">operators</span><span class="p">)</span>
</span><span id="Generator.__init__-110"><a href="#Generator.__init__-110"><span class="linenos">110</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grounded_fluents</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_all_grounded_fluents</span><span class="p">()</span>
</span><span id="Generator.__init__-111"><a href="#Generator.__init__-111"><span class="linenos">111</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">op_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_op_dict</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Creates a basic PDDL state trace generator. Takes either the raw filenames
of the domain and problem, or a problem ID.</p>

<p>Args:
    dom (str):
        The domain filename.
    prob (str):
        The problem filename.
    problem_id (int):
        The ID of the problem to access.
    observe_pres_effs (bool):
        Option to observe action preconditions and effects upon generation.</p>
</div>


                            </div>
                            <div id="Generator.extract_action_typing" class="classattr">
                                        <input id="Generator.extract_action_typing-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">extract_action_typing</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Generator.extract_action_typing-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Generator.extract_action_typing"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Generator.extract_action_typing-113"><a href="#Generator.extract_action_typing-113"><span class="linenos">113</span></a>    <span class="k">def</span> <span class="nf">extract_action_typing</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Generator.extract_action_typing-114"><a href="#Generator.extract_action_typing-114"><span class="linenos">114</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Retrieves a dictionary mapping all of this problem&#39;s actions and the types</span>
</span><span id="Generator.extract_action_typing-115"><a href="#Generator.extract_action_typing-115"><span class="linenos">115</span></a><span class="sd">        of objects they act upon.</span>
</span><span id="Generator.extract_action_typing-116"><a href="#Generator.extract_action_typing-116"><span class="linenos">116</span></a>
</span><span id="Generator.extract_action_typing-117"><a href="#Generator.extract_action_typing-117"><span class="linenos">117</span></a><span class="sd">        i.e. given the standard blocks problem/domain, this function would return:</span>
</span><span id="Generator.extract_action_typing-118"><a href="#Generator.extract_action_typing-118"><span class="linenos">118</span></a><span class="sd">        {&#39;pick-up&#39;: [&#39;object&#39;], &#39;put-down&#39;: [&#39;object&#39;], &#39;stack&#39;: [&#39;object&#39;, &#39;object&#39;],</span>
</span><span id="Generator.extract_action_typing-119"><a href="#Generator.extract_action_typing-119"><span class="linenos">119</span></a><span class="sd">        &#39;unstack&#39;: [&#39;object&#39;, &#39;object&#39;]}</span>
</span><span id="Generator.extract_action_typing-120"><a href="#Generator.extract_action_typing-120"><span class="linenos">120</span></a>
</span><span id="Generator.extract_action_typing-121"><a href="#Generator.extract_action_typing-121"><span class="linenos">121</span></a><span class="sd">        Returns:</span>
</span><span id="Generator.extract_action_typing-122"><a href="#Generator.extract_action_typing-122"><span class="linenos">122</span></a><span class="sd">            The dictionary that indicates the types of all the objects each action in</span>
</span><span id="Generator.extract_action_typing-123"><a href="#Generator.extract_action_typing-123"><span class="linenos">123</span></a><span class="sd">            the problem acts upon.</span>
</span><span id="Generator.extract_action_typing-124"><a href="#Generator.extract_action_typing-124"><span class="linenos">124</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Generator.extract_action_typing-125"><a href="#Generator.extract_action_typing-125"><span class="linenos">125</span></a>        <span class="n">extracted_act_types</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Generator.extract_action_typing-126"><a href="#Generator.extract_action_typing-126"><span class="linenos">126</span></a>        <span class="n">actions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="o">.</span><span class="n">actions</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="Generator.extract_action_typing-127"><a href="#Generator.extract_action_typing-127"><span class="linenos">127</span></a>        <span class="k">for</span> <span class="n">act</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
</span><span id="Generator.extract_action_typing-128"><a href="#Generator.extract_action_typing-128"><span class="linenos">128</span></a>            <span class="n">types</span> <span class="o">=</span> <span class="p">[</span><span class="nb">type</span><span class="o">.</span><span class="n">sort</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="nb">type</span> <span class="ow">in</span> <span class="n">act</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">variables</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>
</span><span id="Generator.extract_action_typing-129"><a href="#Generator.extract_action_typing-129"><span class="linenos">129</span></a>            <span class="n">extracted_act_types</span><span class="p">[</span><span class="n">act</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">types</span>
</span><span id="Generator.extract_action_typing-130"><a href="#Generator.extract_action_typing-130"><span class="linenos">130</span></a>        <span class="k">return</span> <span class="n">extracted_act_types</span>
</span></pre></div>


            <div class="docstring"><p>Retrieves a dictionary mapping all of this problem's actions and the types
of objects they act upon.</p>

<p>i.e. given the standard blocks problem/domain, this function would return:
{'pick-up': ['object'], 'put-down': ['object'], 'stack': ['object', 'object'],
'unstack': ['object', 'object']}</p>

<p>Returns:
    The dictionary that indicates the types of all the objects each action in
    the problem acts upon.</p>
</div>


                            </div>
                            <div id="Generator.extract_predicate_typing" class="classattr">
                                        <input id="Generator.extract_predicate_typing-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">extract_predicate_typing</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Generator.extract_predicate_typing-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Generator.extract_predicate_typing"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Generator.extract_predicate_typing-132"><a href="#Generator.extract_predicate_typing-132"><span class="linenos">132</span></a>    <span class="k">def</span> <span class="nf">extract_predicate_typing</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Generator.extract_predicate_typing-133"><a href="#Generator.extract_predicate_typing-133"><span class="linenos">133</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Retrieves a dictionary mapping all of this problem&#39;s predicates and the types</span>
</span><span id="Generator.extract_predicate_typing-134"><a href="#Generator.extract_predicate_typing-134"><span class="linenos">134</span></a><span class="sd">        of objects they act upon.</span>
</span><span id="Generator.extract_predicate_typing-135"><a href="#Generator.extract_predicate_typing-135"><span class="linenos">135</span></a>
</span><span id="Generator.extract_predicate_typing-136"><a href="#Generator.extract_predicate_typing-136"><span class="linenos">136</span></a><span class="sd">        i.e. given the standard blocks problem/domain, this function would return:</span>
</span><span id="Generator.extract_predicate_typing-137"><a href="#Generator.extract_predicate_typing-137"><span class="linenos">137</span></a><span class="sd">        {&#39;=&#39;: [&#39;object&#39;, &#39;object&#39;], &#39;!=&#39;: [&#39;object&#39;, &#39;object&#39;], &#39;on&#39;: [&#39;object&#39;, &#39;object&#39;],</span>
</span><span id="Generator.extract_predicate_typing-138"><a href="#Generator.extract_predicate_typing-138"><span class="linenos">138</span></a><span class="sd">        &#39;ontable&#39;: [&#39;object&#39;], &#39;clear&#39;: [&#39;object&#39;], &#39;handempty&#39;: [], &#39;holding&#39;: [&#39;object&#39;]}</span>
</span><span id="Generator.extract_predicate_typing-139"><a href="#Generator.extract_predicate_typing-139"><span class="linenos">139</span></a>
</span><span id="Generator.extract_predicate_typing-140"><a href="#Generator.extract_predicate_typing-140"><span class="linenos">140</span></a><span class="sd">        Returns:</span>
</span><span id="Generator.extract_predicate_typing-141"><a href="#Generator.extract_predicate_typing-141"><span class="linenos">141</span></a><span class="sd">            The dictionary that indicates the types of all the objects each predicate in</span>
</span><span id="Generator.extract_predicate_typing-142"><a href="#Generator.extract_predicate_typing-142"><span class="linenos">142</span></a><span class="sd">            the problem acts upon.</span>
</span><span id="Generator.extract_predicate_typing-143"><a href="#Generator.extract_predicate_typing-143"><span class="linenos">143</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Generator.extract_predicate_typing-144"><a href="#Generator.extract_predicate_typing-144"><span class="linenos">144</span></a>        <span class="n">predicates</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lang</span><span class="o">.</span><span class="n">predicates</span>
</span><span id="Generator.extract_predicate_typing-145"><a href="#Generator.extract_predicate_typing-145"><span class="linenos">145</span></a>        <span class="n">extracted_pred_types</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Generator.extract_predicate_typing-146"><a href="#Generator.extract_predicate_typing-146"><span class="linenos">146</span></a>        <span class="k">for</span> <span class="n">pred</span> <span class="ow">in</span> <span class="n">predicates</span><span class="p">:</span>
</span><span id="Generator.extract_predicate_typing-147"><a href="#Generator.extract_predicate_typing-147"><span class="linenos">147</span></a>            <span class="n">info</span> <span class="o">=</span> <span class="n">pred</span><span class="o">.</span><span class="n">signature</span>
</span><span id="Generator.extract_predicate_typing-148"><a href="#Generator.extract_predicate_typing-148"><span class="linenos">148</span></a>            <span class="n">name</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Generator.extract_predicate_typing-149"><a href="#Generator.extract_predicate_typing-149"><span class="linenos">149</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">BuiltinPredicateSymbol</span><span class="p">):</span>
</span><span id="Generator.extract_predicate_typing-150"><a href="#Generator.extract_predicate_typing-150"><span class="linenos">150</span></a>                <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">value</span>
</span><span id="Generator.extract_predicate_typing-151"><a href="#Generator.extract_predicate_typing-151"><span class="linenos">151</span></a>            <span class="n">extracted_pred_types</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">type</span> <span class="k">for</span> <span class="nb">type</span> <span class="ow">in</span> <span class="n">info</span><span class="p">[</span><span class="mi">1</span><span class="p">:]]</span>
</span><span id="Generator.extract_predicate_typing-152"><a href="#Generator.extract_predicate_typing-152"><span class="linenos">152</span></a>        <span class="k">return</span> <span class="n">extracted_pred_types</span>
</span></pre></div>


            <div class="docstring"><p>Retrieves a dictionary mapping all of this problem's predicates and the types
of objects they act upon.</p>

<p>i.e. given the standard blocks problem/domain, this function would return:
{'=': ['object', 'object'], '!=': ['object', 'object'], 'on': ['object', 'object'],
'ontable': ['object'], 'clear': ['object'], 'handempty': [], 'holding': ['object']}</p>

<p>Returns:
    The dictionary that indicates the types of all the objects each predicate in
    the problem acts upon.</p>
</div>


                            </div>
                            <div id="Generator.tarski_state_to_macq" class="classattr">
                                        <input id="Generator.tarski_state_to_macq-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">tarski_state_to_macq</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">tarski_state</span><span class="p">:</span> <span class="n">tarski</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">Model</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Generator.tarski_state_to_macq-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Generator.tarski_state_to_macq"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Generator.tarski_state_to_macq-230"><a href="#Generator.tarski_state_to_macq-230"><span class="linenos">230</span></a>    <span class="k">def</span> <span class="nf">tarski_state_to_macq</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tarski_state</span><span class="p">:</span> <span class="n">Model</span><span class="p">):</span>
</span><span id="Generator.tarski_state_to_macq-231"><a href="#Generator.tarski_state_to_macq-231"><span class="linenos">231</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Converts a state as defined by tarski to a state as defined by macq.</span>
</span><span id="Generator.tarski_state_to_macq-232"><a href="#Generator.tarski_state_to_macq-232"><span class="linenos">232</span></a>
</span><span id="Generator.tarski_state_to_macq-233"><a href="#Generator.tarski_state_to_macq-233"><span class="linenos">233</span></a><span class="sd">        Args:</span>
</span><span id="Generator.tarski_state_to_macq-234"><a href="#Generator.tarski_state_to_macq-234"><span class="linenos">234</span></a><span class="sd">            tarski_state (Model):</span>
</span><span id="Generator.tarski_state_to_macq-235"><a href="#Generator.tarski_state_to_macq-235"><span class="linenos">235</span></a><span class="sd">                The supplied state, defined using the tarski Model class.</span>
</span><span id="Generator.tarski_state_to_macq-236"><a href="#Generator.tarski_state_to_macq-236"><span class="linenos">236</span></a>
</span><span id="Generator.tarski_state_to_macq-237"><a href="#Generator.tarski_state_to_macq-237"><span class="linenos">237</span></a><span class="sd">        Returns:</span>
</span><span id="Generator.tarski_state_to_macq-238"><a href="#Generator.tarski_state_to_macq-238"><span class="linenos">238</span></a><span class="sd">            A state, defined using the macq State class.</span>
</span><span id="Generator.tarski_state_to_macq-239"><a href="#Generator.tarski_state_to_macq-239"><span class="linenos">239</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Generator.tarski_state_to_macq-240"><a href="#Generator.tarski_state_to_macq-240"><span class="linenos">240</span></a>        <span class="n">state_fluents</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Generator.tarski_state_to_macq-241"><a href="#Generator.tarski_state_to_macq-241"><span class="linenos">241</span></a>        <span class="n">true_fluents</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="Generator.tarski_state_to_macq-242"><a href="#Generator.tarski_state_to_macq-242"><span class="linenos">242</span></a>        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">tarski_state</span><span class="o">.</span><span class="n">as_atoms</span><span class="p">():</span>
</span><span id="Generator.tarski_state_to_macq-243"><a href="#Generator.tarski_state_to_macq-243"><span class="linenos">243</span></a>            <span class="n">fluent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__tarski_atom_to_macq_fluent</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span><span id="Generator.tarski_state_to_macq-244"><a href="#Generator.tarski_state_to_macq-244"><span class="linenos">244</span></a>            <span class="c1"># ignore functions for now</span>
</span><span id="Generator.tarski_state_to_macq-245"><a href="#Generator.tarski_state_to_macq-245"><span class="linenos">245</span></a>            <span class="k">if</span> <span class="n">fluent</span><span class="p">:</span>
</span><span id="Generator.tarski_state_to_macq-246"><a href="#Generator.tarski_state_to_macq-246"><span class="linenos">246</span></a>                <span class="n">true_fluents</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">fluent</span><span class="p">))</span>
</span><span id="Generator.tarski_state_to_macq-247"><a href="#Generator.tarski_state_to_macq-247"><span class="linenos">247</span></a>        <span class="k">for</span> <span class="n">grounded_fluent</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">grounded_fluents</span><span class="p">:</span>
</span><span id="Generator.tarski_state_to_macq-248"><a href="#Generator.tarski_state_to_macq-248"><span class="linenos">248</span></a>            <span class="n">state_fluents</span><span class="p">[</span><span class="n">grounded_fluent</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">grounded_fluent</span><span class="p">)</span> <span class="ow">in</span> <span class="n">true_fluents</span>
</span><span id="Generator.tarski_state_to_macq-249"><a href="#Generator.tarski_state_to_macq-249"><span class="linenos">249</span></a>
</span><span id="Generator.tarski_state_to_macq-250"><a href="#Generator.tarski_state_to_macq-250"><span class="linenos">250</span></a>        <span class="k">return</span> <span class="n">State</span><span class="p">(</span><span class="n">state_fluents</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Converts a state as defined by tarski to a state as defined by macq.</p>

<p>Args:
    tarski_state (Model):
        The supplied state, defined using the tarski Model class.</p>

<p>Returns:
    A state, defined using the macq State class.</p>
</div>


                            </div>
                            <div id="Generator.tarski_act_to_macq" class="classattr">
                                        <input id="Generator.tarski_act_to_macq-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">tarski_act_to_macq</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">tarski_act</span><span class="p">:</span> <span class="n">tarski</span><span class="o">.</span><span class="n">fstrips</span><span class="o">.</span><span class="n">action</span><span class="o">.</span><span class="n">PlainOperator</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Generator.tarski_act_to_macq-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Generator.tarski_act_to_macq"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Generator.tarski_act_to_macq-252"><a href="#Generator.tarski_act_to_macq-252"><span class="linenos">252</span></a>    <span class="k">def</span> <span class="nf">tarski_act_to_macq</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tarski_act</span><span class="p">:</span> <span class="n">PlainOperator</span><span class="p">):</span>
</span><span id="Generator.tarski_act_to_macq-253"><a href="#Generator.tarski_act_to_macq-253"><span class="linenos">253</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Converts an action as defined by tarski to an action as defined by macq.</span>
</span><span id="Generator.tarski_act_to_macq-254"><a href="#Generator.tarski_act_to_macq-254"><span class="linenos">254</span></a>
</span><span id="Generator.tarski_act_to_macq-255"><a href="#Generator.tarski_act_to_macq-255"><span class="linenos">255</span></a><span class="sd">        Args:</span>
</span><span id="Generator.tarski_act_to_macq-256"><a href="#Generator.tarski_act_to_macq-256"><span class="linenos">256</span></a><span class="sd">            tarski_act (PlainOperator):</span>
</span><span id="Generator.tarski_act_to_macq-257"><a href="#Generator.tarski_act_to_macq-257"><span class="linenos">257</span></a><span class="sd">                The supplied action, defined using the tarski PlainOperator class.</span>
</span><span id="Generator.tarski_act_to_macq-258"><a href="#Generator.tarski_act_to_macq-258"><span class="linenos">258</span></a>
</span><span id="Generator.tarski_act_to_macq-259"><a href="#Generator.tarski_act_to_macq-259"><span class="linenos">259</span></a><span class="sd">        Returns:</span>
</span><span id="Generator.tarski_act_to_macq-260"><a href="#Generator.tarski_act_to_macq-260"><span class="linenos">260</span></a><span class="sd">            An action, defined using the macq Action class.</span>
</span><span id="Generator.tarski_act_to_macq-261"><a href="#Generator.tarski_act_to_macq-261"><span class="linenos">261</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Generator.tarski_act_to_macq-262"><a href="#Generator.tarski_act_to_macq-262"><span class="linenos">262</span></a>        <span class="n">name_split</span> <span class="o">=</span> <span class="n">tarski_act</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;)&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;(&quot;</span><span class="p">)</span>
</span><span id="Generator.tarski_act_to_macq-263"><a href="#Generator.tarski_act_to_macq-263"><span class="linenos">263</span></a>        <span class="n">name</span> <span class="o">=</span> <span class="n">name_split</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Generator.tarski_act_to_macq-264"><a href="#Generator.tarski_act_to_macq-264"><span class="linenos">264</span></a>        <span class="n">obj_names</span> <span class="o">=</span> <span class="n">name_split</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">)</span>
</span><span id="Generator.tarski_act_to_macq-265"><a href="#Generator.tarski_act_to_macq-265"><span class="linenos">265</span></a>
</span><span id="Generator.tarski_act_to_macq-266"><a href="#Generator.tarski_act_to_macq-266"><span class="linenos">266</span></a>        <span class="n">tarski_objs_mapping</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Generator.tarski_act_to_macq-267"><a href="#Generator.tarski_act_to_macq-267"><span class="linenos">267</span></a>        <span class="n">precond</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="Generator.tarski_act_to_macq-268"><a href="#Generator.tarski_act_to_macq-268"><span class="linenos">268</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tarski_act</span><span class="o">.</span><span class="n">precondition</span><span class="p">,</span> <span class="n">CompoundFormula</span><span class="p">):</span>
</span><span id="Generator.tarski_act_to_macq-269"><a href="#Generator.tarski_act_to_macq-269"><span class="linenos">269</span></a>            <span class="n">raw_precond</span> <span class="o">=</span> <span class="n">tarski_act</span><span class="o">.</span><span class="n">precondition</span><span class="o">.</span><span class="n">subformulas</span>
</span><span id="Generator.tarski_act_to_macq-270"><a href="#Generator.tarski_act_to_macq-270"><span class="linenos">270</span></a>            <span class="k">for</span> <span class="n">raw_p</span> <span class="ow">in</span> <span class="n">raw_precond</span><span class="p">:</span>
</span><span id="Generator.tarski_act_to_macq-271"><a href="#Generator.tarski_act_to_macq-271"><span class="linenos">271</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">raw_p</span><span class="p">,</span> <span class="n">CompoundFormula</span><span class="p">):</span>
</span><span id="Generator.tarski_act_to_macq-272"><a href="#Generator.tarski_act_to_macq-272"><span class="linenos">272</span></a>                    <span class="n">precond</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__tarski_atom_to_macq_fluent</span><span class="p">(</span><span class="n">raw_p</span><span class="o">.</span><span class="n">subformulas</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</span><span id="Generator.tarski_act_to_macq-273"><a href="#Generator.tarski_act_to_macq-273"><span class="linenos">273</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Generator.tarski_act_to_macq-274"><a href="#Generator.tarski_act_to_macq-274"><span class="linenos">274</span></a>                    <span class="n">precond</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__tarski_atom_to_macq_fluent</span><span class="p">(</span><span class="n">raw_p</span><span class="p">))</span>
</span><span id="Generator.tarski_act_to_macq-275"><a href="#Generator.tarski_act_to_macq-275"><span class="linenos">275</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Generator.tarski_act_to_macq-276"><a href="#Generator.tarski_act_to_macq-276"><span class="linenos">276</span></a>            <span class="n">precond</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__tarski_atom_to_macq_fluent</span><span class="p">(</span><span class="n">tarski_act</span><span class="o">.</span><span class="n">precondition</span><span class="p">))</span>
</span><span id="Generator.tarski_act_to_macq-277"><a href="#Generator.tarski_act_to_macq-277"><span class="linenos">277</span></a>        <span class="p">(</span><span class="n">add</span><span class="p">,</span> <span class="n">delete</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__effect_split</span><span class="p">(</span><span class="n">tarski_act</span><span class="p">)</span>
</span><span id="Generator.tarski_act_to_macq-278"><a href="#Generator.tarski_act_to_macq-278"><span class="linenos">278</span></a>
</span><span id="Generator.tarski_act_to_macq-279"><a href="#Generator.tarski_act_to_macq-279"><span class="linenos">279</span></a>        <span class="n">tarski_objs_mapping</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">o</span><span class="o">.</span><span class="n">name</span><span class="p">:</span><span class="n">o</span> <span class="k">for</span> <span class="n">fluent</span> <span class="ow">in</span> <span class="n">add</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">fluent</span><span class="o">.</span><span class="n">objects</span> <span class="p">})</span>
</span><span id="Generator.tarski_act_to_macq-280"><a href="#Generator.tarski_act_to_macq-280"><span class="linenos">280</span></a>        <span class="n">tarski_objs_mapping</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">o</span><span class="o">.</span><span class="n">name</span><span class="p">:</span><span class="n">o</span> <span class="k">for</span> <span class="n">fluent</span> <span class="ow">in</span> <span class="n">delete</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">fluent</span><span class="o">.</span><span class="n">objects</span> <span class="p">})</span>
</span><span id="Generator.tarski_act_to_macq-281"><a href="#Generator.tarski_act_to_macq-281"><span class="linenos">281</span></a>        <span class="n">tarski_objs_mapping</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">o</span><span class="o">.</span><span class="n">name</span><span class="p">:</span><span class="n">o</span> <span class="k">for</span> <span class="n">fluent</span> <span class="ow">in</span> <span class="n">precond</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">fluent</span><span class="o">.</span><span class="n">objects</span> <span class="p">})</span>
</span><span id="Generator.tarski_act_to_macq-282"><a href="#Generator.tarski_act_to_macq-282"><span class="linenos">282</span></a>
</span><span id="Generator.tarski_act_to_macq-283"><a href="#Generator.tarski_act_to_macq-283"><span class="linenos">283</span></a>        <span class="n">obj_params</span> <span class="o">=</span> <span class="p">[</span><span class="n">tarski_objs_mapping</span><span class="p">[</span><span class="n">o</span><span class="p">]</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">obj_names</span><span class="p">]</span>
</span><span id="Generator.tarski_act_to_macq-284"><a href="#Generator.tarski_act_to_macq-284"><span class="linenos">284</span></a>
</span><span id="Generator.tarski_act_to_macq-285"><a href="#Generator.tarski_act_to_macq-285"><span class="linenos">285</span></a>        <span class="k">return</span> <span class="p">(</span>
</span><span id="Generator.tarski_act_to_macq-286"><a href="#Generator.tarski_act_to_macq-286"><span class="linenos">286</span></a>            <span class="n">Action</span><span class="p">(</span>
</span><span id="Generator.tarski_act_to_macq-287"><a href="#Generator.tarski_act_to_macq-287"><span class="linenos">287</span></a>                <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
</span><span id="Generator.tarski_act_to_macq-288"><a href="#Generator.tarski_act_to_macq-288"><span class="linenos">288</span></a>                <span class="n">obj_params</span><span class="o">=</span><span class="n">obj_params</span><span class="p">,</span>
</span><span id="Generator.tarski_act_to_macq-289"><a href="#Generator.tarski_act_to_macq-289"><span class="linenos">289</span></a>                <span class="n">precond</span><span class="o">=</span><span class="n">precond</span><span class="p">,</span>
</span><span id="Generator.tarski_act_to_macq-290"><a href="#Generator.tarski_act_to_macq-290"><span class="linenos">290</span></a>                <span class="n">add</span><span class="o">=</span><span class="n">add</span><span class="p">,</span>
</span><span id="Generator.tarski_act_to_macq-291"><a href="#Generator.tarski_act_to_macq-291"><span class="linenos">291</span></a>                <span class="n">delete</span><span class="o">=</span><span class="n">delete</span><span class="p">,</span>
</span><span id="Generator.tarski_act_to_macq-292"><a href="#Generator.tarski_act_to_macq-292"><span class="linenos">292</span></a>            <span class="p">)</span>
</span><span id="Generator.tarski_act_to_macq-293"><a href="#Generator.tarski_act_to_macq-293"><span class="linenos">293</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">observe_pres_effs</span>
</span><span id="Generator.tarski_act_to_macq-294"><a href="#Generator.tarski_act_to_macq-294"><span class="linenos">294</span></a>            <span class="k">else</span> <span class="n">Action</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">obj_params</span><span class="o">=</span><span class="n">obj_params</span><span class="p">)</span>
</span><span id="Generator.tarski_act_to_macq-295"><a href="#Generator.tarski_act_to_macq-295"><span class="linenos">295</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Converts an action as defined by tarski to an action as defined by macq.</p>

<p>Args:
    tarski_act (PlainOperator):
        The supplied action, defined using the tarski PlainOperator class.</p>

<p>Returns:
    An action, defined using the macq Action class.</p>
</div>


                            </div>
                            <div id="Generator.change_init" class="classattr">
                                        <input id="Generator.change_init-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">change_init</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">init_fluents</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Set</span><span class="p">[</span><span class="n">macq</span><span class="o">.</span><span class="n">trace</span><span class="o">.</span><span class="n">fluent</span><span class="o">.</span><span class="n">Fluent</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="n">macq</span><span class="o">.</span><span class="n">trace</span><span class="o">.</span><span class="n">fluent</span><span class="o">.</span><span class="n">Fluent</span><span class="p">]]</span>,</span><span class="param">	<span class="n">new_domain</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;new_domain.pddl&#39;</span>,</span><span class="param">	<span class="n">new_prob</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;new_prob.pddl&#39;</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Generator.change_init-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Generator.change_init"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Generator.change_init-297"><a href="#Generator.change_init-297"><span class="linenos">297</span></a>    <span class="k">def</span> <span class="nf">change_init</span><span class="p">(</span>
</span><span id="Generator.change_init-298"><a href="#Generator.change_init-298"><span class="linenos">298</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="Generator.change_init-299"><a href="#Generator.change_init-299"><span class="linenos">299</span></a>        <span class="n">init_fluents</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Set</span><span class="p">[</span><span class="n">Fluent</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="n">Fluent</span><span class="p">]],</span>
</span><span id="Generator.change_init-300"><a href="#Generator.change_init-300"><span class="linenos">300</span></a>        <span class="n">new_domain</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;new_domain.pddl&quot;</span><span class="p">,</span>
</span><span id="Generator.change_init-301"><a href="#Generator.change_init-301"><span class="linenos">301</span></a>        <span class="n">new_prob</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;new_prob.pddl&quot;</span><span class="p">,</span>
</span><span id="Generator.change_init-302"><a href="#Generator.change_init-302"><span class="linenos">302</span></a>    <span class="p">):</span>
</span><span id="Generator.change_init-303"><a href="#Generator.change_init-303"><span class="linenos">303</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Changes the initial state of the `Generator`. The domain and problem PDDL files</span>
</span><span id="Generator.change_init-304"><a href="#Generator.change_init-304"><span class="linenos">304</span></a><span class="sd">        are rewritten to accomodate the new goal for later use by a planner.</span>
</span><span id="Generator.change_init-305"><a href="#Generator.change_init-305"><span class="linenos">305</span></a>
</span><span id="Generator.change_init-306"><a href="#Generator.change_init-306"><span class="linenos">306</span></a><span class="sd">        Args:</span>
</span><span id="Generator.change_init-307"><a href="#Generator.change_init-307"><span class="linenos">307</span></a><span class="sd">            init_fluents (Union[Set[Fluent], List[Fluent]]):</span>
</span><span id="Generator.change_init-308"><a href="#Generator.change_init-308"><span class="linenos">308</span></a><span class="sd">                The collection of fluents that will make up the new initial state.</span>
</span><span id="Generator.change_init-309"><a href="#Generator.change_init-309"><span class="linenos">309</span></a><span class="sd">            new_domain (str):</span>
</span><span id="Generator.change_init-310"><a href="#Generator.change_init-310"><span class="linenos">310</span></a><span class="sd">                The name of the new domain file.</span>
</span><span id="Generator.change_init-311"><a href="#Generator.change_init-311"><span class="linenos">311</span></a><span class="sd">            new_prob (str):</span>
</span><span id="Generator.change_init-312"><a href="#Generator.change_init-312"><span class="linenos">312</span></a><span class="sd">                The name of the new problem file.</span>
</span><span id="Generator.change_init-313"><a href="#Generator.change_init-313"><span class="linenos">313</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Generator.change_init-314"><a href="#Generator.change_init-314"><span class="linenos">314</span></a>        <span class="n">init</span> <span class="o">=</span> <span class="n">create</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lang</span><span class="p">)</span>
</span><span id="Generator.change_init-315"><a href="#Generator.change_init-315"><span class="linenos">315</span></a>        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">init_fluents</span><span class="p">:</span>
</span><span id="Generator.change_init-316"><a href="#Generator.change_init-316"><span class="linenos">316</span></a>            <span class="c1"># convert fluents to tarski Atoms</span>
</span><span id="Generator.change_init-317"><a href="#Generator.change_init-317"><span class="linenos">317</span></a>            <span class="n">atom</span> <span class="o">=</span> <span class="n">Atom</span><span class="p">(</span>
</span><span id="Generator.change_init-318"><a href="#Generator.change_init-318"><span class="linenos">318</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">lang</span><span class="o">.</span><span class="n">get_predicate</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">name</span><span class="p">),</span>
</span><span id="Generator.change_init-319"><a href="#Generator.change_init-319"><span class="linenos">319</span></a>                <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">lang</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">o</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">objects</span><span class="p">],</span>
</span><span id="Generator.change_init-320"><a href="#Generator.change_init-320"><span class="linenos">320</span></a>            <span class="p">)</span>
</span><span id="Generator.change_init-321"><a href="#Generator.change_init-321"><span class="linenos">321</span></a>            <span class="n">init</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">atom</span><span class="o">.</span><span class="n">predicate</span><span class="p">,</span> <span class="o">*</span><span class="n">atom</span><span class="o">.</span><span class="n">subterms</span><span class="p">)</span>
</span><span id="Generator.change_init-322"><a href="#Generator.change_init-322"><span class="linenos">322</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="o">.</span><span class="n">init</span> <span class="o">=</span> <span class="n">init</span>
</span><span id="Generator.change_init-323"><a href="#Generator.change_init-323"><span class="linenos">323</span></a>
</span><span id="Generator.change_init-324"><a href="#Generator.change_init-324"><span class="linenos">324</span></a>        <span class="c1"># rewrite PDDL files appropriately</span>
</span><span id="Generator.change_init-325"><a href="#Generator.change_init-325"><span class="linenos">325</span></a>        <span class="n">writer</span> <span class="o">=</span> <span class="n">iofs</span><span class="o">.</span><span class="n">FstripsWriter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="p">)</span>
</span><span id="Generator.change_init-326"><a href="#Generator.change_init-326"><span class="linenos">326</span></a>        <span class="n">writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">new_domain</span><span class="p">,</span> <span class="n">new_prob</span><span class="p">)</span>
</span><span id="Generator.change_init-327"><a href="#Generator.change_init-327"><span class="linenos">327</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pddl_dom</span> <span class="o">=</span> <span class="n">new_domain</span>
</span><span id="Generator.change_init-328"><a href="#Generator.change_init-328"><span class="linenos">328</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pddl_prob</span> <span class="o">=</span> <span class="n">new_prob</span>
</span></pre></div>


            <div class="docstring"><p>Changes the initial state of the <code><a href="#Generator">Generator</a></code>. The domain and problem PDDL files
are rewritten to accomodate the new goal for later use by a planner.</p>

<p>Args:
    init_fluents (Union[Set[Fluent], List[Fluent]]):
        The collection of fluents that will make up the new initial state.
    new_domain (str):
        The name of the new domain file.
    new_prob (str):
        The name of the new problem file.</p>
</div>


                            </div>
                            <div id="Generator.change_goal" class="classattr">
                                        <input id="Generator.change_goal-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">change_goal</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">goal_fluents</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Set</span><span class="p">[</span><span class="n">macq</span><span class="o">.</span><span class="n">trace</span><span class="o">.</span><span class="n">fluent</span><span class="o">.</span><span class="n">Fluent</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="n">macq</span><span class="o">.</span><span class="n">trace</span><span class="o">.</span><span class="n">fluent</span><span class="o">.</span><span class="n">Fluent</span><span class="p">]]</span>,</span><span class="param">	<span class="n">new_domain</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;new_domain.pddl&#39;</span>,</span><span class="param">	<span class="n">new_prob</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;new_prob.pddl&#39;</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Generator.change_goal-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Generator.change_goal"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Generator.change_goal-330"><a href="#Generator.change_goal-330"><span class="linenos">330</span></a>    <span class="k">def</span> <span class="nf">change_goal</span><span class="p">(</span>
</span><span id="Generator.change_goal-331"><a href="#Generator.change_goal-331"><span class="linenos">331</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="Generator.change_goal-332"><a href="#Generator.change_goal-332"><span class="linenos">332</span></a>        <span class="n">goal_fluents</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Set</span><span class="p">[</span><span class="n">Fluent</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="n">Fluent</span><span class="p">]],</span>
</span><span id="Generator.change_goal-333"><a href="#Generator.change_goal-333"><span class="linenos">333</span></a>        <span class="n">new_domain</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;new_domain.pddl&quot;</span><span class="p">,</span>
</span><span id="Generator.change_goal-334"><a href="#Generator.change_goal-334"><span class="linenos">334</span></a>        <span class="n">new_prob</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;new_prob.pddl&quot;</span><span class="p">,</span>
</span><span id="Generator.change_goal-335"><a href="#Generator.change_goal-335"><span class="linenos">335</span></a>    <span class="p">):</span>
</span><span id="Generator.change_goal-336"><a href="#Generator.change_goal-336"><span class="linenos">336</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Changes the goal of the `Generator`. The domain and problem PDDL files</span>
</span><span id="Generator.change_goal-337"><a href="#Generator.change_goal-337"><span class="linenos">337</span></a><span class="sd">        are rewritten to accomodate the new goal for later use by a planner.</span>
</span><span id="Generator.change_goal-338"><a href="#Generator.change_goal-338"><span class="linenos">338</span></a>
</span><span id="Generator.change_goal-339"><a href="#Generator.change_goal-339"><span class="linenos">339</span></a><span class="sd">        Args:</span>
</span><span id="Generator.change_goal-340"><a href="#Generator.change_goal-340"><span class="linenos">340</span></a><span class="sd">            goal_fluents (Union[Set[Fluent], List[Fluent]]):</span>
</span><span id="Generator.change_goal-341"><a href="#Generator.change_goal-341"><span class="linenos">341</span></a><span class="sd">                The collection of fluents that will make up the new goal.</span>
</span><span id="Generator.change_goal-342"><a href="#Generator.change_goal-342"><span class="linenos">342</span></a><span class="sd">            new_domain (str):</span>
</span><span id="Generator.change_goal-343"><a href="#Generator.change_goal-343"><span class="linenos">343</span></a><span class="sd">                The name of the new domain file.</span>
</span><span id="Generator.change_goal-344"><a href="#Generator.change_goal-344"><span class="linenos">344</span></a><span class="sd">            new_prob (str):</span>
</span><span id="Generator.change_goal-345"><a href="#Generator.change_goal-345"><span class="linenos">345</span></a><span class="sd">                The name of the new problem file.</span>
</span><span id="Generator.change_goal-346"><a href="#Generator.change_goal-346"><span class="linenos">346</span></a>
</span><span id="Generator.change_goal-347"><a href="#Generator.change_goal-347"><span class="linenos">347</span></a><span class="sd">        Raises:</span>
</span><span id="Generator.change_goal-348"><a href="#Generator.change_goal-348"><span class="linenos">348</span></a><span class="sd">            InvalidGoalFluent:</span>
</span><span id="Generator.change_goal-349"><a href="#Generator.change_goal-349"><span class="linenos">349</span></a><span class="sd">                Raised if any of the fluents supplied do not exist in this domain.</span>
</span><span id="Generator.change_goal-350"><a href="#Generator.change_goal-350"><span class="linenos">350</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Generator.change_goal-351"><a href="#Generator.change_goal-351"><span class="linenos">351</span></a>        <span class="c1"># check if the fluents to add are valid</span>
</span><span id="Generator.change_goal-352"><a href="#Generator.change_goal-352"><span class="linenos">352</span></a>        <span class="n">available_f</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grounded_fluents</span>
</span><span id="Generator.change_goal-353"><a href="#Generator.change_goal-353"><span class="linenos">353</span></a>        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">goal_fluents</span><span class="p">:</span>
</span><span id="Generator.change_goal-354"><a href="#Generator.change_goal-354"><span class="linenos">354</span></a>            <span class="k">if</span> <span class="n">f</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">available_f</span><span class="p">:</span>
</span><span id="Generator.change_goal-355"><a href="#Generator.change_goal-355"><span class="linenos">355</span></a>                <span class="k">raise</span> <span class="n">InvalidGoalFluent</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span><span id="Generator.change_goal-356"><a href="#Generator.change_goal-356"><span class="linenos">356</span></a>
</span><span id="Generator.change_goal-357"><a href="#Generator.change_goal-357"><span class="linenos">357</span></a>        <span class="c1"># convert the given set of fluents into a formula</span>
</span><span id="Generator.change_goal-358"><a href="#Generator.change_goal-358"><span class="linenos">358</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">goal_fluents</span><span class="p">:</span>
</span><span id="Generator.change_goal-359"><a href="#Generator.change_goal-359"><span class="linenos">359</span></a>            <span class="n">goal</span> <span class="o">=</span> <span class="n">land</span><span class="p">()</span>
</span><span id="Generator.change_goal-360"><a href="#Generator.change_goal-360"><span class="linenos">360</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Generator.change_goal-361"><a href="#Generator.change_goal-361"><span class="linenos">361</span></a>            <span class="n">goal</span> <span class="o">=</span> <span class="n">land</span><span class="p">(</span>
</span><span id="Generator.change_goal-362"><a href="#Generator.change_goal-362"><span class="linenos">362</span></a>                <span class="o">*</span><span class="p">[</span>
</span><span id="Generator.change_goal-363"><a href="#Generator.change_goal-363"><span class="linenos">363</span></a>                    <span class="n">Atom</span><span class="p">(</span>
</span><span id="Generator.change_goal-364"><a href="#Generator.change_goal-364"><span class="linenos">364</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">lang</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">name</span><span class="p">),</span>
</span><span id="Generator.change_goal-365"><a href="#Generator.change_goal-365"><span class="linenos">365</span></a>                        <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">lang</span><span class="o">.</span><span class="n">get_constant</span><span class="p">(</span><span class="n">o</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">objects</span><span class="p">],</span>
</span><span id="Generator.change_goal-366"><a href="#Generator.change_goal-366"><span class="linenos">366</span></a>                    <span class="p">)</span>
</span><span id="Generator.change_goal-367"><a href="#Generator.change_goal-367"><span class="linenos">367</span></a>                    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">goal_fluents</span>
</span><span id="Generator.change_goal-368"><a href="#Generator.change_goal-368"><span class="linenos">368</span></a>                <span class="p">]</span>
</span><span id="Generator.change_goal-369"><a href="#Generator.change_goal-369"><span class="linenos">369</span></a>            <span class="p">)</span>
</span><span id="Generator.change_goal-370"><a href="#Generator.change_goal-370"><span class="linenos">370</span></a>        <span class="c1"># reset the goal</span>
</span><span id="Generator.change_goal-371"><a href="#Generator.change_goal-371"><span class="linenos">371</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="o">.</span><span class="n">goal</span> <span class="o">=</span> <span class="n">flatten</span><span class="p">(</span><span class="n">goal</span><span class="p">)</span>
</span><span id="Generator.change_goal-372"><a href="#Generator.change_goal-372"><span class="linenos">372</span></a>
</span><span id="Generator.change_goal-373"><a href="#Generator.change_goal-373"><span class="linenos">373</span></a>        <span class="c1"># rewrite PDDL files appropriately</span>
</span><span id="Generator.change_goal-374"><a href="#Generator.change_goal-374"><span class="linenos">374</span></a>        <span class="n">writer</span> <span class="o">=</span> <span class="n">iofs</span><span class="o">.</span><span class="n">FstripsWriter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="p">)</span>
</span><span id="Generator.change_goal-375"><a href="#Generator.change_goal-375"><span class="linenos">375</span></a>        <span class="n">writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">new_domain</span><span class="p">,</span> <span class="n">new_prob</span><span class="p">)</span>
</span><span id="Generator.change_goal-376"><a href="#Generator.change_goal-376"><span class="linenos">376</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pddl_dom</span> <span class="o">=</span> <span class="n">new_domain</span>
</span><span id="Generator.change_goal-377"><a href="#Generator.change_goal-377"><span class="linenos">377</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pddl_prob</span> <span class="o">=</span> <span class="n">new_prob</span>
</span></pre></div>


            <div class="docstring"><p>Changes the goal of the <code><a href="#Generator">Generator</a></code>. The domain and problem PDDL files
are rewritten to accomodate the new goal for later use by a planner.</p>

<p>Args:
    goal_fluents (Union[Set[Fluent], List[Fluent]]):
        The collection of fluents that will make up the new goal.
    new_domain (str):
        The name of the new domain file.
    new_prob (str):
        The name of the new problem file.</p>

<p>Raises:
    InvalidGoalFluent:
        Raised if any of the fluents supplied do not exist in this domain.</p>
</div>


                            </div>
                            <div id="Generator.generate_plan" class="classattr">
                                        <input id="Generator.generate_plan-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">generate_plan</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">from_ipc_file</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>, </span><span class="param"><span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Generator.generate_plan-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Generator.generate_plan"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Generator.generate_plan-379"><a href="#Generator.generate_plan-379"><span class="linenos">379</span></a>    <span class="k">def</span> <span class="nf">generate_plan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">from_ipc_file</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="Generator.generate_plan-380"><a href="#Generator.generate_plan-380"><span class="linenos">380</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Generates a plan. If reading from an IPC file, the `Plan` is read directly. Otherwise, if the initial state or</span>
</span><span id="Generator.generate_plan-381"><a href="#Generator.generate_plan-381"><span class="linenos">381</span></a><span class="sd">        goal was changed, these changes are taken into account through the updated PDDL files. If no changes were made, the</span>
</span><span id="Generator.generate_plan-382"><a href="#Generator.generate_plan-382"><span class="linenos">382</span></a><span class="sd">        default nitial state/goal in the initial problem file is used.</span>
</span><span id="Generator.generate_plan-383"><a href="#Generator.generate_plan-383"><span class="linenos">383</span></a>
</span><span id="Generator.generate_plan-384"><a href="#Generator.generate_plan-384"><span class="linenos">384</span></a><span class="sd">        Args:</span>
</span><span id="Generator.generate_plan-385"><a href="#Generator.generate_plan-385"><span class="linenos">385</span></a><span class="sd">            from_ipc_file (bool):</span>
</span><span id="Generator.generate_plan-386"><a href="#Generator.generate_plan-386"><span class="linenos">386</span></a><span class="sd">                Option to read a `Plan` from an IPC file instead of the `Generator`&#39;s problem file. Defaults to False.</span>
</span><span id="Generator.generate_plan-387"><a href="#Generator.generate_plan-387"><span class="linenos">387</span></a><span class="sd">            filename (str):</span>
</span><span id="Generator.generate_plan-388"><a href="#Generator.generate_plan-388"><span class="linenos">388</span></a><span class="sd">                The name of the file to read the plan from.</span>
</span><span id="Generator.generate_plan-389"><a href="#Generator.generate_plan-389"><span class="linenos">389</span></a>
</span><span id="Generator.generate_plan-390"><a href="#Generator.generate_plan-390"><span class="linenos">390</span></a><span class="sd">        Returns:</span>
</span><span id="Generator.generate_plan-391"><a href="#Generator.generate_plan-391"><span class="linenos">391</span></a><span class="sd">            A `Plan` object that holds all the actions taken.</span>
</span><span id="Generator.generate_plan-392"><a href="#Generator.generate_plan-392"><span class="linenos">392</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Generator.generate_plan-393"><a href="#Generator.generate_plan-393"><span class="linenos">393</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">from_ipc_file</span><span class="p">:</span>
</span><span id="Generator.generate_plan-394"><a href="#Generator.generate_plan-394"><span class="linenos">394</span></a>            <span class="c1"># if the files are only being generated from the problem ID and are unaltered, retrieve the existing plan (note that</span>
</span><span id="Generator.generate_plan-395"><a href="#Generator.generate_plan-395"><span class="linenos">395</span></a>            <span class="c1"># if any changes were made, the local files would be used as the PDDL files are rewritten when changes are made).</span>
</span><span id="Generator.generate_plan-396"><a href="#Generator.generate_plan-396"><span class="linenos">396</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">problem_id</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">pddl_dom</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">pddl_prob</span><span class="p">:</span>
</span><span id="Generator.generate_plan-397"><a href="#Generator.generate_plan-397"><span class="linenos">397</span></a>                <span class="n">plan</span> <span class="o">=</span> <span class="n">get_plan</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">problem_id</span><span class="p">,</span> <span class="n">formalism</span><span class="o">=</span><span class="s1">&#39;classical&#39;</span><span class="p">)</span>
</span><span id="Generator.generate_plan-398"><a href="#Generator.generate_plan-398"><span class="linenos">398</span></a>            <span class="c1"># if you are not just using the unaltered files, use the local files instead</span>
</span><span id="Generator.generate_plan-399"><a href="#Generator.generate_plan-399"><span class="linenos">399</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Generator.generate_plan-400"><a href="#Generator.generate_plan-400"><span class="linenos">400</span></a>                <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="Generator.generate_plan-401"><a href="#Generator.generate_plan-401"><span class="linenos">401</span></a>                    <span class="s2">&quot;domain&quot;</span><span class="p">:</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pddl_dom</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span>
</span><span id="Generator.generate_plan-402"><a href="#Generator.generate_plan-402"><span class="linenos">402</span></a>                    <span class="s2">&quot;problem&quot;</span><span class="p">:</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pddl_prob</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span>
</span><span id="Generator.generate_plan-403"><a href="#Generator.generate_plan-403"><span class="linenos">403</span></a>                <span class="p">}</span>
</span><span id="Generator.generate_plan-404"><a href="#Generator.generate_plan-404"><span class="linenos">404</span></a>
</span><span id="Generator.generate_plan-405"><a href="#Generator.generate_plan-405"><span class="linenos">405</span></a>                <span class="k">def</span> <span class="nf">get_api_response</span><span class="p">(</span><span class="n">delays</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]):</span>
</span><span id="Generator.generate_plan-406"><a href="#Generator.generate_plan-406"><span class="linenos">406</span></a>                    <span class="k">if</span> <span class="n">delays</span><span class="p">:</span>
</span><span id="Generator.generate_plan-407"><a href="#Generator.generate_plan-407"><span class="linenos">407</span></a>                        <span class="n">sleep</span><span class="p">(</span><span class="n">delays</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="Generator.generate_plan-408"><a href="#Generator.generate_plan-408"><span class="linenos">408</span></a>                        <span class="k">try</span><span class="p">:</span>
</span><span id="Generator.generate_plan-409"><a href="#Generator.generate_plan-409"><span class="linenos">409</span></a>                            <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
</span><span id="Generator.generate_plan-410"><a href="#Generator.generate_plan-410"><span class="linenos">410</span></a>                                <span class="s2">&quot;http://solver.planning.domains/solve&quot;</span><span class="p">,</span>
</span><span id="Generator.generate_plan-411"><a href="#Generator.generate_plan-411"><span class="linenos">411</span></a>                                <span class="n">verify</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="Generator.generate_plan-412"><a href="#Generator.generate_plan-412"><span class="linenos">412</span></a>                                <span class="n">json</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
</span><span id="Generator.generate_plan-413"><a href="#Generator.generate_plan-413"><span class="linenos">413</span></a>                            <span class="p">)</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</span><span id="Generator.generate_plan-414"><a href="#Generator.generate_plan-414"><span class="linenos">414</span></a>                            <span class="k">return</span> <span class="p">[</span><span class="n">act</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">act</span> <span class="ow">in</span> <span class="n">resp</span><span class="p">[</span><span class="s2">&quot;result&quot;</span><span class="p">][</span><span class="s2">&quot;plan&quot;</span><span class="p">]]</span>
</span><span id="Generator.generate_plan-415"><a href="#Generator.generate_plan-415"><span class="linenos">415</span></a>                        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
</span><span id="Generator.generate_plan-416"><a href="#Generator.generate_plan-416"><span class="linenos">416</span></a>                            <span class="k">return</span> <span class="n">get_api_response</span><span class="p">(</span><span class="n">delays</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
</span><span id="Generator.generate_plan-417"><a href="#Generator.generate_plan-417"><span class="linenos">417</span></a>
</span><span id="Generator.generate_plan-418"><a href="#Generator.generate_plan-418"><span class="linenos">418</span></a>                <span class="n">plan</span> <span class="o">=</span> <span class="n">get_api_response</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
</span><span id="Generator.generate_plan-419"><a href="#Generator.generate_plan-419"><span class="linenos">419</span></a>                <span class="k">if</span> <span class="n">plan</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Generator.generate_plan-420"><a href="#Generator.generate_plan-420"><span class="linenos">420</span></a>                    <span class="k">raise</span> <span class="n">PlanningDomainsAPIError</span><span class="p">(</span>
</span><span id="Generator.generate_plan-421"><a href="#Generator.generate_plan-421"><span class="linenos">421</span></a>                        <span class="s2">&quot;Could not get a valid response from the planning.domains solver after 5 attempts.&quot;</span><span class="p">,</span>
</span><span id="Generator.generate_plan-422"><a href="#Generator.generate_plan-422"><span class="linenos">422</span></a>                    <span class="p">)</span>
</span><span id="Generator.generate_plan-423"><a href="#Generator.generate_plan-423"><span class="linenos">423</span></a>
</span><span id="Generator.generate_plan-424"><a href="#Generator.generate_plan-424"><span class="linenos">424</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Generator.generate_plan-425"><a href="#Generator.generate_plan-425"><span class="linenos">425</span></a>            <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
</span><span id="Generator.generate_plan-426"><a href="#Generator.generate_plan-426"><span class="linenos">426</span></a>            <span class="n">plan</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s2">&quot;;&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()))</span>
</span><span id="Generator.generate_plan-427"><a href="#Generator.generate_plan-427"><span class="linenos">427</span></a>
</span><span id="Generator.generate_plan-428"><a href="#Generator.generate_plan-428"><span class="linenos">428</span></a>        <span class="c1"># convert to a list of tarski PlainOperators (actions)</span>
</span><span id="Generator.generate_plan-429"><a href="#Generator.generate_plan-429"><span class="linenos">429</span></a>        <span class="k">return</span> <span class="n">Plan</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">op_dict</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">plan</span> <span class="k">if</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">op_dict</span><span class="p">])</span>
</span></pre></div>


            <div class="docstring"><p>Generates a plan. If reading from an IPC file, the <code>Plan</code> is read directly. Otherwise, if the initial state or
goal was changed, these changes are taken into account through the updated PDDL files. If no changes were made, the
default nitial state/goal in the initial problem file is used.</p>

<p>Args:
    from_ipc_file (bool):
        Option to read a <code>Plan</code> from an IPC file instead of the <code><a href="#Generator">Generator</a></code>'s problem file. Defaults to False.
    filename (str):
        The name of the file to read the plan from.</p>

<p>Returns:
    A <code>Plan</code> object that holds all the actions taken.</p>
</div>


                            </div>
                            <div id="Generator.generate_single_trace_from_plan" class="classattr">
                                        <input id="Generator.generate_single_trace_from_plan-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">generate_single_trace_from_plan</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">plan</span><span class="p">:</span> <span class="n">macq</span><span class="o">.</span><span class="n">generate</span><span class="o">.</span><span class="n">plan</span><span class="o">.</span><span class="n">Plan</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Generator.generate_single_trace_from_plan-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Generator.generate_single_trace_from_plan"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Generator.generate_single_trace_from_plan-431"><a href="#Generator.generate_single_trace_from_plan-431"><span class="linenos">431</span></a>    <span class="k">def</span> <span class="nf">generate_single_trace_from_plan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plan</span><span class="p">:</span> <span class="n">Plan</span><span class="p">):</span>
</span><span id="Generator.generate_single_trace_from_plan-432"><a href="#Generator.generate_single_trace_from_plan-432"><span class="linenos">432</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Generates a single trace from the plan taken as input.</span>
</span><span id="Generator.generate_single_trace_from_plan-433"><a href="#Generator.generate_single_trace_from_plan-433"><span class="linenos">433</span></a>
</span><span id="Generator.generate_single_trace_from_plan-434"><a href="#Generator.generate_single_trace_from_plan-434"><span class="linenos">434</span></a><span class="sd">        Args:</span>
</span><span id="Generator.generate_single_trace_from_plan-435"><a href="#Generator.generate_single_trace_from_plan-435"><span class="linenos">435</span></a><span class="sd">            plan (Plan):</span>
</span><span id="Generator.generate_single_trace_from_plan-436"><a href="#Generator.generate_single_trace_from_plan-436"><span class="linenos">436</span></a><span class="sd">                The plan to generate a trace from.</span>
</span><span id="Generator.generate_single_trace_from_plan-437"><a href="#Generator.generate_single_trace_from_plan-437"><span class="linenos">437</span></a>
</span><span id="Generator.generate_single_trace_from_plan-438"><a href="#Generator.generate_single_trace_from_plan-438"><span class="linenos">438</span></a><span class="sd">        Returns:</span>
</span><span id="Generator.generate_single_trace_from_plan-439"><a href="#Generator.generate_single_trace_from_plan-439"><span class="linenos">439</span></a><span class="sd">            The trace generated from the plan.</span>
</span><span id="Generator.generate_single_trace_from_plan-440"><a href="#Generator.generate_single_trace_from_plan-440"><span class="linenos">440</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Generator.generate_single_trace_from_plan-441"><a href="#Generator.generate_single_trace_from_plan-441"><span class="linenos">441</span></a>        <span class="n">trace</span> <span class="o">=</span> <span class="n">Trace</span><span class="p">()</span>
</span><span id="Generator.generate_single_trace_from_plan-442"><a href="#Generator.generate_single_trace_from_plan-442"><span class="linenos">442</span></a>        <span class="n">actions</span> <span class="o">=</span> <span class="n">plan</span><span class="o">.</span><span class="n">actions</span>
</span><span id="Generator.generate_single_trace_from_plan-443"><a href="#Generator.generate_single_trace_from_plan-443"><span class="linenos">443</span></a>        <span class="n">plan_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">actions</span><span class="p">)</span>
</span><span id="Generator.generate_single_trace_from_plan-444"><a href="#Generator.generate_single_trace_from_plan-444"><span class="linenos">444</span></a>        <span class="c1"># get initial state</span>
</span><span id="Generator.generate_single_trace_from_plan-445"><a href="#Generator.generate_single_trace_from_plan-445"><span class="linenos">445</span></a>        <span class="n">state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="o">.</span><span class="n">init</span>
</span><span id="Generator.generate_single_trace_from_plan-446"><a href="#Generator.generate_single_trace_from_plan-446"><span class="linenos">446</span></a>        <span class="c1"># note that we add 1 because the states represented take place BEFORE their subsequent action,</span>
</span><span id="Generator.generate_single_trace_from_plan-447"><a href="#Generator.generate_single_trace_from_plan-447"><span class="linenos">447</span></a>        <span class="c1"># so if we need to take x actions, we need x + 1 states and therefore x + 1 steps in the trace.</span>
</span><span id="Generator.generate_single_trace_from_plan-448"><a href="#Generator.generate_single_trace_from_plan-448"><span class="linenos">448</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">plan_len</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="Generator.generate_single_trace_from_plan-449"><a href="#Generator.generate_single_trace_from_plan-449"><span class="linenos">449</span></a>            <span class="n">macq_state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarski_state_to_macq</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
</span><span id="Generator.generate_single_trace_from_plan-450"><a href="#Generator.generate_single_trace_from_plan-450"><span class="linenos">450</span></a>            <span class="c1"># if we have not yet reached the end of the trace</span>
</span><span id="Generator.generate_single_trace_from_plan-451"><a href="#Generator.generate_single_trace_from_plan-451"><span class="linenos">451</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">trace</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">plan_len</span><span class="p">:</span>
</span><span id="Generator.generate_single_trace_from_plan-452"><a href="#Generator.generate_single_trace_from_plan-452"><span class="linenos">452</span></a>                <span class="n">act</span> <span class="o">=</span> <span class="n">actions</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="Generator.generate_single_trace_from_plan-453"><a href="#Generator.generate_single_trace_from_plan-453"><span class="linenos">453</span></a>                <span class="n">trace</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Step</span><span class="p">(</span><span class="n">macq_state</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarski_act_to_macq</span><span class="p">(</span><span class="n">act</span><span class="p">),</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="Generator.generate_single_trace_from_plan-454"><a href="#Generator.generate_single_trace_from_plan-454"><span class="linenos">454</span></a>                <span class="n">state</span> <span class="o">=</span> <span class="n">progress</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">act</span><span class="p">)</span>
</span><span id="Generator.generate_single_trace_from_plan-455"><a href="#Generator.generate_single_trace_from_plan-455"><span class="linenos">455</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Generator.generate_single_trace_from_plan-456"><a href="#Generator.generate_single_trace_from_plan-456"><span class="linenos">456</span></a>                <span class="n">trace</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Step</span><span class="p">(</span><span class="n">macq_state</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="Generator.generate_single_trace_from_plan-457"><a href="#Generator.generate_single_trace_from_plan-457"><span class="linenos">457</span></a>        <span class="k">return</span> <span class="n">trace</span>
</span></pre></div>


            <div class="docstring"><p>Generates a single trace from the plan taken as input.</p>

<p>Args:
    plan (Plan):
        The plan to generate a trace from.</p>

<p>Returns:
    The trace generated from the plan.</p>
</div>


                            </div>
                </section>
                <section id="VanillaSampling">
                            <input id="VanillaSampling-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">VanillaSampling</span><wbr>(<span class="base"><a href="#Generator">macq.generate.pddl.Generator</a></span>):

                <label class="view-source-button" for="VanillaSampling-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#VanillaSampling"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="VanillaSampling-20"><a href="#VanillaSampling-20"><span class="linenos"> 20</span></a><span class="k">class</span> <span class="nc">VanillaSampling</span><span class="p">(</span><span class="n">Generator</span><span class="p">):</span>
</span><span id="VanillaSampling-21"><a href="#VanillaSampling-21"><span class="linenos"> 21</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Vanilla State Trace Sampler - inherits the base Generator class and its attributes.</span>
</span><span id="VanillaSampling-22"><a href="#VanillaSampling-22"><span class="linenos"> 22</span></a>
</span><span id="VanillaSampling-23"><a href="#VanillaSampling-23"><span class="linenos"> 23</span></a><span class="sd">    A basic state trace generator that generates traces randomly by uniformly sampling applicable actions to find plans</span>
</span><span id="VanillaSampling-24"><a href="#VanillaSampling-24"><span class="linenos"> 24</span></a><span class="sd">    of the given length.</span>
</span><span id="VanillaSampling-25"><a href="#VanillaSampling-25"><span class="linenos"> 25</span></a>
</span><span id="VanillaSampling-26"><a href="#VanillaSampling-26"><span class="linenos"> 26</span></a><span class="sd">    Attributes:</span>
</span><span id="VanillaSampling-27"><a href="#VanillaSampling-27"><span class="linenos"> 27</span></a><span class="sd">        max_time (float):</span>
</span><span id="VanillaSampling-28"><a href="#VanillaSampling-28"><span class="linenos"> 28</span></a><span class="sd">            The maximum time allowed for a trace to be generated.</span>
</span><span id="VanillaSampling-29"><a href="#VanillaSampling-29"><span class="linenos"> 29</span></a><span class="sd">        plan_len (int):</span>
</span><span id="VanillaSampling-30"><a href="#VanillaSampling-30"><span class="linenos"> 30</span></a><span class="sd">            The length of the traces to be generated.</span>
</span><span id="VanillaSampling-31"><a href="#VanillaSampling-31"><span class="linenos"> 31</span></a><span class="sd">        num_traces (int):</span>
</span><span id="VanillaSampling-32"><a href="#VanillaSampling-32"><span class="linenos"> 32</span></a><span class="sd">            The number of traces to be generated.</span>
</span><span id="VanillaSampling-33"><a href="#VanillaSampling-33"><span class="linenos"> 33</span></a><span class="sd">        traces (TraceList):</span>
</span><span id="VanillaSampling-34"><a href="#VanillaSampling-34"><span class="linenos"> 34</span></a><span class="sd">            The list of traces generated.</span>
</span><span id="VanillaSampling-35"><a href="#VanillaSampling-35"><span class="linenos"> 35</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="VanillaSampling-36"><a href="#VanillaSampling-36"><span class="linenos"> 36</span></a>
</span><span id="VanillaSampling-37"><a href="#VanillaSampling-37"><span class="linenos"> 37</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="VanillaSampling-38"><a href="#VanillaSampling-38"><span class="linenos"> 38</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="VanillaSampling-39"><a href="#VanillaSampling-39"><span class="linenos"> 39</span></a>        <span class="n">dom</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="VanillaSampling-40"><a href="#VanillaSampling-40"><span class="linenos"> 40</span></a>        <span class="n">prob</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="VanillaSampling-41"><a href="#VanillaSampling-41"><span class="linenos"> 41</span></a>        <span class="n">problem_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="VanillaSampling-42"><a href="#VanillaSampling-42"><span class="linenos"> 42</span></a>        <span class="n">observe_pres_effs</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="VanillaSampling-43"><a href="#VanillaSampling-43"><span class="linenos"> 43</span></a>        <span class="n">plan_len</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="VanillaSampling-44"><a href="#VanillaSampling-44"><span class="linenos"> 44</span></a>        <span class="n">num_traces</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="VanillaSampling-45"><a href="#VanillaSampling-45"><span class="linenos"> 45</span></a>        <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="VanillaSampling-46"><a href="#VanillaSampling-46"><span class="linenos"> 46</span></a>        <span class="n">max_time</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span>
</span><span id="VanillaSampling-47"><a href="#VanillaSampling-47"><span class="linenos"> 47</span></a>    <span class="p">):</span>
</span><span id="VanillaSampling-48"><a href="#VanillaSampling-48"><span class="linenos"> 48</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="VanillaSampling-49"><a href="#VanillaSampling-49"><span class="linenos"> 49</span></a><span class="sd">        Initializes a vanilla state trace sampler using the plan length, number of traces,</span>
</span><span id="VanillaSampling-50"><a href="#VanillaSampling-50"><span class="linenos"> 50</span></a><span class="sd">        and the domain and problem.</span>
</span><span id="VanillaSampling-51"><a href="#VanillaSampling-51"><span class="linenos"> 51</span></a>
</span><span id="VanillaSampling-52"><a href="#VanillaSampling-52"><span class="linenos"> 52</span></a><span class="sd">        Args:</span>
</span><span id="VanillaSampling-53"><a href="#VanillaSampling-53"><span class="linenos"> 53</span></a><span class="sd">            dom (str):</span>
</span><span id="VanillaSampling-54"><a href="#VanillaSampling-54"><span class="linenos"> 54</span></a><span class="sd">                The domain filename.</span>
</span><span id="VanillaSampling-55"><a href="#VanillaSampling-55"><span class="linenos"> 55</span></a><span class="sd">            prob (str):</span>
</span><span id="VanillaSampling-56"><a href="#VanillaSampling-56"><span class="linenos"> 56</span></a><span class="sd">                The problem filename.</span>
</span><span id="VanillaSampling-57"><a href="#VanillaSampling-57"><span class="linenos"> 57</span></a><span class="sd">            problem_id (int):</span>
</span><span id="VanillaSampling-58"><a href="#VanillaSampling-58"><span class="linenos"> 58</span></a><span class="sd">                The ID of the problem to access.</span>
</span><span id="VanillaSampling-59"><a href="#VanillaSampling-59"><span class="linenos"> 59</span></a><span class="sd">            max_time (float):</span>
</span><span id="VanillaSampling-60"><a href="#VanillaSampling-60"><span class="linenos"> 60</span></a><span class="sd">                The maximum time allowed for a trace to be generated.</span>
</span><span id="VanillaSampling-61"><a href="#VanillaSampling-61"><span class="linenos"> 61</span></a><span class="sd">            observe_pres_effs (bool):</span>
</span><span id="VanillaSampling-62"><a href="#VanillaSampling-62"><span class="linenos"> 62</span></a><span class="sd">                Option to observe action preconditions and effects upon generation.</span>
</span><span id="VanillaSampling-63"><a href="#VanillaSampling-63"><span class="linenos"> 63</span></a><span class="sd">            plan_len (int):</span>
</span><span id="VanillaSampling-64"><a href="#VanillaSampling-64"><span class="linenos"> 64</span></a><span class="sd">                The length of each generated trace. Defaults to 1.</span>
</span><span id="VanillaSampling-65"><a href="#VanillaSampling-65"><span class="linenos"> 65</span></a><span class="sd">            num_traces (int):</span>
</span><span id="VanillaSampling-66"><a href="#VanillaSampling-66"><span class="linenos"> 66</span></a><span class="sd">                The number of traces to generate. Defaults to 1.</span>
</span><span id="VanillaSampling-67"><a href="#VanillaSampling-67"><span class="linenos"> 67</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="VanillaSampling-68"><a href="#VanillaSampling-68"><span class="linenos"> 68</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="VanillaSampling-69"><a href="#VanillaSampling-69"><span class="linenos"> 69</span></a>            <span class="n">dom</span><span class="o">=</span><span class="n">dom</span><span class="p">,</span>
</span><span id="VanillaSampling-70"><a href="#VanillaSampling-70"><span class="linenos"> 70</span></a>            <span class="n">prob</span><span class="o">=</span><span class="n">prob</span><span class="p">,</span>
</span><span id="VanillaSampling-71"><a href="#VanillaSampling-71"><span class="linenos"> 71</span></a>            <span class="n">problem_id</span><span class="o">=</span><span class="n">problem_id</span><span class="p">,</span>
</span><span id="VanillaSampling-72"><a href="#VanillaSampling-72"><span class="linenos"> 72</span></a>            <span class="n">observe_pres_effs</span><span class="o">=</span><span class="n">observe_pres_effs</span><span class="p">,</span>
</span><span id="VanillaSampling-73"><a href="#VanillaSampling-73"><span class="linenos"> 73</span></a>        <span class="p">)</span>
</span><span id="VanillaSampling-74"><a href="#VanillaSampling-74"><span class="linenos"> 74</span></a>        <span class="k">if</span> <span class="n">max_time</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="VanillaSampling-75"><a href="#VanillaSampling-75"><span class="linenos"> 75</span></a>            <span class="k">raise</span> <span class="n">InvalidTime</span><span class="p">()</span>
</span><span id="VanillaSampling-76"><a href="#VanillaSampling-76"><span class="linenos"> 76</span></a>        <span class="k">if</span> <span class="n">seed</span><span class="p">:</span>
</span><span id="VanillaSampling-77"><a href="#VanillaSampling-77"><span class="linenos"> 77</span></a>            <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
</span><span id="VanillaSampling-78"><a href="#VanillaSampling-78"><span class="linenos"> 78</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">max_time</span> <span class="o">=</span> <span class="n">max_time</span>
</span><span id="VanillaSampling-79"><a href="#VanillaSampling-79"><span class="linenos"> 79</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">plan_len</span> <span class="o">=</span> <span class="n">set_plan_length</span><span class="p">(</span><span class="n">plan_len</span><span class="p">)</span>
</span><span id="VanillaSampling-80"><a href="#VanillaSampling-80"><span class="linenos"> 80</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">num_traces</span> <span class="o">=</span> <span class="n">set_num_traces</span><span class="p">(</span><span class="n">num_traces</span><span class="p">)</span>
</span><span id="VanillaSampling-81"><a href="#VanillaSampling-81"><span class="linenos"> 81</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_traces</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="VanillaSampling-82"><a href="#VanillaSampling-82"><span class="linenos"> 82</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">traces</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_traces</span><span class="p">()</span>
</span><span id="VanillaSampling-83"><a href="#VanillaSampling-83"><span class="linenos"> 83</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="VanillaSampling-84"><a href="#VanillaSampling-84"><span class="linenos"> 84</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">traces</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="VanillaSampling-85"><a href="#VanillaSampling-85"><span class="linenos"> 85</span></a>        <span class="k">if</span> <span class="n">seed</span><span class="p">:</span>
</span><span id="VanillaSampling-86"><a href="#VanillaSampling-86"><span class="linenos"> 86</span></a>            <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
</span><span id="VanillaSampling-87"><a href="#VanillaSampling-87"><span class="linenos"> 87</span></a>
</span><span id="VanillaSampling-88"><a href="#VanillaSampling-88"><span class="linenos"> 88</span></a>    <span class="k">def</span> <span class="nf">generate_traces</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="VanillaSampling-89"><a href="#VanillaSampling-89"><span class="linenos"> 89</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Generates traces randomly by uniformly sampling applicable actions to find plans</span>
</span><span id="VanillaSampling-90"><a href="#VanillaSampling-90"><span class="linenos"> 90</span></a><span class="sd">        of the given length.</span>
</span><span id="VanillaSampling-91"><a href="#VanillaSampling-91"><span class="linenos"> 91</span></a>
</span><span id="VanillaSampling-92"><a href="#VanillaSampling-92"><span class="linenos"> 92</span></a><span class="sd">        Returns:</span>
</span><span id="VanillaSampling-93"><a href="#VanillaSampling-93"><span class="linenos"> 93</span></a><span class="sd">            A TraceList object with the list of traces generated.</span>
</span><span id="VanillaSampling-94"><a href="#VanillaSampling-94"><span class="linenos"> 94</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="VanillaSampling-95"><a href="#VanillaSampling-95"><span class="linenos"> 95</span></a>        <span class="n">traces</span> <span class="o">=</span> <span class="n">TraceList</span><span class="p">()</span>
</span><span id="VanillaSampling-96"><a href="#VanillaSampling-96"><span class="linenos"> 96</span></a>        <span class="n">traces</span><span class="o">.</span><span class="n">generator</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_single_trace_setup</span><span class="p">(</span>
</span><span id="VanillaSampling-97"><a href="#VanillaSampling-97"><span class="linenos"> 97</span></a>            <span class="n">num_seconds</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">max_time</span><span class="p">,</span> <span class="n">plan_len</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">plan_len</span>
</span><span id="VanillaSampling-98"><a href="#VanillaSampling-98"><span class="linenos"> 98</span></a>        <span class="p">)</span>
</span><span id="VanillaSampling-99"><a href="#VanillaSampling-99"><span class="linenos"> 99</span></a>        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">print_progress</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_traces</span><span class="p">)):</span>
</span><span id="VanillaSampling-100"><a href="#VanillaSampling-100"><span class="linenos">100</span></a>            <span class="n">traces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">traces</span><span class="o">.</span><span class="n">generator</span><span class="p">())</span>
</span><span id="VanillaSampling-101"><a href="#VanillaSampling-101"><span class="linenos">101</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">traces</span> <span class="o">=</span> <span class="n">traces</span>
</span><span id="VanillaSampling-102"><a href="#VanillaSampling-102"><span class="linenos">102</span></a>        <span class="k">return</span> <span class="n">traces</span>
</span><span id="VanillaSampling-103"><a href="#VanillaSampling-103"><span class="linenos">103</span></a>
</span><span id="VanillaSampling-104"><a href="#VanillaSampling-104"><span class="linenos">104</span></a>    <span class="k">def</span> <span class="nf">generate_single_trace_setup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_seconds</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">plan_len</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="VanillaSampling-105"><a href="#VanillaSampling-105"><span class="linenos">105</span></a>        <span class="nd">@set_timer_throw_exc</span><span class="p">(</span>
</span><span id="VanillaSampling-106"><a href="#VanillaSampling-106"><span class="linenos">106</span></a>            <span class="n">num_seconds</span><span class="o">=</span><span class="n">num_seconds</span><span class="p">,</span> <span class="n">exception</span><span class="o">=</span><span class="n">TraceSearchTimeOut</span><span class="p">,</span> <span class="n">max_time</span><span class="o">=</span><span class="n">num_seconds</span>
</span><span id="VanillaSampling-107"><a href="#VanillaSampling-107"><span class="linenos">107</span></a>        <span class="p">)</span>
</span><span id="VanillaSampling-108"><a href="#VanillaSampling-108"><span class="linenos">108</span></a>        <span class="k">def</span> <span class="nf">generate_single_trace</span><span class="p">(</span><span class="bp">self</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">plan_len</span><span class="o">=</span><span class="n">plan_len</span><span class="p">):</span>
</span><span id="VanillaSampling-109"><a href="#VanillaSampling-109"><span class="linenos">109</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;Generates a single trace using the uniform random sampling technique.</span>
</span><span id="VanillaSampling-110"><a href="#VanillaSampling-110"><span class="linenos">110</span></a><span class="sd">            Loops until a valid trace is found. The timer wrapper does not allow the function</span>
</span><span id="VanillaSampling-111"><a href="#VanillaSampling-111"><span class="linenos">111</span></a><span class="sd">            to run past the time specified.</span>
</span><span id="VanillaSampling-112"><a href="#VanillaSampling-112"><span class="linenos">112</span></a>
</span><span id="VanillaSampling-113"><a href="#VanillaSampling-113"><span class="linenos">113</span></a><span class="sd">            The outside function is a wrapper that provides parameters for both the timer</span>
</span><span id="VanillaSampling-114"><a href="#VanillaSampling-114"><span class="linenos">114</span></a><span class="sd">            wrapper and the function.</span>
</span><span id="VanillaSampling-115"><a href="#VanillaSampling-115"><span class="linenos">115</span></a>
</span><span id="VanillaSampling-116"><a href="#VanillaSampling-116"><span class="linenos">116</span></a><span class="sd">            Returns:</span>
</span><span id="VanillaSampling-117"><a href="#VanillaSampling-117"><span class="linenos">117</span></a><span class="sd">                A Trace object (the valid trace generated).</span>
</span><span id="VanillaSampling-118"><a href="#VanillaSampling-118"><span class="linenos">118</span></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="VanillaSampling-119"><a href="#VanillaSampling-119"><span class="linenos">119</span></a>
</span><span id="VanillaSampling-120"><a href="#VanillaSampling-120"><span class="linenos">120</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">plan_len</span><span class="p">:</span>
</span><span id="VanillaSampling-121"><a href="#VanillaSampling-121"><span class="linenos">121</span></a>                <span class="n">plan_len</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plan_len</span>
</span><span id="VanillaSampling-122"><a href="#VanillaSampling-122"><span class="linenos">122</span></a>            <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">plan_len</span><span class="p">):</span>
</span><span id="VanillaSampling-123"><a href="#VanillaSampling-123"><span class="linenos">123</span></a>                <span class="n">plan_len</span> <span class="o">=</span> <span class="n">plan_len</span><span class="p">()</span>
</span><span id="VanillaSampling-124"><a href="#VanillaSampling-124"><span class="linenos">124</span></a>
</span><span id="VanillaSampling-125"><a href="#VanillaSampling-125"><span class="linenos">125</span></a>            <span class="n">trace</span> <span class="o">=</span> <span class="n">Trace</span><span class="p">()</span>
</span><span id="VanillaSampling-126"><a href="#VanillaSampling-126"><span class="linenos">126</span></a>
</span><span id="VanillaSampling-127"><a href="#VanillaSampling-127"><span class="linenos">127</span></a>            <span class="n">state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="o">.</span><span class="n">init</span>
</span><span id="VanillaSampling-128"><a href="#VanillaSampling-128"><span class="linenos">128</span></a>            <span class="n">valid_trace</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="VanillaSampling-129"><a href="#VanillaSampling-129"><span class="linenos">129</span></a>            <span class="k">while</span> <span class="ow">not</span> <span class="n">valid_trace</span><span class="p">:</span>
</span><span id="VanillaSampling-130"><a href="#VanillaSampling-130"><span class="linenos">130</span></a>                <span class="n">trace</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="VanillaSampling-131"><a href="#VanillaSampling-131"><span class="linenos">131</span></a>                <span class="c1"># add more steps while the trace has not yet reached the desired length</span>
</span><span id="VanillaSampling-132"><a href="#VanillaSampling-132"><span class="linenos">132</span></a>                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">plan_len</span><span class="p">):</span>
</span><span id="VanillaSampling-133"><a href="#VanillaSampling-133"><span class="linenos">133</span></a>                    <span class="c1"># if we have not yet reached the last step</span>
</span><span id="VanillaSampling-134"><a href="#VanillaSampling-134"><span class="linenos">134</span></a>                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">trace</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">plan_len</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="VanillaSampling-135"><a href="#VanillaSampling-135"><span class="linenos">135</span></a>                        <span class="c1"># find the next applicable actions</span>
</span><span id="VanillaSampling-136"><a href="#VanillaSampling-136"><span class="linenos">136</span></a>                        <span class="n">app_act</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">instance</span><span class="o">.</span><span class="n">applicable</span><span class="p">(</span><span class="n">state</span><span class="p">))</span>
</span><span id="VanillaSampling-137"><a href="#VanillaSampling-137"><span class="linenos">137</span></a>                        <span class="c1"># if the trace reaches a dead lock, disregard this trace and try again</span>
</span><span id="VanillaSampling-138"><a href="#VanillaSampling-138"><span class="linenos">138</span></a>                        <span class="k">if</span> <span class="ow">not</span> <span class="n">app_act</span><span class="p">:</span>
</span><span id="VanillaSampling-139"><a href="#VanillaSampling-139"><span class="linenos">139</span></a>                            <span class="k">break</span>
</span><span id="VanillaSampling-140"><a href="#VanillaSampling-140"><span class="linenos">140</span></a>                        <span class="c1"># pick a random applicable action and apply it</span>
</span><span id="VanillaSampling-141"><a href="#VanillaSampling-141"><span class="linenos">141</span></a>                        <span class="n">act</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">app_act</span><span class="p">)</span>
</span><span id="VanillaSampling-142"><a href="#VanillaSampling-142"><span class="linenos">142</span></a>                        <span class="c1"># create the trace and progress the state</span>
</span><span id="VanillaSampling-143"><a href="#VanillaSampling-143"><span class="linenos">143</span></a>                        <span class="n">macq_action</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarski_act_to_macq</span><span class="p">(</span><span class="n">act</span><span class="p">)</span>
</span><span id="VanillaSampling-144"><a href="#VanillaSampling-144"><span class="linenos">144</span></a>                        <span class="n">macq_state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarski_state_to_macq</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
</span><span id="VanillaSampling-145"><a href="#VanillaSampling-145"><span class="linenos">145</span></a>                        <span class="n">step</span> <span class="o">=</span> <span class="n">Step</span><span class="p">(</span><span class="n">macq_state</span><span class="p">,</span> <span class="n">macq_action</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="VanillaSampling-146"><a href="#VanillaSampling-146"><span class="linenos">146</span></a>                        <span class="n">trace</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">step</span><span class="p">)</span>
</span><span id="VanillaSampling-147"><a href="#VanillaSampling-147"><span class="linenos">147</span></a>                        <span class="n">state</span> <span class="o">=</span> <span class="n">progress</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">act</span><span class="p">)</span>
</span><span id="VanillaSampling-148"><a href="#VanillaSampling-148"><span class="linenos">148</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="VanillaSampling-149"><a href="#VanillaSampling-149"><span class="linenos">149</span></a>                        <span class="n">macq_state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarski_state_to_macq</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
</span><span id="VanillaSampling-150"><a href="#VanillaSampling-150"><span class="linenos">150</span></a>                        <span class="n">step</span> <span class="o">=</span> <span class="n">Step</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="n">macq_state</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="VanillaSampling-151"><a href="#VanillaSampling-151"><span class="linenos">151</span></a>                        <span class="n">trace</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">step</span><span class="p">)</span>
</span><span id="VanillaSampling-152"><a href="#VanillaSampling-152"><span class="linenos">152</span></a>                        <span class="n">valid_trace</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="VanillaSampling-153"><a href="#VanillaSampling-153"><span class="linenos">153</span></a>            <span class="k">return</span> <span class="n">trace</span>
</span><span id="VanillaSampling-154"><a href="#VanillaSampling-154"><span class="linenos">154</span></a>
</span><span id="VanillaSampling-155"><a href="#VanillaSampling-155"><span class="linenos">155</span></a>        <span class="k">return</span> <span class="n">generate_single_trace</span>
</span></pre></div>


            <div class="docstring"><p>Vanilla State Trace Sampler - inherits the base Generator class and its attributes.</p>

<p>A basic state trace generator that generates traces randomly by uniformly sampling applicable actions to find plans
of the given length.</p>

<p>Attributes:
    max_time (float):
        The maximum time allowed for a trace to be generated.
    plan_len (int):
        The length of the traces to be generated.
    num_traces (int):
        The number of traces to be generated.
    traces (TraceList):
        The list of traces generated.</p>
</div>


                            <div id="VanillaSampling.__init__" class="classattr">
                                        <input id="VanillaSampling.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">VanillaSampling</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">dom</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">prob</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">problem_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">observe_pres_effs</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">plan_len</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>,</span><span class="param">	<span class="n">num_traces</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>,</span><span class="param">	<span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">max_time</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">30</span></span>)</span>

                <label class="view-source-button" for="VanillaSampling.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#VanillaSampling.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="VanillaSampling.__init__-37"><a href="#VanillaSampling.__init__-37"><span class="linenos">37</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="VanillaSampling.__init__-38"><a href="#VanillaSampling.__init__-38"><span class="linenos">38</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="VanillaSampling.__init__-39"><a href="#VanillaSampling.__init__-39"><span class="linenos">39</span></a>        <span class="n">dom</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="VanillaSampling.__init__-40"><a href="#VanillaSampling.__init__-40"><span class="linenos">40</span></a>        <span class="n">prob</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="VanillaSampling.__init__-41"><a href="#VanillaSampling.__init__-41"><span class="linenos">41</span></a>        <span class="n">problem_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="VanillaSampling.__init__-42"><a href="#VanillaSampling.__init__-42"><span class="linenos">42</span></a>        <span class="n">observe_pres_effs</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="VanillaSampling.__init__-43"><a href="#VanillaSampling.__init__-43"><span class="linenos">43</span></a>        <span class="n">plan_len</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="VanillaSampling.__init__-44"><a href="#VanillaSampling.__init__-44"><span class="linenos">44</span></a>        <span class="n">num_traces</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="VanillaSampling.__init__-45"><a href="#VanillaSampling.__init__-45"><span class="linenos">45</span></a>        <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="VanillaSampling.__init__-46"><a href="#VanillaSampling.__init__-46"><span class="linenos">46</span></a>        <span class="n">max_time</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span>
</span><span id="VanillaSampling.__init__-47"><a href="#VanillaSampling.__init__-47"><span class="linenos">47</span></a>    <span class="p">):</span>
</span><span id="VanillaSampling.__init__-48"><a href="#VanillaSampling.__init__-48"><span class="linenos">48</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="VanillaSampling.__init__-49"><a href="#VanillaSampling.__init__-49"><span class="linenos">49</span></a><span class="sd">        Initializes a vanilla state trace sampler using the plan length, number of traces,</span>
</span><span id="VanillaSampling.__init__-50"><a href="#VanillaSampling.__init__-50"><span class="linenos">50</span></a><span class="sd">        and the domain and problem.</span>
</span><span id="VanillaSampling.__init__-51"><a href="#VanillaSampling.__init__-51"><span class="linenos">51</span></a>
</span><span id="VanillaSampling.__init__-52"><a href="#VanillaSampling.__init__-52"><span class="linenos">52</span></a><span class="sd">        Args:</span>
</span><span id="VanillaSampling.__init__-53"><a href="#VanillaSampling.__init__-53"><span class="linenos">53</span></a><span class="sd">            dom (str):</span>
</span><span id="VanillaSampling.__init__-54"><a href="#VanillaSampling.__init__-54"><span class="linenos">54</span></a><span class="sd">                The domain filename.</span>
</span><span id="VanillaSampling.__init__-55"><a href="#VanillaSampling.__init__-55"><span class="linenos">55</span></a><span class="sd">            prob (str):</span>
</span><span id="VanillaSampling.__init__-56"><a href="#VanillaSampling.__init__-56"><span class="linenos">56</span></a><span class="sd">                The problem filename.</span>
</span><span id="VanillaSampling.__init__-57"><a href="#VanillaSampling.__init__-57"><span class="linenos">57</span></a><span class="sd">            problem_id (int):</span>
</span><span id="VanillaSampling.__init__-58"><a href="#VanillaSampling.__init__-58"><span class="linenos">58</span></a><span class="sd">                The ID of the problem to access.</span>
</span><span id="VanillaSampling.__init__-59"><a href="#VanillaSampling.__init__-59"><span class="linenos">59</span></a><span class="sd">            max_time (float):</span>
</span><span id="VanillaSampling.__init__-60"><a href="#VanillaSampling.__init__-60"><span class="linenos">60</span></a><span class="sd">                The maximum time allowed for a trace to be generated.</span>
</span><span id="VanillaSampling.__init__-61"><a href="#VanillaSampling.__init__-61"><span class="linenos">61</span></a><span class="sd">            observe_pres_effs (bool):</span>
</span><span id="VanillaSampling.__init__-62"><a href="#VanillaSampling.__init__-62"><span class="linenos">62</span></a><span class="sd">                Option to observe action preconditions and effects upon generation.</span>
</span><span id="VanillaSampling.__init__-63"><a href="#VanillaSampling.__init__-63"><span class="linenos">63</span></a><span class="sd">            plan_len (int):</span>
</span><span id="VanillaSampling.__init__-64"><a href="#VanillaSampling.__init__-64"><span class="linenos">64</span></a><span class="sd">                The length of each generated trace. Defaults to 1.</span>
</span><span id="VanillaSampling.__init__-65"><a href="#VanillaSampling.__init__-65"><span class="linenos">65</span></a><span class="sd">            num_traces (int):</span>
</span><span id="VanillaSampling.__init__-66"><a href="#VanillaSampling.__init__-66"><span class="linenos">66</span></a><span class="sd">                The number of traces to generate. Defaults to 1.</span>
</span><span id="VanillaSampling.__init__-67"><a href="#VanillaSampling.__init__-67"><span class="linenos">67</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="VanillaSampling.__init__-68"><a href="#VanillaSampling.__init__-68"><span class="linenos">68</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="VanillaSampling.__init__-69"><a href="#VanillaSampling.__init__-69"><span class="linenos">69</span></a>            <span class="n">dom</span><span class="o">=</span><span class="n">dom</span><span class="p">,</span>
</span><span id="VanillaSampling.__init__-70"><a href="#VanillaSampling.__init__-70"><span class="linenos">70</span></a>            <span class="n">prob</span><span class="o">=</span><span class="n">prob</span><span class="p">,</span>
</span><span id="VanillaSampling.__init__-71"><a href="#VanillaSampling.__init__-71"><span class="linenos">71</span></a>            <span class="n">problem_id</span><span class="o">=</span><span class="n">problem_id</span><span class="p">,</span>
</span><span id="VanillaSampling.__init__-72"><a href="#VanillaSampling.__init__-72"><span class="linenos">72</span></a>            <span class="n">observe_pres_effs</span><span class="o">=</span><span class="n">observe_pres_effs</span><span class="p">,</span>
</span><span id="VanillaSampling.__init__-73"><a href="#VanillaSampling.__init__-73"><span class="linenos">73</span></a>        <span class="p">)</span>
</span><span id="VanillaSampling.__init__-74"><a href="#VanillaSampling.__init__-74"><span class="linenos">74</span></a>        <span class="k">if</span> <span class="n">max_time</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="VanillaSampling.__init__-75"><a href="#VanillaSampling.__init__-75"><span class="linenos">75</span></a>            <span class="k">raise</span> <span class="n">InvalidTime</span><span class="p">()</span>
</span><span id="VanillaSampling.__init__-76"><a href="#VanillaSampling.__init__-76"><span class="linenos">76</span></a>        <span class="k">if</span> <span class="n">seed</span><span class="p">:</span>
</span><span id="VanillaSampling.__init__-77"><a href="#VanillaSampling.__init__-77"><span class="linenos">77</span></a>            <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
</span><span id="VanillaSampling.__init__-78"><a href="#VanillaSampling.__init__-78"><span class="linenos">78</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">max_time</span> <span class="o">=</span> <span class="n">max_time</span>
</span><span id="VanillaSampling.__init__-79"><a href="#VanillaSampling.__init__-79"><span class="linenos">79</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">plan_len</span> <span class="o">=</span> <span class="n">set_plan_length</span><span class="p">(</span><span class="n">plan_len</span><span class="p">)</span>
</span><span id="VanillaSampling.__init__-80"><a href="#VanillaSampling.__init__-80"><span class="linenos">80</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">num_traces</span> <span class="o">=</span> <span class="n">set_num_traces</span><span class="p">(</span><span class="n">num_traces</span><span class="p">)</span>
</span><span id="VanillaSampling.__init__-81"><a href="#VanillaSampling.__init__-81"><span class="linenos">81</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_traces</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="VanillaSampling.__init__-82"><a href="#VanillaSampling.__init__-82"><span class="linenos">82</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">traces</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_traces</span><span class="p">()</span>
</span><span id="VanillaSampling.__init__-83"><a href="#VanillaSampling.__init__-83"><span class="linenos">83</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="VanillaSampling.__init__-84"><a href="#VanillaSampling.__init__-84"><span class="linenos">84</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">traces</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="VanillaSampling.__init__-85"><a href="#VanillaSampling.__init__-85"><span class="linenos">85</span></a>        <span class="k">if</span> <span class="n">seed</span><span class="p">:</span>
</span><span id="VanillaSampling.__init__-86"><a href="#VanillaSampling.__init__-86"><span class="linenos">86</span></a>            <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Initializes a vanilla state trace sampler using the plan length, number of traces,
and the domain and problem.</p>

<p>Args:
    dom (str):
        The domain filename.
    prob (str):
        The problem filename.
    problem_id (int):
        The ID of the problem to access.
    max_time (float):
        The maximum time allowed for a trace to be generated.
    observe_pres_effs (bool):
        Option to observe action preconditions and effects upon generation.
    plan_len (int):
        The length of each generated trace. Defaults to 1.
    num_traces (int):
        The number of traces to generate. Defaults to 1.</p>
</div>


                            </div>
                            <div id="VanillaSampling.generate_traces" class="classattr">
                                        <input id="VanillaSampling.generate_traces-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">generate_traces</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="VanillaSampling.generate_traces-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#VanillaSampling.generate_traces"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="VanillaSampling.generate_traces-88"><a href="#VanillaSampling.generate_traces-88"><span class="linenos"> 88</span></a>    <span class="k">def</span> <span class="nf">generate_traces</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="VanillaSampling.generate_traces-89"><a href="#VanillaSampling.generate_traces-89"><span class="linenos"> 89</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Generates traces randomly by uniformly sampling applicable actions to find plans</span>
</span><span id="VanillaSampling.generate_traces-90"><a href="#VanillaSampling.generate_traces-90"><span class="linenos"> 90</span></a><span class="sd">        of the given length.</span>
</span><span id="VanillaSampling.generate_traces-91"><a href="#VanillaSampling.generate_traces-91"><span class="linenos"> 91</span></a>
</span><span id="VanillaSampling.generate_traces-92"><a href="#VanillaSampling.generate_traces-92"><span class="linenos"> 92</span></a><span class="sd">        Returns:</span>
</span><span id="VanillaSampling.generate_traces-93"><a href="#VanillaSampling.generate_traces-93"><span class="linenos"> 93</span></a><span class="sd">            A TraceList object with the list of traces generated.</span>
</span><span id="VanillaSampling.generate_traces-94"><a href="#VanillaSampling.generate_traces-94"><span class="linenos"> 94</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="VanillaSampling.generate_traces-95"><a href="#VanillaSampling.generate_traces-95"><span class="linenos"> 95</span></a>        <span class="n">traces</span> <span class="o">=</span> <span class="n">TraceList</span><span class="p">()</span>
</span><span id="VanillaSampling.generate_traces-96"><a href="#VanillaSampling.generate_traces-96"><span class="linenos"> 96</span></a>        <span class="n">traces</span><span class="o">.</span><span class="n">generator</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_single_trace_setup</span><span class="p">(</span>
</span><span id="VanillaSampling.generate_traces-97"><a href="#VanillaSampling.generate_traces-97"><span class="linenos"> 97</span></a>            <span class="n">num_seconds</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">max_time</span><span class="p">,</span> <span class="n">plan_len</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">plan_len</span>
</span><span id="VanillaSampling.generate_traces-98"><a href="#VanillaSampling.generate_traces-98"><span class="linenos"> 98</span></a>        <span class="p">)</span>
</span><span id="VanillaSampling.generate_traces-99"><a href="#VanillaSampling.generate_traces-99"><span class="linenos"> 99</span></a>        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">print_progress</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_traces</span><span class="p">)):</span>
</span><span id="VanillaSampling.generate_traces-100"><a href="#VanillaSampling.generate_traces-100"><span class="linenos">100</span></a>            <span class="n">traces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">traces</span><span class="o">.</span><span class="n">generator</span><span class="p">())</span>
</span><span id="VanillaSampling.generate_traces-101"><a href="#VanillaSampling.generate_traces-101"><span class="linenos">101</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">traces</span> <span class="o">=</span> <span class="n">traces</span>
</span><span id="VanillaSampling.generate_traces-102"><a href="#VanillaSampling.generate_traces-102"><span class="linenos">102</span></a>        <span class="k">return</span> <span class="n">traces</span>
</span></pre></div>


            <div class="docstring"><p>Generates traces randomly by uniformly sampling applicable actions to find plans
of the given length.</p>

<p>Returns:
    A TraceList object with the list of traces generated.</p>
</div>


                            </div>
                            <div id="VanillaSampling.generate_single_trace_setup" class="classattr">
                                        <input id="VanillaSampling.generate_single_trace_setup-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">generate_single_trace_setup</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">num_seconds</span><span class="p">:</span> <span class="nb">float</span>, </span><span class="param"><span class="n">plan_len</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="VanillaSampling.generate_single_trace_setup-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#VanillaSampling.generate_single_trace_setup"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="VanillaSampling.generate_single_trace_setup-104"><a href="#VanillaSampling.generate_single_trace_setup-104"><span class="linenos">104</span></a>    <span class="k">def</span> <span class="nf">generate_single_trace_setup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_seconds</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">plan_len</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="VanillaSampling.generate_single_trace_setup-105"><a href="#VanillaSampling.generate_single_trace_setup-105"><span class="linenos">105</span></a>        <span class="nd">@set_timer_throw_exc</span><span class="p">(</span>
</span><span id="VanillaSampling.generate_single_trace_setup-106"><a href="#VanillaSampling.generate_single_trace_setup-106"><span class="linenos">106</span></a>            <span class="n">num_seconds</span><span class="o">=</span><span class="n">num_seconds</span><span class="p">,</span> <span class="n">exception</span><span class="o">=</span><span class="n">TraceSearchTimeOut</span><span class="p">,</span> <span class="n">max_time</span><span class="o">=</span><span class="n">num_seconds</span>
</span><span id="VanillaSampling.generate_single_trace_setup-107"><a href="#VanillaSampling.generate_single_trace_setup-107"><span class="linenos">107</span></a>        <span class="p">)</span>
</span><span id="VanillaSampling.generate_single_trace_setup-108"><a href="#VanillaSampling.generate_single_trace_setup-108"><span class="linenos">108</span></a>        <span class="k">def</span> <span class="nf">generate_single_trace</span><span class="p">(</span><span class="bp">self</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">plan_len</span><span class="o">=</span><span class="n">plan_len</span><span class="p">):</span>
</span><span id="VanillaSampling.generate_single_trace_setup-109"><a href="#VanillaSampling.generate_single_trace_setup-109"><span class="linenos">109</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;Generates a single trace using the uniform random sampling technique.</span>
</span><span id="VanillaSampling.generate_single_trace_setup-110"><a href="#VanillaSampling.generate_single_trace_setup-110"><span class="linenos">110</span></a><span class="sd">            Loops until a valid trace is found. The timer wrapper does not allow the function</span>
</span><span id="VanillaSampling.generate_single_trace_setup-111"><a href="#VanillaSampling.generate_single_trace_setup-111"><span class="linenos">111</span></a><span class="sd">            to run past the time specified.</span>
</span><span id="VanillaSampling.generate_single_trace_setup-112"><a href="#VanillaSampling.generate_single_trace_setup-112"><span class="linenos">112</span></a>
</span><span id="VanillaSampling.generate_single_trace_setup-113"><a href="#VanillaSampling.generate_single_trace_setup-113"><span class="linenos">113</span></a><span class="sd">            The outside function is a wrapper that provides parameters for both the timer</span>
</span><span id="VanillaSampling.generate_single_trace_setup-114"><a href="#VanillaSampling.generate_single_trace_setup-114"><span class="linenos">114</span></a><span class="sd">            wrapper and the function.</span>
</span><span id="VanillaSampling.generate_single_trace_setup-115"><a href="#VanillaSampling.generate_single_trace_setup-115"><span class="linenos">115</span></a>
</span><span id="VanillaSampling.generate_single_trace_setup-116"><a href="#VanillaSampling.generate_single_trace_setup-116"><span class="linenos">116</span></a><span class="sd">            Returns:</span>
</span><span id="VanillaSampling.generate_single_trace_setup-117"><a href="#VanillaSampling.generate_single_trace_setup-117"><span class="linenos">117</span></a><span class="sd">                A Trace object (the valid trace generated).</span>
</span><span id="VanillaSampling.generate_single_trace_setup-118"><a href="#VanillaSampling.generate_single_trace_setup-118"><span class="linenos">118</span></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="VanillaSampling.generate_single_trace_setup-119"><a href="#VanillaSampling.generate_single_trace_setup-119"><span class="linenos">119</span></a>
</span><span id="VanillaSampling.generate_single_trace_setup-120"><a href="#VanillaSampling.generate_single_trace_setup-120"><span class="linenos">120</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">plan_len</span><span class="p">:</span>
</span><span id="VanillaSampling.generate_single_trace_setup-121"><a href="#VanillaSampling.generate_single_trace_setup-121"><span class="linenos">121</span></a>                <span class="n">plan_len</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plan_len</span>
</span><span id="VanillaSampling.generate_single_trace_setup-122"><a href="#VanillaSampling.generate_single_trace_setup-122"><span class="linenos">122</span></a>            <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">plan_len</span><span class="p">):</span>
</span><span id="VanillaSampling.generate_single_trace_setup-123"><a href="#VanillaSampling.generate_single_trace_setup-123"><span class="linenos">123</span></a>                <span class="n">plan_len</span> <span class="o">=</span> <span class="n">plan_len</span><span class="p">()</span>
</span><span id="VanillaSampling.generate_single_trace_setup-124"><a href="#VanillaSampling.generate_single_trace_setup-124"><span class="linenos">124</span></a>
</span><span id="VanillaSampling.generate_single_trace_setup-125"><a href="#VanillaSampling.generate_single_trace_setup-125"><span class="linenos">125</span></a>            <span class="n">trace</span> <span class="o">=</span> <span class="n">Trace</span><span class="p">()</span>
</span><span id="VanillaSampling.generate_single_trace_setup-126"><a href="#VanillaSampling.generate_single_trace_setup-126"><span class="linenos">126</span></a>
</span><span id="VanillaSampling.generate_single_trace_setup-127"><a href="#VanillaSampling.generate_single_trace_setup-127"><span class="linenos">127</span></a>            <span class="n">state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="o">.</span><span class="n">init</span>
</span><span id="VanillaSampling.generate_single_trace_setup-128"><a href="#VanillaSampling.generate_single_trace_setup-128"><span class="linenos">128</span></a>            <span class="n">valid_trace</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="VanillaSampling.generate_single_trace_setup-129"><a href="#VanillaSampling.generate_single_trace_setup-129"><span class="linenos">129</span></a>            <span class="k">while</span> <span class="ow">not</span> <span class="n">valid_trace</span><span class="p">:</span>
</span><span id="VanillaSampling.generate_single_trace_setup-130"><a href="#VanillaSampling.generate_single_trace_setup-130"><span class="linenos">130</span></a>                <span class="n">trace</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="VanillaSampling.generate_single_trace_setup-131"><a href="#VanillaSampling.generate_single_trace_setup-131"><span class="linenos">131</span></a>                <span class="c1"># add more steps while the trace has not yet reached the desired length</span>
</span><span id="VanillaSampling.generate_single_trace_setup-132"><a href="#VanillaSampling.generate_single_trace_setup-132"><span class="linenos">132</span></a>                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">plan_len</span><span class="p">):</span>
</span><span id="VanillaSampling.generate_single_trace_setup-133"><a href="#VanillaSampling.generate_single_trace_setup-133"><span class="linenos">133</span></a>                    <span class="c1"># if we have not yet reached the last step</span>
</span><span id="VanillaSampling.generate_single_trace_setup-134"><a href="#VanillaSampling.generate_single_trace_setup-134"><span class="linenos">134</span></a>                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">trace</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">plan_len</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="VanillaSampling.generate_single_trace_setup-135"><a href="#VanillaSampling.generate_single_trace_setup-135"><span class="linenos">135</span></a>                        <span class="c1"># find the next applicable actions</span>
</span><span id="VanillaSampling.generate_single_trace_setup-136"><a href="#VanillaSampling.generate_single_trace_setup-136"><span class="linenos">136</span></a>                        <span class="n">app_act</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">instance</span><span class="o">.</span><span class="n">applicable</span><span class="p">(</span><span class="n">state</span><span class="p">))</span>
</span><span id="VanillaSampling.generate_single_trace_setup-137"><a href="#VanillaSampling.generate_single_trace_setup-137"><span class="linenos">137</span></a>                        <span class="c1"># if the trace reaches a dead lock, disregard this trace and try again</span>
</span><span id="VanillaSampling.generate_single_trace_setup-138"><a href="#VanillaSampling.generate_single_trace_setup-138"><span class="linenos">138</span></a>                        <span class="k">if</span> <span class="ow">not</span> <span class="n">app_act</span><span class="p">:</span>
</span><span id="VanillaSampling.generate_single_trace_setup-139"><a href="#VanillaSampling.generate_single_trace_setup-139"><span class="linenos">139</span></a>                            <span class="k">break</span>
</span><span id="VanillaSampling.generate_single_trace_setup-140"><a href="#VanillaSampling.generate_single_trace_setup-140"><span class="linenos">140</span></a>                        <span class="c1"># pick a random applicable action and apply it</span>
</span><span id="VanillaSampling.generate_single_trace_setup-141"><a href="#VanillaSampling.generate_single_trace_setup-141"><span class="linenos">141</span></a>                        <span class="n">act</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">app_act</span><span class="p">)</span>
</span><span id="VanillaSampling.generate_single_trace_setup-142"><a href="#VanillaSampling.generate_single_trace_setup-142"><span class="linenos">142</span></a>                        <span class="c1"># create the trace and progress the state</span>
</span><span id="VanillaSampling.generate_single_trace_setup-143"><a href="#VanillaSampling.generate_single_trace_setup-143"><span class="linenos">143</span></a>                        <span class="n">macq_action</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarski_act_to_macq</span><span class="p">(</span><span class="n">act</span><span class="p">)</span>
</span><span id="VanillaSampling.generate_single_trace_setup-144"><a href="#VanillaSampling.generate_single_trace_setup-144"><span class="linenos">144</span></a>                        <span class="n">macq_state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarski_state_to_macq</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
</span><span id="VanillaSampling.generate_single_trace_setup-145"><a href="#VanillaSampling.generate_single_trace_setup-145"><span class="linenos">145</span></a>                        <span class="n">step</span> <span class="o">=</span> <span class="n">Step</span><span class="p">(</span><span class="n">macq_state</span><span class="p">,</span> <span class="n">macq_action</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="VanillaSampling.generate_single_trace_setup-146"><a href="#VanillaSampling.generate_single_trace_setup-146"><span class="linenos">146</span></a>                        <span class="n">trace</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">step</span><span class="p">)</span>
</span><span id="VanillaSampling.generate_single_trace_setup-147"><a href="#VanillaSampling.generate_single_trace_setup-147"><span class="linenos">147</span></a>                        <span class="n">state</span> <span class="o">=</span> <span class="n">progress</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">act</span><span class="p">)</span>
</span><span id="VanillaSampling.generate_single_trace_setup-148"><a href="#VanillaSampling.generate_single_trace_setup-148"><span class="linenos">148</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="VanillaSampling.generate_single_trace_setup-149"><a href="#VanillaSampling.generate_single_trace_setup-149"><span class="linenos">149</span></a>                        <span class="n">macq_state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarski_state_to_macq</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
</span><span id="VanillaSampling.generate_single_trace_setup-150"><a href="#VanillaSampling.generate_single_trace_setup-150"><span class="linenos">150</span></a>                        <span class="n">step</span> <span class="o">=</span> <span class="n">Step</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="n">macq_state</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="VanillaSampling.generate_single_trace_setup-151"><a href="#VanillaSampling.generate_single_trace_setup-151"><span class="linenos">151</span></a>                        <span class="n">trace</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">step</span><span class="p">)</span>
</span><span id="VanillaSampling.generate_single_trace_setup-152"><a href="#VanillaSampling.generate_single_trace_setup-152"><span class="linenos">152</span></a>                        <span class="n">valid_trace</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="VanillaSampling.generate_single_trace_setup-153"><a href="#VanillaSampling.generate_single_trace_setup-153"><span class="linenos">153</span></a>            <span class="k">return</span> <span class="n">trace</span>
</span><span id="VanillaSampling.generate_single_trace_setup-154"><a href="#VanillaSampling.generate_single_trace_setup-154"><span class="linenos">154</span></a>
</span><span id="VanillaSampling.generate_single_trace_setup-155"><a href="#VanillaSampling.generate_single_trace_setup-155"><span class="linenos">155</span></a>        <span class="k">return</span> <span class="n">generate_single_trace</span>
</span></pre></div>


    

                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#Generator">Generator</a></dt>
                                <dd id="VanillaSampling.extract_action_typing" class="function"><a href="#Generator.extract_action_typing">extract_action_typing</a></dd>
                <dd id="VanillaSampling.extract_predicate_typing" class="function"><a href="#Generator.extract_predicate_typing">extract_predicate_typing</a></dd>
                <dd id="VanillaSampling.tarski_state_to_macq" class="function"><a href="#Generator.tarski_state_to_macq">tarski_state_to_macq</a></dd>
                <dd id="VanillaSampling.tarski_act_to_macq" class="function"><a href="#Generator.tarski_act_to_macq">tarski_act_to_macq</a></dd>
                <dd id="VanillaSampling.change_init" class="function"><a href="#Generator.change_init">change_init</a></dd>
                <dd id="VanillaSampling.change_goal" class="function"><a href="#Generator.change_goal">change_goal</a></dd>
                <dd id="VanillaSampling.generate_plan" class="function"><a href="#Generator.generate_plan">generate_plan</a></dd>
                <dd id="VanillaSampling.generate_single_trace_from_plan" class="function"><a href="#Generator.generate_single_trace_from_plan">generate_single_trace_from_plan</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="TraceFromGoal">
                            <input id="TraceFromGoal-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">TraceFromGoal</span><wbr>(<span class="base"><a href="#Generator">macq.generate.pddl.Generator</a></span>):

                <label class="view-source-button" for="TraceFromGoal-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TraceFromGoal"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TraceFromGoal-5"><a href="#TraceFromGoal-5"><span class="linenos"> 5</span></a><span class="k">class</span> <span class="nc">TraceFromGoal</span><span class="p">(</span><span class="n">Generator</span><span class="p">):</span>
</span><span id="TraceFromGoal-6"><a href="#TraceFromGoal-6"><span class="linenos"> 6</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="TraceFromGoal-7"><a href="#TraceFromGoal-7"><span class="linenos"> 7</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="TraceFromGoal-8"><a href="#TraceFromGoal-8"><span class="linenos"> 8</span></a>        <span class="n">dom</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="TraceFromGoal-9"><a href="#TraceFromGoal-9"><span class="linenos"> 9</span></a>        <span class="n">prob</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="TraceFromGoal-10"><a href="#TraceFromGoal-10"><span class="linenos">10</span></a>        <span class="n">problem_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="TraceFromGoal-11"><a href="#TraceFromGoal-11"><span class="linenos">11</span></a>        <span class="n">observe_pres_effs</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="TraceFromGoal-12"><a href="#TraceFromGoal-12"><span class="linenos">12</span></a>    <span class="p">):</span>
</span><span id="TraceFromGoal-13"><a href="#TraceFromGoal-13"><span class="linenos">13</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TraceFromGoal-14"><a href="#TraceFromGoal-14"><span class="linenos">14</span></a><span class="sd">        Initializes a goal state trace sampler using the domain and problem. This method of sampling</span>
</span><span id="TraceFromGoal-15"><a href="#TraceFromGoal-15"><span class="linenos">15</span></a><span class="sd">        takes the goal of the problem into account and uses a generated plan to generate a trace.</span>
</span><span id="TraceFromGoal-16"><a href="#TraceFromGoal-16"><span class="linenos">16</span></a>
</span><span id="TraceFromGoal-17"><a href="#TraceFromGoal-17"><span class="linenos">17</span></a><span class="sd">        Args:</span>
</span><span id="TraceFromGoal-18"><a href="#TraceFromGoal-18"><span class="linenos">18</span></a><span class="sd">            dom (str):</span>
</span><span id="TraceFromGoal-19"><a href="#TraceFromGoal-19"><span class="linenos">19</span></a><span class="sd">                The domain filename.</span>
</span><span id="TraceFromGoal-20"><a href="#TraceFromGoal-20"><span class="linenos">20</span></a><span class="sd">            prob (str):</span>
</span><span id="TraceFromGoal-21"><a href="#TraceFromGoal-21"><span class="linenos">21</span></a><span class="sd">                The problem filename.</span>
</span><span id="TraceFromGoal-22"><a href="#TraceFromGoal-22"><span class="linenos">22</span></a><span class="sd">            problem_id (int):</span>
</span><span id="TraceFromGoal-23"><a href="#TraceFromGoal-23"><span class="linenos">23</span></a><span class="sd">                The ID of the problem to access.</span>
</span><span id="TraceFromGoal-24"><a href="#TraceFromGoal-24"><span class="linenos">24</span></a><span class="sd">            observe_pres_effs (bool):</span>
</span><span id="TraceFromGoal-25"><a href="#TraceFromGoal-25"><span class="linenos">25</span></a><span class="sd">                Option to observe action preconditions and effects upon generation.</span>
</span><span id="TraceFromGoal-26"><a href="#TraceFromGoal-26"><span class="linenos">26</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TraceFromGoal-27"><a href="#TraceFromGoal-27"><span class="linenos">27</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="TraceFromGoal-28"><a href="#TraceFromGoal-28"><span class="linenos">28</span></a>            <span class="n">dom</span><span class="o">=</span><span class="n">dom</span><span class="p">,</span>
</span><span id="TraceFromGoal-29"><a href="#TraceFromGoal-29"><span class="linenos">29</span></a>            <span class="n">prob</span><span class="o">=</span><span class="n">prob</span><span class="p">,</span>
</span><span id="TraceFromGoal-30"><a href="#TraceFromGoal-30"><span class="linenos">30</span></a>            <span class="n">problem_id</span><span class="o">=</span><span class="n">problem_id</span><span class="p">,</span>
</span><span id="TraceFromGoal-31"><a href="#TraceFromGoal-31"><span class="linenos">31</span></a>            <span class="n">observe_pres_effs</span><span class="o">=</span><span class="n">observe_pres_effs</span><span class="p">,</span>
</span><span id="TraceFromGoal-32"><a href="#TraceFromGoal-32"><span class="linenos">32</span></a>        <span class="p">)</span>
</span><span id="TraceFromGoal-33"><a href="#TraceFromGoal-33"><span class="linenos">33</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">trace</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_trace</span><span class="p">()</span>
</span><span id="TraceFromGoal-34"><a href="#TraceFromGoal-34"><span class="linenos">34</span></a>
</span><span id="TraceFromGoal-35"><a href="#TraceFromGoal-35"><span class="linenos">35</span></a>    <span class="k">def</span> <span class="nf">generate_trace</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="TraceFromGoal-36"><a href="#TraceFromGoal-36"><span class="linenos">36</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">trace</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_single_trace_from_plan</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">generate_plan</span><span class="p">())</span>
</span><span id="TraceFromGoal-37"><a href="#TraceFromGoal-37"><span class="linenos">37</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">trace</span>
</span></pre></div>


            <div class="docstring"><p>A Generator.</p>

<p>A basic PDDL state trace generator. Handles all parsing and stores the problem,
language, and grounded instance for the child generators to easily access and use.</p>

<p>Attributes:
    pddl_dom (str):
        The name of the local PDDL domain filename (relevant if the problem ID is not provided.)
    pddl_prob (str):
        The name of the local PDDL problem filename (relevant if the problem ID is not provided.)
    problem_id (int):
        The ID of the problem to be accessed (relevant if local files are not provided.)
    problem (tarski.fstrips.problem.Problem):
        The problem definition.
    lang (tarski.fol.FirstOrderLanguage):
        The language definition.
    instance (GroundForwardSearchModel):
        The grounded instance of the problem.
    grounded_fluents (list):
        A list of all grounded (macq) fluents extracted from the given problem definition.
    op_dict (dict):
        The problem's ground operators, formatted to a dictionary for easy access during plan generation.
    observe_pres_effs (bool):
        Option to observe action preconditions and effects upon generation.</p>
</div>


                            <div id="TraceFromGoal.__init__" class="classattr">
                                        <input id="TraceFromGoal.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">TraceFromGoal</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">dom</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">prob</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">problem_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">observe_pres_effs</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span>)</span>

                <label class="view-source-button" for="TraceFromGoal.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TraceFromGoal.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TraceFromGoal.__init__-6"><a href="#TraceFromGoal.__init__-6"><span class="linenos"> 6</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="TraceFromGoal.__init__-7"><a href="#TraceFromGoal.__init__-7"><span class="linenos"> 7</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="TraceFromGoal.__init__-8"><a href="#TraceFromGoal.__init__-8"><span class="linenos"> 8</span></a>        <span class="n">dom</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="TraceFromGoal.__init__-9"><a href="#TraceFromGoal.__init__-9"><span class="linenos"> 9</span></a>        <span class="n">prob</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="TraceFromGoal.__init__-10"><a href="#TraceFromGoal.__init__-10"><span class="linenos">10</span></a>        <span class="n">problem_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="TraceFromGoal.__init__-11"><a href="#TraceFromGoal.__init__-11"><span class="linenos">11</span></a>        <span class="n">observe_pres_effs</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="TraceFromGoal.__init__-12"><a href="#TraceFromGoal.__init__-12"><span class="linenos">12</span></a>    <span class="p">):</span>
</span><span id="TraceFromGoal.__init__-13"><a href="#TraceFromGoal.__init__-13"><span class="linenos">13</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TraceFromGoal.__init__-14"><a href="#TraceFromGoal.__init__-14"><span class="linenos">14</span></a><span class="sd">        Initializes a goal state trace sampler using the domain and problem. This method of sampling</span>
</span><span id="TraceFromGoal.__init__-15"><a href="#TraceFromGoal.__init__-15"><span class="linenos">15</span></a><span class="sd">        takes the goal of the problem into account and uses a generated plan to generate a trace.</span>
</span><span id="TraceFromGoal.__init__-16"><a href="#TraceFromGoal.__init__-16"><span class="linenos">16</span></a>
</span><span id="TraceFromGoal.__init__-17"><a href="#TraceFromGoal.__init__-17"><span class="linenos">17</span></a><span class="sd">        Args:</span>
</span><span id="TraceFromGoal.__init__-18"><a href="#TraceFromGoal.__init__-18"><span class="linenos">18</span></a><span class="sd">            dom (str):</span>
</span><span id="TraceFromGoal.__init__-19"><a href="#TraceFromGoal.__init__-19"><span class="linenos">19</span></a><span class="sd">                The domain filename.</span>
</span><span id="TraceFromGoal.__init__-20"><a href="#TraceFromGoal.__init__-20"><span class="linenos">20</span></a><span class="sd">            prob (str):</span>
</span><span id="TraceFromGoal.__init__-21"><a href="#TraceFromGoal.__init__-21"><span class="linenos">21</span></a><span class="sd">                The problem filename.</span>
</span><span id="TraceFromGoal.__init__-22"><a href="#TraceFromGoal.__init__-22"><span class="linenos">22</span></a><span class="sd">            problem_id (int):</span>
</span><span id="TraceFromGoal.__init__-23"><a href="#TraceFromGoal.__init__-23"><span class="linenos">23</span></a><span class="sd">                The ID of the problem to access.</span>
</span><span id="TraceFromGoal.__init__-24"><a href="#TraceFromGoal.__init__-24"><span class="linenos">24</span></a><span class="sd">            observe_pres_effs (bool):</span>
</span><span id="TraceFromGoal.__init__-25"><a href="#TraceFromGoal.__init__-25"><span class="linenos">25</span></a><span class="sd">                Option to observe action preconditions and effects upon generation.</span>
</span><span id="TraceFromGoal.__init__-26"><a href="#TraceFromGoal.__init__-26"><span class="linenos">26</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TraceFromGoal.__init__-27"><a href="#TraceFromGoal.__init__-27"><span class="linenos">27</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="TraceFromGoal.__init__-28"><a href="#TraceFromGoal.__init__-28"><span class="linenos">28</span></a>            <span class="n">dom</span><span class="o">=</span><span class="n">dom</span><span class="p">,</span>
</span><span id="TraceFromGoal.__init__-29"><a href="#TraceFromGoal.__init__-29"><span class="linenos">29</span></a>            <span class="n">prob</span><span class="o">=</span><span class="n">prob</span><span class="p">,</span>
</span><span id="TraceFromGoal.__init__-30"><a href="#TraceFromGoal.__init__-30"><span class="linenos">30</span></a>            <span class="n">problem_id</span><span class="o">=</span><span class="n">problem_id</span><span class="p">,</span>
</span><span id="TraceFromGoal.__init__-31"><a href="#TraceFromGoal.__init__-31"><span class="linenos">31</span></a>            <span class="n">observe_pres_effs</span><span class="o">=</span><span class="n">observe_pres_effs</span><span class="p">,</span>
</span><span id="TraceFromGoal.__init__-32"><a href="#TraceFromGoal.__init__-32"><span class="linenos">32</span></a>        <span class="p">)</span>
</span><span id="TraceFromGoal.__init__-33"><a href="#TraceFromGoal.__init__-33"><span class="linenos">33</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">trace</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_trace</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Initializes a goal state trace sampler using the domain and problem. This method of sampling
takes the goal of the problem into account and uses a generated plan to generate a trace.</p>

<p>Args:
    dom (str):
        The domain filename.
    prob (str):
        The problem filename.
    problem_id (int):
        The ID of the problem to access.
    observe_pres_effs (bool):
        Option to observe action preconditions and effects upon generation.</p>
</div>


                            </div>
                            <div id="TraceFromGoal.generate_trace" class="classattr">
                                        <input id="TraceFromGoal.generate_trace-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">generate_trace</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="TraceFromGoal.generate_trace-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TraceFromGoal.generate_trace"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TraceFromGoal.generate_trace-35"><a href="#TraceFromGoal.generate_trace-35"><span class="linenos">35</span></a>    <span class="k">def</span> <span class="nf">generate_trace</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="TraceFromGoal.generate_trace-36"><a href="#TraceFromGoal.generate_trace-36"><span class="linenos">36</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">trace</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_single_trace_from_plan</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">generate_plan</span><span class="p">())</span>
</span><span id="TraceFromGoal.generate_trace-37"><a href="#TraceFromGoal.generate_trace-37"><span class="linenos">37</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">trace</span>
</span></pre></div>


    

                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#Generator">Generator</a></dt>
                                <dd id="TraceFromGoal.extract_action_typing" class="function"><a href="#Generator.extract_action_typing">extract_action_typing</a></dd>
                <dd id="TraceFromGoal.extract_predicate_typing" class="function"><a href="#Generator.extract_predicate_typing">extract_predicate_typing</a></dd>
                <dd id="TraceFromGoal.tarski_state_to_macq" class="function"><a href="#Generator.tarski_state_to_macq">tarski_state_to_macq</a></dd>
                <dd id="TraceFromGoal.tarski_act_to_macq" class="function"><a href="#Generator.tarski_act_to_macq">tarski_act_to_macq</a></dd>
                <dd id="TraceFromGoal.change_init" class="function"><a href="#Generator.change_init">change_init</a></dd>
                <dd id="TraceFromGoal.change_goal" class="function"><a href="#Generator.change_goal">change_goal</a></dd>
                <dd id="TraceFromGoal.generate_plan" class="function"><a href="#Generator.generate_plan">generate_plan</a></dd>
                <dd id="TraceFromGoal.generate_single_trace_from_plan" class="function"><a href="#Generator.generate_single_trace_from_plan">generate_single_trace_from_plan</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="RandomGoalSampling">
                            <input id="RandomGoalSampling-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">RandomGoalSampling</span><wbr>(<span class="base"><a href="#VanillaSampling">macq.generate.pddl.VanillaSampling</a></span>):

                <label class="view-source-button" for="RandomGoalSampling-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#RandomGoalSampling"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="RandomGoalSampling-11"><a href="#RandomGoalSampling-11"><span class="linenos"> 11</span></a><span class="k">class</span> <span class="nc">RandomGoalSampling</span><span class="p">(</span><span class="n">VanillaSampling</span><span class="p">):</span>
</span><span id="RandomGoalSampling-12"><a href="#RandomGoalSampling-12"><span class="linenos"> 12</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Random Goal State Trace Sampler - inherits the VanillaSampling class and its attributes.</span>
</span><span id="RandomGoalSampling-13"><a href="#RandomGoalSampling-13"><span class="linenos"> 13</span></a>
</span><span id="RandomGoalSampling-14"><a href="#RandomGoalSampling-14"><span class="linenos"> 14</span></a><span class="sd">    A state trace generator that generates traces by randomly generating some candidate states/goals k steps deep,</span>
</span><span id="RandomGoalSampling-15"><a href="#RandomGoalSampling-15"><span class="linenos"> 15</span></a><span class="sd">    then running a planner on a random subset of the fluents to get plans. The longest plans (those closest to k, thus representing</span>
</span><span id="RandomGoalSampling-16"><a href="#RandomGoalSampling-16"><span class="linenos"> 16</span></a><span class="sd">    goal states that are somewhat complex and take longer to reach) are taken and used to generate traces.</span>
</span><span id="RandomGoalSampling-17"><a href="#RandomGoalSampling-17"><span class="linenos"> 17</span></a>
</span><span id="RandomGoalSampling-18"><a href="#RandomGoalSampling-18"><span class="linenos"> 18</span></a><span class="sd">    Attributes:</span>
</span><span id="RandomGoalSampling-19"><a href="#RandomGoalSampling-19"><span class="linenos"> 19</span></a><span class="sd">        steps_deep (int):</span>
</span><span id="RandomGoalSampling-20"><a href="#RandomGoalSampling-20"><span class="linenos"> 20</span></a><span class="sd">            The number of steps deep to extract goal states from.</span>
</span><span id="RandomGoalSampling-21"><a href="#RandomGoalSampling-21"><span class="linenos"> 21</span></a><span class="sd">        enforced_hill_climbing_sampling (bool):</span>
</span><span id="RandomGoalSampling-22"><a href="#RandomGoalSampling-22"><span class="linenos"> 22</span></a><span class="sd">            Optional method of goal sampling where once a goal is found, that (full) goal state is set as the initial state for the next</span>
</span><span id="RandomGoalSampling-23"><a href="#RandomGoalSampling-23"><span class="linenos"> 23</span></a><span class="sd">            iteration. This results in more unique goals as the goal state sampling starts in different areas of the state space each time.</span>
</span><span id="RandomGoalSampling-24"><a href="#RandomGoalSampling-24"><span class="linenos"> 24</span></a><span class="sd">            Note that the goals will come from different initial states.</span>
</span><span id="RandomGoalSampling-25"><a href="#RandomGoalSampling-25"><span class="linenos"> 25</span></a><span class="sd">        subset_size_perc (float):</span>
</span><span id="RandomGoalSampling-26"><a href="#RandomGoalSampling-26"><span class="linenos"> 26</span></a><span class="sd">            The percentage of fluents to extract to use as a goal state from the generated states.</span>
</span><span id="RandomGoalSampling-27"><a href="#RandomGoalSampling-27"><span class="linenos"> 27</span></a><span class="sd">        goals_inits_plans (List[Dict]):</span>
</span><span id="RandomGoalSampling-28"><a href="#RandomGoalSampling-28"><span class="linenos"> 28</span></a><span class="sd">            A list of dictionaries, where each dictionary stores the generated goal state as the key and the initial state and plan used to</span>
</span><span id="RandomGoalSampling-29"><a href="#RandomGoalSampling-29"><span class="linenos"> 29</span></a><span class="sd">            reach the goal as values.</span>
</span><span id="RandomGoalSampling-30"><a href="#RandomGoalSampling-30"><span class="linenos"> 30</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="RandomGoalSampling-31"><a href="#RandomGoalSampling-31"><span class="linenos"> 31</span></a>
</span><span id="RandomGoalSampling-32"><a href="#RandomGoalSampling-32"><span class="linenos"> 32</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="RandomGoalSampling-33"><a href="#RandomGoalSampling-33"><span class="linenos"> 33</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="RandomGoalSampling-34"><a href="#RandomGoalSampling-34"><span class="linenos"> 34</span></a>        <span class="n">steps_deep</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="RandomGoalSampling-35"><a href="#RandomGoalSampling-35"><span class="linenos"> 35</span></a>        <span class="n">enforced_hill_climbing_sampling</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="RandomGoalSampling-36"><a href="#RandomGoalSampling-36"><span class="linenos"> 36</span></a>        <span class="n">subset_size_perc</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="RandomGoalSampling-37"><a href="#RandomGoalSampling-37"><span class="linenos"> 37</span></a>        <span class="n">num_traces</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="RandomGoalSampling-38"><a href="#RandomGoalSampling-38"><span class="linenos"> 38</span></a>        <span class="n">dom</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="RandomGoalSampling-39"><a href="#RandomGoalSampling-39"><span class="linenos"> 39</span></a>        <span class="n">prob</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="RandomGoalSampling-40"><a href="#RandomGoalSampling-40"><span class="linenos"> 40</span></a>        <span class="n">problem_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="RandomGoalSampling-41"><a href="#RandomGoalSampling-41"><span class="linenos"> 41</span></a>        <span class="n">max_time</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span>
</span><span id="RandomGoalSampling-42"><a href="#RandomGoalSampling-42"><span class="linenos"> 42</span></a>        <span class="n">observe_pres_effs</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="RandomGoalSampling-43"><a href="#RandomGoalSampling-43"><span class="linenos"> 43</span></a>    <span class="p">):</span>
</span><span id="RandomGoalSampling-44"><a href="#RandomGoalSampling-44"><span class="linenos"> 44</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="RandomGoalSampling-45"><a href="#RandomGoalSampling-45"><span class="linenos"> 45</span></a><span class="sd">        Initializes a random goal state trace sampler using the plan length, number of traces,</span>
</span><span id="RandomGoalSampling-46"><a href="#RandomGoalSampling-46"><span class="linenos"> 46</span></a><span class="sd">        and the domain and problem.</span>
</span><span id="RandomGoalSampling-47"><a href="#RandomGoalSampling-47"><span class="linenos"> 47</span></a>
</span><span id="RandomGoalSampling-48"><a href="#RandomGoalSampling-48"><span class="linenos"> 48</span></a><span class="sd">        Args:</span>
</span><span id="RandomGoalSampling-49"><a href="#RandomGoalSampling-49"><span class="linenos"> 49</span></a><span class="sd">            steps_deep (int):</span>
</span><span id="RandomGoalSampling-50"><a href="#RandomGoalSampling-50"><span class="linenos"> 50</span></a><span class="sd">                The number of steps deep to extract goal states from.</span>
</span><span id="RandomGoalSampling-51"><a href="#RandomGoalSampling-51"><span class="linenos"> 51</span></a><span class="sd">            enforced_hill_climbing_sampling (bool):</span>
</span><span id="RandomGoalSampling-52"><a href="#RandomGoalSampling-52"><span class="linenos"> 52</span></a><span class="sd">                Optional method of goal sampling where once a goal is found, that (full) goal state is set as the initial state for the next</span>
</span><span id="RandomGoalSampling-53"><a href="#RandomGoalSampling-53"><span class="linenos"> 53</span></a><span class="sd">                iteration. This results in more unique goals as the goal state sampling starts in different areas of the state space each time.</span>
</span><span id="RandomGoalSampling-54"><a href="#RandomGoalSampling-54"><span class="linenos"> 54</span></a><span class="sd">                Note that the goals will come from different initial states.</span>
</span><span id="RandomGoalSampling-55"><a href="#RandomGoalSampling-55"><span class="linenos"> 55</span></a><span class="sd">            subset_size_perc (float):</span>
</span><span id="RandomGoalSampling-56"><a href="#RandomGoalSampling-56"><span class="linenos"> 56</span></a><span class="sd">                The percentage of fluents to extract to use as a goal state from the generated states.</span>
</span><span id="RandomGoalSampling-57"><a href="#RandomGoalSampling-57"><span class="linenos"> 57</span></a><span class="sd">            num_traces (int):</span>
</span><span id="RandomGoalSampling-58"><a href="#RandomGoalSampling-58"><span class="linenos"> 58</span></a><span class="sd">                The number of traces to generate. Defaults to 1.</span>
</span><span id="RandomGoalSampling-59"><a href="#RandomGoalSampling-59"><span class="linenos"> 59</span></a><span class="sd">            dom (str):</span>
</span><span id="RandomGoalSampling-60"><a href="#RandomGoalSampling-60"><span class="linenos"> 60</span></a><span class="sd">                The domain filename.</span>
</span><span id="RandomGoalSampling-61"><a href="#RandomGoalSampling-61"><span class="linenos"> 61</span></a><span class="sd">            prob (str):</span>
</span><span id="RandomGoalSampling-62"><a href="#RandomGoalSampling-62"><span class="linenos"> 62</span></a><span class="sd">                The problem filename.</span>
</span><span id="RandomGoalSampling-63"><a href="#RandomGoalSampling-63"><span class="linenos"> 63</span></a><span class="sd">            problem_id (int):</span>
</span><span id="RandomGoalSampling-64"><a href="#RandomGoalSampling-64"><span class="linenos"> 64</span></a><span class="sd">                The ID of the problem to access.</span>
</span><span id="RandomGoalSampling-65"><a href="#RandomGoalSampling-65"><span class="linenos"> 65</span></a><span class="sd">            max_time (float):</span>
</span><span id="RandomGoalSampling-66"><a href="#RandomGoalSampling-66"><span class="linenos"> 66</span></a><span class="sd">                The maximum time allowed for a trace to be generated.</span>
</span><span id="RandomGoalSampling-67"><a href="#RandomGoalSampling-67"><span class="linenos"> 67</span></a><span class="sd">            observe_pres_effs (bool):</span>
</span><span id="RandomGoalSampling-68"><a href="#RandomGoalSampling-68"><span class="linenos"> 68</span></a><span class="sd">                Option to observe action preconditions and effects upon generation.</span>
</span><span id="RandomGoalSampling-69"><a href="#RandomGoalSampling-69"><span class="linenos"> 69</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="RandomGoalSampling-70"><a href="#RandomGoalSampling-70"><span class="linenos"> 70</span></a>        <span class="k">if</span> <span class="n">subset_size_perc</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">subset_size_perc</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="RandomGoalSampling-71"><a href="#RandomGoalSampling-71"><span class="linenos"> 71</span></a>            <span class="k">raise</span> <span class="n">PercentError</span><span class="p">()</span>
</span><span id="RandomGoalSampling-72"><a href="#RandomGoalSampling-72"><span class="linenos"> 72</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">steps_deep</span> <span class="o">=</span> <span class="n">steps_deep</span>
</span><span id="RandomGoalSampling-73"><a href="#RandomGoalSampling-73"><span class="linenos"> 73</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">enforced_hill_climbing_sampling</span> <span class="o">=</span> <span class="n">enforced_hill_climbing_sampling</span>
</span><span id="RandomGoalSampling-74"><a href="#RandomGoalSampling-74"><span class="linenos"> 74</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">subset_size_perc</span> <span class="o">=</span> <span class="n">subset_size_perc</span>
</span><span id="RandomGoalSampling-75"><a href="#RandomGoalSampling-75"><span class="linenos"> 75</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">goals_inits_plans</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="RandomGoalSampling-76"><a href="#RandomGoalSampling-76"><span class="linenos"> 76</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="RandomGoalSampling-77"><a href="#RandomGoalSampling-77"><span class="linenos"> 77</span></a>            <span class="n">dom</span><span class="o">=</span><span class="n">dom</span><span class="p">,</span>
</span><span id="RandomGoalSampling-78"><a href="#RandomGoalSampling-78"><span class="linenos"> 78</span></a>            <span class="n">prob</span><span class="o">=</span><span class="n">prob</span><span class="p">,</span>
</span><span id="RandomGoalSampling-79"><a href="#RandomGoalSampling-79"><span class="linenos"> 79</span></a>            <span class="n">problem_id</span><span class="o">=</span><span class="n">problem_id</span><span class="p">,</span>
</span><span id="RandomGoalSampling-80"><a href="#RandomGoalSampling-80"><span class="linenos"> 80</span></a>            <span class="n">num_traces</span><span class="o">=</span><span class="n">num_traces</span><span class="p">,</span>
</span><span id="RandomGoalSampling-81"><a href="#RandomGoalSampling-81"><span class="linenos"> 81</span></a>            <span class="n">observe_pres_effs</span><span class="o">=</span><span class="n">observe_pres_effs</span><span class="p">,</span>
</span><span id="RandomGoalSampling-82"><a href="#RandomGoalSampling-82"><span class="linenos"> 82</span></a>            <span class="n">max_time</span><span class="o">=</span><span class="n">max_time</span><span class="p">,</span>
</span><span id="RandomGoalSampling-83"><a href="#RandomGoalSampling-83"><span class="linenos"> 83</span></a>        <span class="p">)</span>
</span><span id="RandomGoalSampling-84"><a href="#RandomGoalSampling-84"><span class="linenos"> 84</span></a>
</span><span id="RandomGoalSampling-85"><a href="#RandomGoalSampling-85"><span class="linenos"> 85</span></a>    <span class="k">def</span> <span class="nf">goal_sampling</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="RandomGoalSampling-86"><a href="#RandomGoalSampling-86"><span class="linenos"> 86</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Samples goals by randomly generating candidate goal states k (`steps_deep`) steps deep, then running planners on those</span>
</span><span id="RandomGoalSampling-87"><a href="#RandomGoalSampling-87"><span class="linenos"> 87</span></a><span class="sd">        goal states to ensure the goals are complex enough (i.e. cannot be reached in too few steps). Candidate</span>
</span><span id="RandomGoalSampling-88"><a href="#RandomGoalSampling-88"><span class="linenos"> 88</span></a><span class="sd">        goal states are generated for a set amount of time indicated by MAX_GOAL_SEARCH_TIME, and the goals with the</span>
</span><span id="RandomGoalSampling-89"><a href="#RandomGoalSampling-89"><span class="linenos"> 89</span></a><span class="sd">        longest plans (the most complex goals) are selected.</span>
</span><span id="RandomGoalSampling-90"><a href="#RandomGoalSampling-90"><span class="linenos"> 90</span></a>
</span><span id="RandomGoalSampling-91"><a href="#RandomGoalSampling-91"><span class="linenos"> 91</span></a><span class="sd">        Returns: An OrderedDict holding the longest goal states along with the initial state and plans used to reach them.</span>
</span><span id="RandomGoalSampling-92"><a href="#RandomGoalSampling-92"><span class="linenos"> 92</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="RandomGoalSampling-93"><a href="#RandomGoalSampling-93"><span class="linenos"> 93</span></a>        <span class="n">goal_states</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="RandomGoalSampling-94"><a href="#RandomGoalSampling-94"><span class="linenos"> 94</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">generate_goals_setup</span><span class="p">(</span><span class="n">num_seconds</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">max_time</span><span class="p">,</span> <span class="n">goal_states</span><span class="o">=</span><span class="n">goal_states</span><span class="p">)()</span>
</span><span id="RandomGoalSampling-95"><a href="#RandomGoalSampling-95"><span class="linenos"> 95</span></a>        <span class="c1"># sort the results by plan length and get the k largest ones</span>
</span><span id="RandomGoalSampling-96"><a href="#RandomGoalSampling-96"><span class="linenos"> 96</span></a>        <span class="n">filtered_goals</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span>
</span><span id="RandomGoalSampling-97"><a href="#RandomGoalSampling-97"><span class="linenos"> 97</span></a>            <span class="nb">sorted</span><span class="p">(</span><span class="n">goal_states</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;plan&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">actions</span><span class="p">))</span>
</span><span id="RandomGoalSampling-98"><a href="#RandomGoalSampling-98"><span class="linenos"> 98</span></a>        <span class="p">)</span>
</span><span id="RandomGoalSampling-99"><a href="#RandomGoalSampling-99"><span class="linenos"> 99</span></a>        <span class="n">to_del</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">filtered_goals</span><span class="o">.</span><span class="n">keys</span><span class="p">())[:</span> <span class="nb">len</span><span class="p">(</span><span class="n">filtered_goals</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_traces</span><span class="p">]</span>
</span><span id="RandomGoalSampling-100"><a href="#RandomGoalSampling-100"><span class="linenos">100</span></a>        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">to_del</span><span class="p">:</span>
</span><span id="RandomGoalSampling-101"><a href="#RandomGoalSampling-101"><span class="linenos">101</span></a>            <span class="k">del</span> <span class="n">filtered_goals</span><span class="p">[</span><span class="n">d</span><span class="p">]</span>
</span><span id="RandomGoalSampling-102"><a href="#RandomGoalSampling-102"><span class="linenos">102</span></a>        <span class="k">return</span> <span class="n">filtered_goals</span>
</span><span id="RandomGoalSampling-103"><a href="#RandomGoalSampling-103"><span class="linenos">103</span></a>
</span><span id="RandomGoalSampling-104"><a href="#RandomGoalSampling-104"><span class="linenos">104</span></a>    <span class="k">def</span> <span class="nf">generate_goals_setup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_seconds</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">goal_states</span><span class="p">:</span> <span class="n">Dict</span><span class="p">):</span>
</span><span id="RandomGoalSampling-105"><a href="#RandomGoalSampling-105"><span class="linenos">105</span></a>        <span class="nd">@basic_timer</span><span class="p">(</span><span class="n">num_seconds</span><span class="o">=</span><span class="n">num_seconds</span><span class="p">)</span>
</span><span id="RandomGoalSampling-106"><a href="#RandomGoalSampling-106"><span class="linenos">106</span></a>        <span class="k">def</span> <span class="nf">generate_goals</span><span class="p">(</span><span class="bp">self</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">goal_states</span><span class="o">=</span><span class="n">goal_states</span><span class="p">):</span>
</span><span id="RandomGoalSampling-107"><a href="#RandomGoalSampling-107"><span class="linenos">107</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;Helper function for `goal_sampling`. Generates as many goals as possible within the specified max_time seconds (timing is</span>
</span><span id="RandomGoalSampling-108"><a href="#RandomGoalSampling-108"><span class="linenos">108</span></a><span class="sd">            enforced by the basic_timer wrapper).</span>
</span><span id="RandomGoalSampling-109"><a href="#RandomGoalSampling-109"><span class="linenos">109</span></a>
</span><span id="RandomGoalSampling-110"><a href="#RandomGoalSampling-110"><span class="linenos">110</span></a><span class="sd">            The outside function is a wrapper that provides parameters for both the timer</span>
</span><span id="RandomGoalSampling-111"><a href="#RandomGoalSampling-111"><span class="linenos">111</span></a><span class="sd">            wrapper and the function.</span>
</span><span id="RandomGoalSampling-112"><a href="#RandomGoalSampling-112"><span class="linenos">112</span></a>
</span><span id="RandomGoalSampling-113"><a href="#RandomGoalSampling-113"><span class="linenos">113</span></a><span class="sd">            Given the specified number of traces `num_traces`, if `num_traces` plans of length k (`steps_deep`) are found before</span>
</span><span id="RandomGoalSampling-114"><a href="#RandomGoalSampling-114"><span class="linenos">114</span></a><span class="sd">            the time is up, exit early.</span>
</span><span id="RandomGoalSampling-115"><a href="#RandomGoalSampling-115"><span class="linenos">115</span></a>
</span><span id="RandomGoalSampling-116"><a href="#RandomGoalSampling-116"><span class="linenos">116</span></a><span class="sd">            Args:</span>
</span><span id="RandomGoalSampling-117"><a href="#RandomGoalSampling-117"><span class="linenos">117</span></a><span class="sd">                goal_states (Dict):</span>
</span><span id="RandomGoalSampling-118"><a href="#RandomGoalSampling-118"><span class="linenos">118</span></a><span class="sd">                    The dictionary to fill with the values of each goal state, initial state, and plan.</span>
</span><span id="RandomGoalSampling-119"><a href="#RandomGoalSampling-119"><span class="linenos">119</span></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="RandomGoalSampling-120"><a href="#RandomGoalSampling-120"><span class="linenos">120</span></a>            <span class="c1"># create a sampler to test the complexity of the new goal by running a planner on it</span>
</span><span id="RandomGoalSampling-121"><a href="#RandomGoalSampling-121"><span class="linenos">121</span></a>            <span class="n">k_length_plans</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="RandomGoalSampling-122"><a href="#RandomGoalSampling-122"><span class="linenos">122</span></a>            <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="RandomGoalSampling-123"><a href="#RandomGoalSampling-123"><span class="linenos">123</span></a>                <span class="c1"># generate a trace of the specified length and retrieve the state of the last step</span>
</span><span id="RandomGoalSampling-124"><a href="#RandomGoalSampling-124"><span class="linenos">124</span></a>                <span class="n">state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_single_trace_setup</span><span class="p">(</span>
</span><span id="RandomGoalSampling-125"><a href="#RandomGoalSampling-125"><span class="linenos">125</span></a>                    <span class="n">num_seconds</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps_deep</span>
</span><span id="RandomGoalSampling-126"><a href="#RandomGoalSampling-126"><span class="linenos">126</span></a>                <span class="p">)()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">state</span>
</span><span id="RandomGoalSampling-127"><a href="#RandomGoalSampling-127"><span class="linenos">127</span></a>
</span><span id="RandomGoalSampling-128"><a href="#RandomGoalSampling-128"><span class="linenos">128</span></a>                <span class="c1"># get all positive fluents (only positive fluents can be used for a goal)</span>
</span><span id="RandomGoalSampling-129"><a href="#RandomGoalSampling-129"><span class="linenos">129</span></a>                <span class="n">goal_f</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">state</span> <span class="k">if</span> <span class="n">state</span><span class="p">[</span><span class="n">f</span><span class="p">]]</span>
</span><span id="RandomGoalSampling-130"><a href="#RandomGoalSampling-130"><span class="linenos">130</span></a>                <span class="c1"># get next initial state (only used for enforced hill climbing sampling)</span>
</span><span id="RandomGoalSampling-131"><a href="#RandomGoalSampling-131"><span class="linenos">131</span></a>                <span class="n">next_init_f</span> <span class="o">=</span> <span class="n">goal_f</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="RandomGoalSampling-132"><a href="#RandomGoalSampling-132"><span class="linenos">132</span></a>                <span class="c1"># get the subset size</span>
</span><span id="RandomGoalSampling-133"><a href="#RandomGoalSampling-133"><span class="linenos">133</span></a>                <span class="n">subset_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">fluents</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">subset_size_perc</span><span class="p">)</span>
</span><span id="RandomGoalSampling-134"><a href="#RandomGoalSampling-134"><span class="linenos">134</span></a>                <span class="c1"># if necessary, take a subset of the fluents</span>
</span><span id="RandomGoalSampling-135"><a href="#RandomGoalSampling-135"><span class="linenos">135</span></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">goal_f</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">subset_size</span><span class="p">:</span>
</span><span id="RandomGoalSampling-136"><a href="#RandomGoalSampling-136"><span class="linenos">136</span></a>                    <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">goal_f</span><span class="p">)</span>
</span><span id="RandomGoalSampling-137"><a href="#RandomGoalSampling-137"><span class="linenos">137</span></a>                    <span class="n">goal_f</span> <span class="o">=</span> <span class="n">goal_f</span><span class="p">[:</span><span class="n">subset_size</span><span class="p">]</span>
</span><span id="RandomGoalSampling-138"><a href="#RandomGoalSampling-138"><span class="linenos">138</span></a>
</span><span id="RandomGoalSampling-139"><a href="#RandomGoalSampling-139"><span class="linenos">139</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">change_goal</span><span class="p">(</span><span class="n">goal_fluents</span><span class="o">=</span><span class="n">goal_f</span><span class="p">)</span>
</span><span id="RandomGoalSampling-140"><a href="#RandomGoalSampling-140"><span class="linenos">140</span></a>
</span><span id="RandomGoalSampling-141"><a href="#RandomGoalSampling-141"><span class="linenos">141</span></a>                <span class="c1"># ensure that the goal doesn&#39;t hold in the initial state; restart if it does</span>
</span><span id="RandomGoalSampling-142"><a href="#RandomGoalSampling-142"><span class="linenos">142</span></a>                <span class="n">init_state</span> <span class="o">=</span> <span class="p">{</span><span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">as_atoms</span><span class="p">()}</span>
</span><span id="RandomGoalSampling-143"><a href="#RandomGoalSampling-143"><span class="linenos">143</span></a>                <span class="n">goal</span> <span class="o">=</span> <span class="p">{</span><span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="o">.</span><span class="n">goal</span><span class="o">.</span><span class="n">subformulas</span><span class="p">}</span>
</span><span id="RandomGoalSampling-144"><a href="#RandomGoalSampling-144"><span class="linenos">144</span></a>
</span><span id="RandomGoalSampling-145"><a href="#RandomGoalSampling-145"><span class="linenos">145</span></a>                <span class="k">if</span> <span class="n">goal</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="n">init_state</span><span class="p">):</span>
</span><span id="RandomGoalSampling-146"><a href="#RandomGoalSampling-146"><span class="linenos">146</span></a>                    <span class="k">continue</span>
</span><span id="RandomGoalSampling-147"><a href="#RandomGoalSampling-147"><span class="linenos">147</span></a>
</span><span id="RandomGoalSampling-148"><a href="#RandomGoalSampling-148"><span class="linenos">148</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="RandomGoalSampling-149"><a href="#RandomGoalSampling-149"><span class="linenos">149</span></a>                    <span class="c1"># attempt to generate a plan, and find a new goal if a plan can&#39;t be found</span>
</span><span id="RandomGoalSampling-150"><a href="#RandomGoalSampling-150"><span class="linenos">150</span></a>                    <span class="c1"># should only crash if there are server issues</span>
</span><span id="RandomGoalSampling-151"><a href="#RandomGoalSampling-151"><span class="linenos">151</span></a>                    <span class="n">test_plan</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_plan</span><span class="p">()</span>
</span><span id="RandomGoalSampling-152"><a href="#RandomGoalSampling-152"><span class="linenos">152</span></a>                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
</span><span id="RandomGoalSampling-153"><a href="#RandomGoalSampling-153"><span class="linenos">153</span></a>                    <span class="k">continue</span>
</span><span id="RandomGoalSampling-154"><a href="#RandomGoalSampling-154"><span class="linenos">154</span></a>
</span><span id="RandomGoalSampling-155"><a href="#RandomGoalSampling-155"><span class="linenos">155</span></a>                <span class="c1"># create a State and add it to the dictionary</span>
</span><span id="RandomGoalSampling-156"><a href="#RandomGoalSampling-156"><span class="linenos">156</span></a>                <span class="n">state_dict</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="RandomGoalSampling-157"><a href="#RandomGoalSampling-157"><span class="linenos">157</span></a>                <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">goal_f</span><span class="p">:</span>
</span><span id="RandomGoalSampling-158"><a href="#RandomGoalSampling-158"><span class="linenos">158</span></a>                    <span class="n">state_dict</span><span class="p">[</span><span class="n">f</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="RandomGoalSampling-159"><a href="#RandomGoalSampling-159"><span class="linenos">159</span></a>                <span class="c1"># map each goal to the initial state and plan used to achieve it</span>
</span><span id="RandomGoalSampling-160"><a href="#RandomGoalSampling-160"><span class="linenos">160</span></a>                <span class="n">goal_states</span><span class="p">[</span><span class="n">State</span><span class="p">(</span><span class="n">state_dict</span><span class="p">)]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="RandomGoalSampling-161"><a href="#RandomGoalSampling-161"><span class="linenos">161</span></a>                    <span class="s2">&quot;plan&quot;</span><span class="p">:</span> <span class="n">test_plan</span><span class="p">,</span>
</span><span id="RandomGoalSampling-162"><a href="#RandomGoalSampling-162"><span class="linenos">162</span></a>                    <span class="s2">&quot;initial state&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="o">.</span><span class="n">init</span><span class="p">,</span>
</span><span id="RandomGoalSampling-163"><a href="#RandomGoalSampling-163"><span class="linenos">163</span></a>                <span class="p">}</span>
</span><span id="RandomGoalSampling-164"><a href="#RandomGoalSampling-164"><span class="linenos">164</span></a>
</span><span id="RandomGoalSampling-165"><a href="#RandomGoalSampling-165"><span class="linenos">165</span></a>                <span class="c1"># optionally change the initial state of the sampler for the next iteration to the goal state just generated (ensures more diversity in goals/plans)</span>
</span><span id="RandomGoalSampling-166"><a href="#RandomGoalSampling-166"><span class="linenos">166</span></a>                <span class="c1"># use the full state the goal was extracted from as the initial state to prevent planning errors from incomplete initial states</span>
</span><span id="RandomGoalSampling-167"><a href="#RandomGoalSampling-167"><span class="linenos">167</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">enforced_hill_climbing_sampling</span><span class="p">:</span>
</span><span id="RandomGoalSampling-168"><a href="#RandomGoalSampling-168"><span class="linenos">168</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">change_init</span><span class="p">(</span><span class="n">next_init_f</span><span class="p">)</span>
</span><span id="RandomGoalSampling-169"><a href="#RandomGoalSampling-169"><span class="linenos">169</span></a>
</span><span id="RandomGoalSampling-170"><a href="#RandomGoalSampling-170"><span class="linenos">170</span></a>                <span class="c1"># keep track of the number of plans of length k; if we get enough of them, exit early</span>
</span><span id="RandomGoalSampling-171"><a href="#RandomGoalSampling-171"><span class="linenos">171</span></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_plan</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps_deep</span><span class="p">:</span>
</span><span id="RandomGoalSampling-172"><a href="#RandomGoalSampling-172"><span class="linenos">172</span></a>                    <span class="n">k_length_plans</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="RandomGoalSampling-173"><a href="#RandomGoalSampling-173"><span class="linenos">173</span></a>                <span class="k">if</span> <span class="n">k_length_plans</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_traces</span><span class="p">:</span>
</span><span id="RandomGoalSampling-174"><a href="#RandomGoalSampling-174"><span class="linenos">174</span></a>                    <span class="k">break</span>
</span><span id="RandomGoalSampling-175"><a href="#RandomGoalSampling-175"><span class="linenos">175</span></a>
</span><span id="RandomGoalSampling-176"><a href="#RandomGoalSampling-176"><span class="linenos">176</span></a>        <span class="k">return</span> <span class="n">generate_goals</span>
</span><span id="RandomGoalSampling-177"><a href="#RandomGoalSampling-177"><span class="linenos">177</span></a>
</span><span id="RandomGoalSampling-178"><a href="#RandomGoalSampling-178"><span class="linenos">178</span></a>    <span class="k">def</span> <span class="nf">generate_traces</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="RandomGoalSampling-179"><a href="#RandomGoalSampling-179"><span class="linenos">179</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Generates traces based on the sampled goals. Traces are generated using the initial state and plan used to achieve the goal.</span>
</span><span id="RandomGoalSampling-180"><a href="#RandomGoalSampling-180"><span class="linenos">180</span></a>
</span><span id="RandomGoalSampling-181"><a href="#RandomGoalSampling-181"><span class="linenos">181</span></a><span class="sd">        Returns:</span>
</span><span id="RandomGoalSampling-182"><a href="#RandomGoalSampling-182"><span class="linenos">182</span></a><span class="sd">            A TraceList with the generated traces.</span>
</span><span id="RandomGoalSampling-183"><a href="#RandomGoalSampling-183"><span class="linenos">183</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="RandomGoalSampling-184"><a href="#RandomGoalSampling-184"><span class="linenos">184</span></a>        <span class="n">traces</span> <span class="o">=</span> <span class="n">TraceList</span><span class="p">()</span>
</span><span id="RandomGoalSampling-185"><a href="#RandomGoalSampling-185"><span class="linenos">185</span></a>        <span class="c1"># retrieve goals and their respective plans</span>
</span><span id="RandomGoalSampling-186"><a href="#RandomGoalSampling-186"><span class="linenos">186</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">goals_inits_plans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">goal_sampling</span><span class="p">()</span>
</span><span id="RandomGoalSampling-187"><a href="#RandomGoalSampling-187"><span class="linenos">187</span></a>        <span class="c1"># iterate through all plans corresponding to the goals, generating traces</span>
</span><span id="RandomGoalSampling-188"><a href="#RandomGoalSampling-188"><span class="linenos">188</span></a>        <span class="k">for</span> <span class="n">goal</span> <span class="ow">in</span> <span class="n">progress</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">goals_inits_plans</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
</span><span id="RandomGoalSampling-189"><a href="#RandomGoalSampling-189"><span class="linenos">189</span></a>            <span class="c1"># update the initial state if necessary</span>
</span><span id="RandomGoalSampling-190"><a href="#RandomGoalSampling-190"><span class="linenos">190</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">enforced_hill_climbing_sampling</span><span class="p">:</span>
</span><span id="RandomGoalSampling-191"><a href="#RandomGoalSampling-191"><span class="linenos">191</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="o">.</span><span class="n">init</span> <span class="o">=</span> <span class="n">goal</span><span class="p">[</span><span class="s2">&quot;initial state&quot;</span><span class="p">]</span>
</span><span id="RandomGoalSampling-192"><a href="#RandomGoalSampling-192"><span class="linenos">192</span></a>            <span class="c1"># generate a plan based on the new goal/initial state, then generate a trace based on that plan</span>
</span><span id="RandomGoalSampling-193"><a href="#RandomGoalSampling-193"><span class="linenos">193</span></a>            <span class="n">traces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">generate_single_trace_from_plan</span><span class="p">(</span><span class="n">goal</span><span class="p">[</span><span class="s2">&quot;plan&quot;</span><span class="p">]))</span>
</span><span id="RandomGoalSampling-194"><a href="#RandomGoalSampling-194"><span class="linenos">194</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">traces</span> <span class="o">=</span> <span class="n">traces</span>
</span><span id="RandomGoalSampling-195"><a href="#RandomGoalSampling-195"><span class="linenos">195</span></a>        <span class="k">return</span> <span class="n">traces</span>
</span></pre></div>


            <div class="docstring"><p>Random Goal State Trace Sampler - inherits the VanillaSampling class and its attributes.</p>

<p>A state trace generator that generates traces by randomly generating some candidate states/goals k steps deep,
then running a planner on a random subset of the fluents to get plans. The longest plans (those closest to k, thus representing
goal states that are somewhat complex and take longer to reach) are taken and used to generate traces.</p>

<p>Attributes:
    steps_deep (int):
        The number of steps deep to extract goal states from.
    enforced_hill_climbing_sampling (bool):
        Optional method of goal sampling where once a goal is found, that (full) goal state is set as the initial state for the next
        iteration. This results in more unique goals as the goal state sampling starts in different areas of the state space each time.
        Note that the goals will come from different initial states.
    subset_size_perc (float):
        The percentage of fluents to extract to use as a goal state from the generated states.
    goals_inits_plans (List[Dict]):
        A list of dictionaries, where each dictionary stores the generated goal state as the key and the initial state and plan used to
        reach the goal as values.</p>
</div>


                            <div id="RandomGoalSampling.__init__" class="classattr">
                                        <input id="RandomGoalSampling.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">RandomGoalSampling</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">steps_deep</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">enforced_hill_climbing_sampling</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">subset_size_perc</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span>,</span><span class="param">	<span class="n">num_traces</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>,</span><span class="param">	<span class="n">dom</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">prob</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">problem_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">max_time</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">30</span>,</span><span class="param">	<span class="n">observe_pres_effs</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span>)</span>

                <label class="view-source-button" for="RandomGoalSampling.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#RandomGoalSampling.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="RandomGoalSampling.__init__-32"><a href="#RandomGoalSampling.__init__-32"><span class="linenos">32</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="RandomGoalSampling.__init__-33"><a href="#RandomGoalSampling.__init__-33"><span class="linenos">33</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="RandomGoalSampling.__init__-34"><a href="#RandomGoalSampling.__init__-34"><span class="linenos">34</span></a>        <span class="n">steps_deep</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="RandomGoalSampling.__init__-35"><a href="#RandomGoalSampling.__init__-35"><span class="linenos">35</span></a>        <span class="n">enforced_hill_climbing_sampling</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="RandomGoalSampling.__init__-36"><a href="#RandomGoalSampling.__init__-36"><span class="linenos">36</span></a>        <span class="n">subset_size_perc</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="RandomGoalSampling.__init__-37"><a href="#RandomGoalSampling.__init__-37"><span class="linenos">37</span></a>        <span class="n">num_traces</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="RandomGoalSampling.__init__-38"><a href="#RandomGoalSampling.__init__-38"><span class="linenos">38</span></a>        <span class="n">dom</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="RandomGoalSampling.__init__-39"><a href="#RandomGoalSampling.__init__-39"><span class="linenos">39</span></a>        <span class="n">prob</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="RandomGoalSampling.__init__-40"><a href="#RandomGoalSampling.__init__-40"><span class="linenos">40</span></a>        <span class="n">problem_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="RandomGoalSampling.__init__-41"><a href="#RandomGoalSampling.__init__-41"><span class="linenos">41</span></a>        <span class="n">max_time</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span>
</span><span id="RandomGoalSampling.__init__-42"><a href="#RandomGoalSampling.__init__-42"><span class="linenos">42</span></a>        <span class="n">observe_pres_effs</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="RandomGoalSampling.__init__-43"><a href="#RandomGoalSampling.__init__-43"><span class="linenos">43</span></a>    <span class="p">):</span>
</span><span id="RandomGoalSampling.__init__-44"><a href="#RandomGoalSampling.__init__-44"><span class="linenos">44</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="RandomGoalSampling.__init__-45"><a href="#RandomGoalSampling.__init__-45"><span class="linenos">45</span></a><span class="sd">        Initializes a random goal state trace sampler using the plan length, number of traces,</span>
</span><span id="RandomGoalSampling.__init__-46"><a href="#RandomGoalSampling.__init__-46"><span class="linenos">46</span></a><span class="sd">        and the domain and problem.</span>
</span><span id="RandomGoalSampling.__init__-47"><a href="#RandomGoalSampling.__init__-47"><span class="linenos">47</span></a>
</span><span id="RandomGoalSampling.__init__-48"><a href="#RandomGoalSampling.__init__-48"><span class="linenos">48</span></a><span class="sd">        Args:</span>
</span><span id="RandomGoalSampling.__init__-49"><a href="#RandomGoalSampling.__init__-49"><span class="linenos">49</span></a><span class="sd">            steps_deep (int):</span>
</span><span id="RandomGoalSampling.__init__-50"><a href="#RandomGoalSampling.__init__-50"><span class="linenos">50</span></a><span class="sd">                The number of steps deep to extract goal states from.</span>
</span><span id="RandomGoalSampling.__init__-51"><a href="#RandomGoalSampling.__init__-51"><span class="linenos">51</span></a><span class="sd">            enforced_hill_climbing_sampling (bool):</span>
</span><span id="RandomGoalSampling.__init__-52"><a href="#RandomGoalSampling.__init__-52"><span class="linenos">52</span></a><span class="sd">                Optional method of goal sampling where once a goal is found, that (full) goal state is set as the initial state for the next</span>
</span><span id="RandomGoalSampling.__init__-53"><a href="#RandomGoalSampling.__init__-53"><span class="linenos">53</span></a><span class="sd">                iteration. This results in more unique goals as the goal state sampling starts in different areas of the state space each time.</span>
</span><span id="RandomGoalSampling.__init__-54"><a href="#RandomGoalSampling.__init__-54"><span class="linenos">54</span></a><span class="sd">                Note that the goals will come from different initial states.</span>
</span><span id="RandomGoalSampling.__init__-55"><a href="#RandomGoalSampling.__init__-55"><span class="linenos">55</span></a><span class="sd">            subset_size_perc (float):</span>
</span><span id="RandomGoalSampling.__init__-56"><a href="#RandomGoalSampling.__init__-56"><span class="linenos">56</span></a><span class="sd">                The percentage of fluents to extract to use as a goal state from the generated states.</span>
</span><span id="RandomGoalSampling.__init__-57"><a href="#RandomGoalSampling.__init__-57"><span class="linenos">57</span></a><span class="sd">            num_traces (int):</span>
</span><span id="RandomGoalSampling.__init__-58"><a href="#RandomGoalSampling.__init__-58"><span class="linenos">58</span></a><span class="sd">                The number of traces to generate. Defaults to 1.</span>
</span><span id="RandomGoalSampling.__init__-59"><a href="#RandomGoalSampling.__init__-59"><span class="linenos">59</span></a><span class="sd">            dom (str):</span>
</span><span id="RandomGoalSampling.__init__-60"><a href="#RandomGoalSampling.__init__-60"><span class="linenos">60</span></a><span class="sd">                The domain filename.</span>
</span><span id="RandomGoalSampling.__init__-61"><a href="#RandomGoalSampling.__init__-61"><span class="linenos">61</span></a><span class="sd">            prob (str):</span>
</span><span id="RandomGoalSampling.__init__-62"><a href="#RandomGoalSampling.__init__-62"><span class="linenos">62</span></a><span class="sd">                The problem filename.</span>
</span><span id="RandomGoalSampling.__init__-63"><a href="#RandomGoalSampling.__init__-63"><span class="linenos">63</span></a><span class="sd">            problem_id (int):</span>
</span><span id="RandomGoalSampling.__init__-64"><a href="#RandomGoalSampling.__init__-64"><span class="linenos">64</span></a><span class="sd">                The ID of the problem to access.</span>
</span><span id="RandomGoalSampling.__init__-65"><a href="#RandomGoalSampling.__init__-65"><span class="linenos">65</span></a><span class="sd">            max_time (float):</span>
</span><span id="RandomGoalSampling.__init__-66"><a href="#RandomGoalSampling.__init__-66"><span class="linenos">66</span></a><span class="sd">                The maximum time allowed for a trace to be generated.</span>
</span><span id="RandomGoalSampling.__init__-67"><a href="#RandomGoalSampling.__init__-67"><span class="linenos">67</span></a><span class="sd">            observe_pres_effs (bool):</span>
</span><span id="RandomGoalSampling.__init__-68"><a href="#RandomGoalSampling.__init__-68"><span class="linenos">68</span></a><span class="sd">                Option to observe action preconditions and effects upon generation.</span>
</span><span id="RandomGoalSampling.__init__-69"><a href="#RandomGoalSampling.__init__-69"><span class="linenos">69</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="RandomGoalSampling.__init__-70"><a href="#RandomGoalSampling.__init__-70"><span class="linenos">70</span></a>        <span class="k">if</span> <span class="n">subset_size_perc</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">subset_size_perc</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="RandomGoalSampling.__init__-71"><a href="#RandomGoalSampling.__init__-71"><span class="linenos">71</span></a>            <span class="k">raise</span> <span class="n">PercentError</span><span class="p">()</span>
</span><span id="RandomGoalSampling.__init__-72"><a href="#RandomGoalSampling.__init__-72"><span class="linenos">72</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">steps_deep</span> <span class="o">=</span> <span class="n">steps_deep</span>
</span><span id="RandomGoalSampling.__init__-73"><a href="#RandomGoalSampling.__init__-73"><span class="linenos">73</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">enforced_hill_climbing_sampling</span> <span class="o">=</span> <span class="n">enforced_hill_climbing_sampling</span>
</span><span id="RandomGoalSampling.__init__-74"><a href="#RandomGoalSampling.__init__-74"><span class="linenos">74</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">subset_size_perc</span> <span class="o">=</span> <span class="n">subset_size_perc</span>
</span><span id="RandomGoalSampling.__init__-75"><a href="#RandomGoalSampling.__init__-75"><span class="linenos">75</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">goals_inits_plans</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="RandomGoalSampling.__init__-76"><a href="#RandomGoalSampling.__init__-76"><span class="linenos">76</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="RandomGoalSampling.__init__-77"><a href="#RandomGoalSampling.__init__-77"><span class="linenos">77</span></a>            <span class="n">dom</span><span class="o">=</span><span class="n">dom</span><span class="p">,</span>
</span><span id="RandomGoalSampling.__init__-78"><a href="#RandomGoalSampling.__init__-78"><span class="linenos">78</span></a>            <span class="n">prob</span><span class="o">=</span><span class="n">prob</span><span class="p">,</span>
</span><span id="RandomGoalSampling.__init__-79"><a href="#RandomGoalSampling.__init__-79"><span class="linenos">79</span></a>            <span class="n">problem_id</span><span class="o">=</span><span class="n">problem_id</span><span class="p">,</span>
</span><span id="RandomGoalSampling.__init__-80"><a href="#RandomGoalSampling.__init__-80"><span class="linenos">80</span></a>            <span class="n">num_traces</span><span class="o">=</span><span class="n">num_traces</span><span class="p">,</span>
</span><span id="RandomGoalSampling.__init__-81"><a href="#RandomGoalSampling.__init__-81"><span class="linenos">81</span></a>            <span class="n">observe_pres_effs</span><span class="o">=</span><span class="n">observe_pres_effs</span><span class="p">,</span>
</span><span id="RandomGoalSampling.__init__-82"><a href="#RandomGoalSampling.__init__-82"><span class="linenos">82</span></a>            <span class="n">max_time</span><span class="o">=</span><span class="n">max_time</span><span class="p">,</span>
</span><span id="RandomGoalSampling.__init__-83"><a href="#RandomGoalSampling.__init__-83"><span class="linenos">83</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Initializes a random goal state trace sampler using the plan length, number of traces,
and the domain and problem.</p>

<p>Args:
    steps_deep (int):
        The number of steps deep to extract goal states from.
    enforced_hill_climbing_sampling (bool):
        Optional method of goal sampling where once a goal is found, that (full) goal state is set as the initial state for the next
        iteration. This results in more unique goals as the goal state sampling starts in different areas of the state space each time.
        Note that the goals will come from different initial states.
    subset_size_perc (float):
        The percentage of fluents to extract to use as a goal state from the generated states.
    num_traces (int):
        The number of traces to generate. Defaults to 1.
    dom (str):
        The domain filename.
    prob (str):
        The problem filename.
    problem_id (int):
        The ID of the problem to access.
    max_time (float):
        The maximum time allowed for a trace to be generated.
    observe_pres_effs (bool):
        Option to observe action preconditions and effects upon generation.</p>
</div>


                            </div>
                            <div id="RandomGoalSampling.goal_sampling" class="classattr">
                                        <input id="RandomGoalSampling.goal_sampling-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">goal_sampling</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="RandomGoalSampling.goal_sampling-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#RandomGoalSampling.goal_sampling"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="RandomGoalSampling.goal_sampling-85"><a href="#RandomGoalSampling.goal_sampling-85"><span class="linenos"> 85</span></a>    <span class="k">def</span> <span class="nf">goal_sampling</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="RandomGoalSampling.goal_sampling-86"><a href="#RandomGoalSampling.goal_sampling-86"><span class="linenos"> 86</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Samples goals by randomly generating candidate goal states k (`steps_deep`) steps deep, then running planners on those</span>
</span><span id="RandomGoalSampling.goal_sampling-87"><a href="#RandomGoalSampling.goal_sampling-87"><span class="linenos"> 87</span></a><span class="sd">        goal states to ensure the goals are complex enough (i.e. cannot be reached in too few steps). Candidate</span>
</span><span id="RandomGoalSampling.goal_sampling-88"><a href="#RandomGoalSampling.goal_sampling-88"><span class="linenos"> 88</span></a><span class="sd">        goal states are generated for a set amount of time indicated by MAX_GOAL_SEARCH_TIME, and the goals with the</span>
</span><span id="RandomGoalSampling.goal_sampling-89"><a href="#RandomGoalSampling.goal_sampling-89"><span class="linenos"> 89</span></a><span class="sd">        longest plans (the most complex goals) are selected.</span>
</span><span id="RandomGoalSampling.goal_sampling-90"><a href="#RandomGoalSampling.goal_sampling-90"><span class="linenos"> 90</span></a>
</span><span id="RandomGoalSampling.goal_sampling-91"><a href="#RandomGoalSampling.goal_sampling-91"><span class="linenos"> 91</span></a><span class="sd">        Returns: An OrderedDict holding the longest goal states along with the initial state and plans used to reach them.</span>
</span><span id="RandomGoalSampling.goal_sampling-92"><a href="#RandomGoalSampling.goal_sampling-92"><span class="linenos"> 92</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="RandomGoalSampling.goal_sampling-93"><a href="#RandomGoalSampling.goal_sampling-93"><span class="linenos"> 93</span></a>        <span class="n">goal_states</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="RandomGoalSampling.goal_sampling-94"><a href="#RandomGoalSampling.goal_sampling-94"><span class="linenos"> 94</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">generate_goals_setup</span><span class="p">(</span><span class="n">num_seconds</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">max_time</span><span class="p">,</span> <span class="n">goal_states</span><span class="o">=</span><span class="n">goal_states</span><span class="p">)()</span>
</span><span id="RandomGoalSampling.goal_sampling-95"><a href="#RandomGoalSampling.goal_sampling-95"><span class="linenos"> 95</span></a>        <span class="c1"># sort the results by plan length and get the k largest ones</span>
</span><span id="RandomGoalSampling.goal_sampling-96"><a href="#RandomGoalSampling.goal_sampling-96"><span class="linenos"> 96</span></a>        <span class="n">filtered_goals</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span>
</span><span id="RandomGoalSampling.goal_sampling-97"><a href="#RandomGoalSampling.goal_sampling-97"><span class="linenos"> 97</span></a>            <span class="nb">sorted</span><span class="p">(</span><span class="n">goal_states</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;plan&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">actions</span><span class="p">))</span>
</span><span id="RandomGoalSampling.goal_sampling-98"><a href="#RandomGoalSampling.goal_sampling-98"><span class="linenos"> 98</span></a>        <span class="p">)</span>
</span><span id="RandomGoalSampling.goal_sampling-99"><a href="#RandomGoalSampling.goal_sampling-99"><span class="linenos"> 99</span></a>        <span class="n">to_del</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">filtered_goals</span><span class="o">.</span><span class="n">keys</span><span class="p">())[:</span> <span class="nb">len</span><span class="p">(</span><span class="n">filtered_goals</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_traces</span><span class="p">]</span>
</span><span id="RandomGoalSampling.goal_sampling-100"><a href="#RandomGoalSampling.goal_sampling-100"><span class="linenos">100</span></a>        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">to_del</span><span class="p">:</span>
</span><span id="RandomGoalSampling.goal_sampling-101"><a href="#RandomGoalSampling.goal_sampling-101"><span class="linenos">101</span></a>            <span class="k">del</span> <span class="n">filtered_goals</span><span class="p">[</span><span class="n">d</span><span class="p">]</span>
</span><span id="RandomGoalSampling.goal_sampling-102"><a href="#RandomGoalSampling.goal_sampling-102"><span class="linenos">102</span></a>        <span class="k">return</span> <span class="n">filtered_goals</span>
</span></pre></div>


            <div class="docstring"><p>Samples goals by randomly generating candidate goal states k (<code>steps_deep</code>) steps deep, then running planners on those
goal states to ensure the goals are complex enough (i.e. cannot be reached in too few steps). Candidate
goal states are generated for a set amount of time indicated by MAX_GOAL_SEARCH_TIME, and the goals with the
longest plans (the most complex goals) are selected.</p>

<p>Returns: An OrderedDict holding the longest goal states along with the initial state and plans used to reach them.</p>
</div>


                            </div>
                            <div id="RandomGoalSampling.generate_goals_setup" class="classattr">
                                        <input id="RandomGoalSampling.generate_goals_setup-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">generate_goals_setup</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">num_seconds</span><span class="p">:</span> <span class="nb">float</span>, </span><span class="param"><span class="n">goal_states</span><span class="p">:</span> <span class="n">Dict</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="RandomGoalSampling.generate_goals_setup-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#RandomGoalSampling.generate_goals_setup"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="RandomGoalSampling.generate_goals_setup-104"><a href="#RandomGoalSampling.generate_goals_setup-104"><span class="linenos">104</span></a>    <span class="k">def</span> <span class="nf">generate_goals_setup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_seconds</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">goal_states</span><span class="p">:</span> <span class="n">Dict</span><span class="p">):</span>
</span><span id="RandomGoalSampling.generate_goals_setup-105"><a href="#RandomGoalSampling.generate_goals_setup-105"><span class="linenos">105</span></a>        <span class="nd">@basic_timer</span><span class="p">(</span><span class="n">num_seconds</span><span class="o">=</span><span class="n">num_seconds</span><span class="p">)</span>
</span><span id="RandomGoalSampling.generate_goals_setup-106"><a href="#RandomGoalSampling.generate_goals_setup-106"><span class="linenos">106</span></a>        <span class="k">def</span> <span class="nf">generate_goals</span><span class="p">(</span><span class="bp">self</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">goal_states</span><span class="o">=</span><span class="n">goal_states</span><span class="p">):</span>
</span><span id="RandomGoalSampling.generate_goals_setup-107"><a href="#RandomGoalSampling.generate_goals_setup-107"><span class="linenos">107</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;Helper function for `goal_sampling`. Generates as many goals as possible within the specified max_time seconds (timing is</span>
</span><span id="RandomGoalSampling.generate_goals_setup-108"><a href="#RandomGoalSampling.generate_goals_setup-108"><span class="linenos">108</span></a><span class="sd">            enforced by the basic_timer wrapper).</span>
</span><span id="RandomGoalSampling.generate_goals_setup-109"><a href="#RandomGoalSampling.generate_goals_setup-109"><span class="linenos">109</span></a>
</span><span id="RandomGoalSampling.generate_goals_setup-110"><a href="#RandomGoalSampling.generate_goals_setup-110"><span class="linenos">110</span></a><span class="sd">            The outside function is a wrapper that provides parameters for both the timer</span>
</span><span id="RandomGoalSampling.generate_goals_setup-111"><a href="#RandomGoalSampling.generate_goals_setup-111"><span class="linenos">111</span></a><span class="sd">            wrapper and the function.</span>
</span><span id="RandomGoalSampling.generate_goals_setup-112"><a href="#RandomGoalSampling.generate_goals_setup-112"><span class="linenos">112</span></a>
</span><span id="RandomGoalSampling.generate_goals_setup-113"><a href="#RandomGoalSampling.generate_goals_setup-113"><span class="linenos">113</span></a><span class="sd">            Given the specified number of traces `num_traces`, if `num_traces` plans of length k (`steps_deep`) are found before</span>
</span><span id="RandomGoalSampling.generate_goals_setup-114"><a href="#RandomGoalSampling.generate_goals_setup-114"><span class="linenos">114</span></a><span class="sd">            the time is up, exit early.</span>
</span><span id="RandomGoalSampling.generate_goals_setup-115"><a href="#RandomGoalSampling.generate_goals_setup-115"><span class="linenos">115</span></a>
</span><span id="RandomGoalSampling.generate_goals_setup-116"><a href="#RandomGoalSampling.generate_goals_setup-116"><span class="linenos">116</span></a><span class="sd">            Args:</span>
</span><span id="RandomGoalSampling.generate_goals_setup-117"><a href="#RandomGoalSampling.generate_goals_setup-117"><span class="linenos">117</span></a><span class="sd">                goal_states (Dict):</span>
</span><span id="RandomGoalSampling.generate_goals_setup-118"><a href="#RandomGoalSampling.generate_goals_setup-118"><span class="linenos">118</span></a><span class="sd">                    The dictionary to fill with the values of each goal state, initial state, and plan.</span>
</span><span id="RandomGoalSampling.generate_goals_setup-119"><a href="#RandomGoalSampling.generate_goals_setup-119"><span class="linenos">119</span></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="RandomGoalSampling.generate_goals_setup-120"><a href="#RandomGoalSampling.generate_goals_setup-120"><span class="linenos">120</span></a>            <span class="c1"># create a sampler to test the complexity of the new goal by running a planner on it</span>
</span><span id="RandomGoalSampling.generate_goals_setup-121"><a href="#RandomGoalSampling.generate_goals_setup-121"><span class="linenos">121</span></a>            <span class="n">k_length_plans</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="RandomGoalSampling.generate_goals_setup-122"><a href="#RandomGoalSampling.generate_goals_setup-122"><span class="linenos">122</span></a>            <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="RandomGoalSampling.generate_goals_setup-123"><a href="#RandomGoalSampling.generate_goals_setup-123"><span class="linenos">123</span></a>                <span class="c1"># generate a trace of the specified length and retrieve the state of the last step</span>
</span><span id="RandomGoalSampling.generate_goals_setup-124"><a href="#RandomGoalSampling.generate_goals_setup-124"><span class="linenos">124</span></a>                <span class="n">state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_single_trace_setup</span><span class="p">(</span>
</span><span id="RandomGoalSampling.generate_goals_setup-125"><a href="#RandomGoalSampling.generate_goals_setup-125"><span class="linenos">125</span></a>                    <span class="n">num_seconds</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps_deep</span>
</span><span id="RandomGoalSampling.generate_goals_setup-126"><a href="#RandomGoalSampling.generate_goals_setup-126"><span class="linenos">126</span></a>                <span class="p">)()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">state</span>
</span><span id="RandomGoalSampling.generate_goals_setup-127"><a href="#RandomGoalSampling.generate_goals_setup-127"><span class="linenos">127</span></a>
</span><span id="RandomGoalSampling.generate_goals_setup-128"><a href="#RandomGoalSampling.generate_goals_setup-128"><span class="linenos">128</span></a>                <span class="c1"># get all positive fluents (only positive fluents can be used for a goal)</span>
</span><span id="RandomGoalSampling.generate_goals_setup-129"><a href="#RandomGoalSampling.generate_goals_setup-129"><span class="linenos">129</span></a>                <span class="n">goal_f</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">state</span> <span class="k">if</span> <span class="n">state</span><span class="p">[</span><span class="n">f</span><span class="p">]]</span>
</span><span id="RandomGoalSampling.generate_goals_setup-130"><a href="#RandomGoalSampling.generate_goals_setup-130"><span class="linenos">130</span></a>                <span class="c1"># get next initial state (only used for enforced hill climbing sampling)</span>
</span><span id="RandomGoalSampling.generate_goals_setup-131"><a href="#RandomGoalSampling.generate_goals_setup-131"><span class="linenos">131</span></a>                <span class="n">next_init_f</span> <span class="o">=</span> <span class="n">goal_f</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="RandomGoalSampling.generate_goals_setup-132"><a href="#RandomGoalSampling.generate_goals_setup-132"><span class="linenos">132</span></a>                <span class="c1"># get the subset size</span>
</span><span id="RandomGoalSampling.generate_goals_setup-133"><a href="#RandomGoalSampling.generate_goals_setup-133"><span class="linenos">133</span></a>                <span class="n">subset_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">fluents</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">subset_size_perc</span><span class="p">)</span>
</span><span id="RandomGoalSampling.generate_goals_setup-134"><a href="#RandomGoalSampling.generate_goals_setup-134"><span class="linenos">134</span></a>                <span class="c1"># if necessary, take a subset of the fluents</span>
</span><span id="RandomGoalSampling.generate_goals_setup-135"><a href="#RandomGoalSampling.generate_goals_setup-135"><span class="linenos">135</span></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">goal_f</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">subset_size</span><span class="p">:</span>
</span><span id="RandomGoalSampling.generate_goals_setup-136"><a href="#RandomGoalSampling.generate_goals_setup-136"><span class="linenos">136</span></a>                    <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">goal_f</span><span class="p">)</span>
</span><span id="RandomGoalSampling.generate_goals_setup-137"><a href="#RandomGoalSampling.generate_goals_setup-137"><span class="linenos">137</span></a>                    <span class="n">goal_f</span> <span class="o">=</span> <span class="n">goal_f</span><span class="p">[:</span><span class="n">subset_size</span><span class="p">]</span>
</span><span id="RandomGoalSampling.generate_goals_setup-138"><a href="#RandomGoalSampling.generate_goals_setup-138"><span class="linenos">138</span></a>
</span><span id="RandomGoalSampling.generate_goals_setup-139"><a href="#RandomGoalSampling.generate_goals_setup-139"><span class="linenos">139</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">change_goal</span><span class="p">(</span><span class="n">goal_fluents</span><span class="o">=</span><span class="n">goal_f</span><span class="p">)</span>
</span><span id="RandomGoalSampling.generate_goals_setup-140"><a href="#RandomGoalSampling.generate_goals_setup-140"><span class="linenos">140</span></a>
</span><span id="RandomGoalSampling.generate_goals_setup-141"><a href="#RandomGoalSampling.generate_goals_setup-141"><span class="linenos">141</span></a>                <span class="c1"># ensure that the goal doesn&#39;t hold in the initial state; restart if it does</span>
</span><span id="RandomGoalSampling.generate_goals_setup-142"><a href="#RandomGoalSampling.generate_goals_setup-142"><span class="linenos">142</span></a>                <span class="n">init_state</span> <span class="o">=</span> <span class="p">{</span><span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">as_atoms</span><span class="p">()}</span>
</span><span id="RandomGoalSampling.generate_goals_setup-143"><a href="#RandomGoalSampling.generate_goals_setup-143"><span class="linenos">143</span></a>                <span class="n">goal</span> <span class="o">=</span> <span class="p">{</span><span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="o">.</span><span class="n">goal</span><span class="o">.</span><span class="n">subformulas</span><span class="p">}</span>
</span><span id="RandomGoalSampling.generate_goals_setup-144"><a href="#RandomGoalSampling.generate_goals_setup-144"><span class="linenos">144</span></a>
</span><span id="RandomGoalSampling.generate_goals_setup-145"><a href="#RandomGoalSampling.generate_goals_setup-145"><span class="linenos">145</span></a>                <span class="k">if</span> <span class="n">goal</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="n">init_state</span><span class="p">):</span>
</span><span id="RandomGoalSampling.generate_goals_setup-146"><a href="#RandomGoalSampling.generate_goals_setup-146"><span class="linenos">146</span></a>                    <span class="k">continue</span>
</span><span id="RandomGoalSampling.generate_goals_setup-147"><a href="#RandomGoalSampling.generate_goals_setup-147"><span class="linenos">147</span></a>
</span><span id="RandomGoalSampling.generate_goals_setup-148"><a href="#RandomGoalSampling.generate_goals_setup-148"><span class="linenos">148</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="RandomGoalSampling.generate_goals_setup-149"><a href="#RandomGoalSampling.generate_goals_setup-149"><span class="linenos">149</span></a>                    <span class="c1"># attempt to generate a plan, and find a new goal if a plan can&#39;t be found</span>
</span><span id="RandomGoalSampling.generate_goals_setup-150"><a href="#RandomGoalSampling.generate_goals_setup-150"><span class="linenos">150</span></a>                    <span class="c1"># should only crash if there are server issues</span>
</span><span id="RandomGoalSampling.generate_goals_setup-151"><a href="#RandomGoalSampling.generate_goals_setup-151"><span class="linenos">151</span></a>                    <span class="n">test_plan</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_plan</span><span class="p">()</span>
</span><span id="RandomGoalSampling.generate_goals_setup-152"><a href="#RandomGoalSampling.generate_goals_setup-152"><span class="linenos">152</span></a>                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
</span><span id="RandomGoalSampling.generate_goals_setup-153"><a href="#RandomGoalSampling.generate_goals_setup-153"><span class="linenos">153</span></a>                    <span class="k">continue</span>
</span><span id="RandomGoalSampling.generate_goals_setup-154"><a href="#RandomGoalSampling.generate_goals_setup-154"><span class="linenos">154</span></a>
</span><span id="RandomGoalSampling.generate_goals_setup-155"><a href="#RandomGoalSampling.generate_goals_setup-155"><span class="linenos">155</span></a>                <span class="c1"># create a State and add it to the dictionary</span>
</span><span id="RandomGoalSampling.generate_goals_setup-156"><a href="#RandomGoalSampling.generate_goals_setup-156"><span class="linenos">156</span></a>                <span class="n">state_dict</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="RandomGoalSampling.generate_goals_setup-157"><a href="#RandomGoalSampling.generate_goals_setup-157"><span class="linenos">157</span></a>                <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">goal_f</span><span class="p">:</span>
</span><span id="RandomGoalSampling.generate_goals_setup-158"><a href="#RandomGoalSampling.generate_goals_setup-158"><span class="linenos">158</span></a>                    <span class="n">state_dict</span><span class="p">[</span><span class="n">f</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="RandomGoalSampling.generate_goals_setup-159"><a href="#RandomGoalSampling.generate_goals_setup-159"><span class="linenos">159</span></a>                <span class="c1"># map each goal to the initial state and plan used to achieve it</span>
</span><span id="RandomGoalSampling.generate_goals_setup-160"><a href="#RandomGoalSampling.generate_goals_setup-160"><span class="linenos">160</span></a>                <span class="n">goal_states</span><span class="p">[</span><span class="n">State</span><span class="p">(</span><span class="n">state_dict</span><span class="p">)]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="RandomGoalSampling.generate_goals_setup-161"><a href="#RandomGoalSampling.generate_goals_setup-161"><span class="linenos">161</span></a>                    <span class="s2">&quot;plan&quot;</span><span class="p">:</span> <span class="n">test_plan</span><span class="p">,</span>
</span><span id="RandomGoalSampling.generate_goals_setup-162"><a href="#RandomGoalSampling.generate_goals_setup-162"><span class="linenos">162</span></a>                    <span class="s2">&quot;initial state&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="o">.</span><span class="n">init</span><span class="p">,</span>
</span><span id="RandomGoalSampling.generate_goals_setup-163"><a href="#RandomGoalSampling.generate_goals_setup-163"><span class="linenos">163</span></a>                <span class="p">}</span>
</span><span id="RandomGoalSampling.generate_goals_setup-164"><a href="#RandomGoalSampling.generate_goals_setup-164"><span class="linenos">164</span></a>
</span><span id="RandomGoalSampling.generate_goals_setup-165"><a href="#RandomGoalSampling.generate_goals_setup-165"><span class="linenos">165</span></a>                <span class="c1"># optionally change the initial state of the sampler for the next iteration to the goal state just generated (ensures more diversity in goals/plans)</span>
</span><span id="RandomGoalSampling.generate_goals_setup-166"><a href="#RandomGoalSampling.generate_goals_setup-166"><span class="linenos">166</span></a>                <span class="c1"># use the full state the goal was extracted from as the initial state to prevent planning errors from incomplete initial states</span>
</span><span id="RandomGoalSampling.generate_goals_setup-167"><a href="#RandomGoalSampling.generate_goals_setup-167"><span class="linenos">167</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">enforced_hill_climbing_sampling</span><span class="p">:</span>
</span><span id="RandomGoalSampling.generate_goals_setup-168"><a href="#RandomGoalSampling.generate_goals_setup-168"><span class="linenos">168</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">change_init</span><span class="p">(</span><span class="n">next_init_f</span><span class="p">)</span>
</span><span id="RandomGoalSampling.generate_goals_setup-169"><a href="#RandomGoalSampling.generate_goals_setup-169"><span class="linenos">169</span></a>
</span><span id="RandomGoalSampling.generate_goals_setup-170"><a href="#RandomGoalSampling.generate_goals_setup-170"><span class="linenos">170</span></a>                <span class="c1"># keep track of the number of plans of length k; if we get enough of them, exit early</span>
</span><span id="RandomGoalSampling.generate_goals_setup-171"><a href="#RandomGoalSampling.generate_goals_setup-171"><span class="linenos">171</span></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_plan</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps_deep</span><span class="p">:</span>
</span><span id="RandomGoalSampling.generate_goals_setup-172"><a href="#RandomGoalSampling.generate_goals_setup-172"><span class="linenos">172</span></a>                    <span class="n">k_length_plans</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="RandomGoalSampling.generate_goals_setup-173"><a href="#RandomGoalSampling.generate_goals_setup-173"><span class="linenos">173</span></a>                <span class="k">if</span> <span class="n">k_length_plans</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_traces</span><span class="p">:</span>
</span><span id="RandomGoalSampling.generate_goals_setup-174"><a href="#RandomGoalSampling.generate_goals_setup-174"><span class="linenos">174</span></a>                    <span class="k">break</span>
</span><span id="RandomGoalSampling.generate_goals_setup-175"><a href="#RandomGoalSampling.generate_goals_setup-175"><span class="linenos">175</span></a>
</span><span id="RandomGoalSampling.generate_goals_setup-176"><a href="#RandomGoalSampling.generate_goals_setup-176"><span class="linenos">176</span></a>        <span class="k">return</span> <span class="n">generate_goals</span>
</span></pre></div>


    

                            </div>
                            <div id="RandomGoalSampling.generate_traces" class="classattr">
                                        <input id="RandomGoalSampling.generate_traces-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">generate_traces</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="RandomGoalSampling.generate_traces-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#RandomGoalSampling.generate_traces"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="RandomGoalSampling.generate_traces-178"><a href="#RandomGoalSampling.generate_traces-178"><span class="linenos">178</span></a>    <span class="k">def</span> <span class="nf">generate_traces</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="RandomGoalSampling.generate_traces-179"><a href="#RandomGoalSampling.generate_traces-179"><span class="linenos">179</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Generates traces based on the sampled goals. Traces are generated using the initial state and plan used to achieve the goal.</span>
</span><span id="RandomGoalSampling.generate_traces-180"><a href="#RandomGoalSampling.generate_traces-180"><span class="linenos">180</span></a>
</span><span id="RandomGoalSampling.generate_traces-181"><a href="#RandomGoalSampling.generate_traces-181"><span class="linenos">181</span></a><span class="sd">        Returns:</span>
</span><span id="RandomGoalSampling.generate_traces-182"><a href="#RandomGoalSampling.generate_traces-182"><span class="linenos">182</span></a><span class="sd">            A TraceList with the generated traces.</span>
</span><span id="RandomGoalSampling.generate_traces-183"><a href="#RandomGoalSampling.generate_traces-183"><span class="linenos">183</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="RandomGoalSampling.generate_traces-184"><a href="#RandomGoalSampling.generate_traces-184"><span class="linenos">184</span></a>        <span class="n">traces</span> <span class="o">=</span> <span class="n">TraceList</span><span class="p">()</span>
</span><span id="RandomGoalSampling.generate_traces-185"><a href="#RandomGoalSampling.generate_traces-185"><span class="linenos">185</span></a>        <span class="c1"># retrieve goals and their respective plans</span>
</span><span id="RandomGoalSampling.generate_traces-186"><a href="#RandomGoalSampling.generate_traces-186"><span class="linenos">186</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">goals_inits_plans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">goal_sampling</span><span class="p">()</span>
</span><span id="RandomGoalSampling.generate_traces-187"><a href="#RandomGoalSampling.generate_traces-187"><span class="linenos">187</span></a>        <span class="c1"># iterate through all plans corresponding to the goals, generating traces</span>
</span><span id="RandomGoalSampling.generate_traces-188"><a href="#RandomGoalSampling.generate_traces-188"><span class="linenos">188</span></a>        <span class="k">for</span> <span class="n">goal</span> <span class="ow">in</span> <span class="n">progress</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">goals_inits_plans</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
</span><span id="RandomGoalSampling.generate_traces-189"><a href="#RandomGoalSampling.generate_traces-189"><span class="linenos">189</span></a>            <span class="c1"># update the initial state if necessary</span>
</span><span id="RandomGoalSampling.generate_traces-190"><a href="#RandomGoalSampling.generate_traces-190"><span class="linenos">190</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">enforced_hill_climbing_sampling</span><span class="p">:</span>
</span><span id="RandomGoalSampling.generate_traces-191"><a href="#RandomGoalSampling.generate_traces-191"><span class="linenos">191</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="o">.</span><span class="n">init</span> <span class="o">=</span> <span class="n">goal</span><span class="p">[</span><span class="s2">&quot;initial state&quot;</span><span class="p">]</span>
</span><span id="RandomGoalSampling.generate_traces-192"><a href="#RandomGoalSampling.generate_traces-192"><span class="linenos">192</span></a>            <span class="c1"># generate a plan based on the new goal/initial state, then generate a trace based on that plan</span>
</span><span id="RandomGoalSampling.generate_traces-193"><a href="#RandomGoalSampling.generate_traces-193"><span class="linenos">193</span></a>            <span class="n">traces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">generate_single_trace_from_plan</span><span class="p">(</span><span class="n">goal</span><span class="p">[</span><span class="s2">&quot;plan&quot;</span><span class="p">]))</span>
</span><span id="RandomGoalSampling.generate_traces-194"><a href="#RandomGoalSampling.generate_traces-194"><span class="linenos">194</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">traces</span> <span class="o">=</span> <span class="n">traces</span>
</span><span id="RandomGoalSampling.generate_traces-195"><a href="#RandomGoalSampling.generate_traces-195"><span class="linenos">195</span></a>        <span class="k">return</span> <span class="n">traces</span>
</span></pre></div>


            <div class="docstring"><p>Generates traces based on the sampled goals. Traces are generated using the initial state and plan used to achieve the goal.</p>

<p>Returns:
    A TraceList with the generated traces.</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#VanillaSampling">VanillaSampling</a></dt>
                                <dd id="RandomGoalSampling.generate_single_trace_setup" class="function"><a href="#VanillaSampling.generate_single_trace_setup">generate_single_trace_setup</a></dd>

            </div>
            <div><dt><a href="#Generator">Generator</a></dt>
                                <dd id="RandomGoalSampling.extract_action_typing" class="function"><a href="#Generator.extract_action_typing">extract_action_typing</a></dd>
                <dd id="RandomGoalSampling.extract_predicate_typing" class="function"><a href="#Generator.extract_predicate_typing">extract_predicate_typing</a></dd>
                <dd id="RandomGoalSampling.tarski_state_to_macq" class="function"><a href="#Generator.tarski_state_to_macq">tarski_state_to_macq</a></dd>
                <dd id="RandomGoalSampling.tarski_act_to_macq" class="function"><a href="#Generator.tarski_act_to_macq">tarski_act_to_macq</a></dd>
                <dd id="RandomGoalSampling.change_init" class="function"><a href="#Generator.change_init">change_init</a></dd>
                <dd id="RandomGoalSampling.change_goal" class="function"><a href="#Generator.change_goal">change_goal</a></dd>
                <dd id="RandomGoalSampling.generate_plan" class="function"><a href="#Generator.generate_plan">generate_plan</a></dd>
                <dd id="RandomGoalSampling.generate_single_trace_from_plan" class="function"><a href="#Generator.generate_single_trace_from_plan">generate_single_trace_from_plan</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="FDRandomWalkSampling">
                            <input id="FDRandomWalkSampling-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">FDRandomWalkSampling</span><wbr>(<span class="base"><a href="#VanillaSampling">macq.generate.pddl.VanillaSampling</a></span>):

                <label class="view-source-button" for="FDRandomWalkSampling-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FDRandomWalkSampling"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FDRandomWalkSampling-7"><a href="#FDRandomWalkSampling-7"><span class="linenos">  7</span></a><span class="k">class</span> <span class="nc">FDRandomWalkSampling</span><span class="p">(</span><span class="n">VanillaSampling</span><span class="p">):</span>
</span><span id="FDRandomWalkSampling-8"><a href="#FDRandomWalkSampling-8"><span class="linenos">  8</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Random Walk Sampler -- inherits from the VanillaSampling base class.</span>
</span><span id="FDRandomWalkSampling-9"><a href="#FDRandomWalkSampling-9"><span class="linenos">  9</span></a>
</span><span id="FDRandomWalkSampling-10"><a href="#FDRandomWalkSampling-10"><span class="linenos"> 10</span></a><span class="sd">    Follows the method laid out in the FastDownward planning system for conducting state samples:</span>
</span><span id="FDRandomWalkSampling-11"><a href="#FDRandomWalkSampling-11"><span class="linenos"> 11</span></a><span class="sd">    - https://github.com/aibasel/downward/blob/main/src/search/task_utils/sampling.cc</span>
</span><span id="FDRandomWalkSampling-12"><a href="#FDRandomWalkSampling-12"><span class="linenos"> 12</span></a>
</span><span id="FDRandomWalkSampling-13"><a href="#FDRandomWalkSampling-13"><span class="linenos"> 13</span></a><span class="sd">    Taken from the FastDownward planning system:</span>
</span><span id="FDRandomWalkSampling-14"><a href="#FDRandomWalkSampling-14"><span class="linenos"> 14</span></a><span class="sd">        The walk length is taken from a binomial distribution centered around the</span>
</span><span id="FDRandomWalkSampling-15"><a href="#FDRandomWalkSampling-15"><span class="linenos"> 15</span></a><span class="sd">        estimated plan length, which is computed as the ratio of the h value of</span>
</span><span id="FDRandomWalkSampling-16"><a href="#FDRandomWalkSampling-16"><span class="linenos"> 16</span></a><span class="sd">        the initial state divided by the average operator costs. Whenever a dead</span>
</span><span id="FDRandomWalkSampling-17"><a href="#FDRandomWalkSampling-17"><span class="linenos"> 17</span></a><span class="sd">        end is detected or a state has no successors, restart from the initial</span>
</span><span id="FDRandomWalkSampling-18"><a href="#FDRandomWalkSampling-18"><span class="linenos"> 18</span></a><span class="sd">        state. The &#39;init_h&#39; value should be an estimate of the solution cost.</span>
</span><span id="FDRandomWalkSampling-19"><a href="#FDRandomWalkSampling-19"><span class="linenos"> 19</span></a>
</span><span id="FDRandomWalkSampling-20"><a href="#FDRandomWalkSampling-20"><span class="linenos"> 20</span></a><span class="sd">    Attributes:</span>
</span><span id="FDRandomWalkSampling-21"><a href="#FDRandomWalkSampling-21"><span class="linenos"> 21</span></a><span class="sd">        max_time(float):</span>
</span><span id="FDRandomWalkSampling-22"><a href="#FDRandomWalkSampling-22"><span class="linenos"> 22</span></a><span class="sd">            The maximum time allowed for a trace to be generated.</span>
</span><span id="FDRandomWalkSampling-23"><a href="#FDRandomWalkSampling-23"><span class="linenos"> 23</span></a><span class="sd">        init_h(int):</span>
</span><span id="FDRandomWalkSampling-24"><a href="#FDRandomWalkSampling-24"><span class="linenos"> 24</span></a><span class="sd">            Initial estimate of the cost to the goal.</span>
</span><span id="FDRandomWalkSampling-25"><a href="#FDRandomWalkSampling-25"><span class="linenos"> 25</span></a><span class="sd">        num_traces (int):</span>
</span><span id="FDRandomWalkSampling-26"><a href="#FDRandomWalkSampling-26"><span class="linenos"> 26</span></a><span class="sd">            The number of traces to be generated.</span>
</span><span id="FDRandomWalkSampling-27"><a href="#FDRandomWalkSampling-27"><span class="linenos"> 27</span></a><span class="sd">        traces (TraceList):</span>
</span><span id="FDRandomWalkSampling-28"><a href="#FDRandomWalkSampling-28"><span class="linenos"> 28</span></a><span class="sd">            The list of traces generated.</span>
</span><span id="FDRandomWalkSampling-29"><a href="#FDRandomWalkSampling-29"><span class="linenos"> 29</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="FDRandomWalkSampling-30"><a href="#FDRandomWalkSampling-30"><span class="linenos"> 30</span></a>
</span><span id="FDRandomWalkSampling-31"><a href="#FDRandomWalkSampling-31"><span class="linenos"> 31</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="FDRandomWalkSampling-32"><a href="#FDRandomWalkSampling-32"><span class="linenos"> 32</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FDRandomWalkSampling-33"><a href="#FDRandomWalkSampling-33"><span class="linenos"> 33</span></a>        <span class="n">dom</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FDRandomWalkSampling-34"><a href="#FDRandomWalkSampling-34"><span class="linenos"> 34</span></a>        <span class="n">prob</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FDRandomWalkSampling-35"><a href="#FDRandomWalkSampling-35"><span class="linenos"> 35</span></a>        <span class="n">problem_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FDRandomWalkSampling-36"><a href="#FDRandomWalkSampling-36"><span class="linenos"> 36</span></a>        <span class="n">observe_pres_effs</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="FDRandomWalkSampling-37"><a href="#FDRandomWalkSampling-37"><span class="linenos"> 37</span></a>        <span class="n">max_time</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span>
</span><span id="FDRandomWalkSampling-38"><a href="#FDRandomWalkSampling-38"><span class="linenos"> 38</span></a>        <span class="n">init_h</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FDRandomWalkSampling-39"><a href="#FDRandomWalkSampling-39"><span class="linenos"> 39</span></a>        <span class="n">num_traces</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="FDRandomWalkSampling-40"><a href="#FDRandomWalkSampling-40"><span class="linenos"> 40</span></a>        <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FDRandomWalkSampling-41"><a href="#FDRandomWalkSampling-41"><span class="linenos"> 41</span></a>    <span class="p">):</span>
</span><span id="FDRandomWalkSampling-42"><a href="#FDRandomWalkSampling-42"><span class="linenos"> 42</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FDRandomWalkSampling-43"><a href="#FDRandomWalkSampling-43"><span class="linenos"> 43</span></a><span class="sd">        Initializes a the fd random walk sampler.</span>
</span><span id="FDRandomWalkSampling-44"><a href="#FDRandomWalkSampling-44"><span class="linenos"> 44</span></a>
</span><span id="FDRandomWalkSampling-45"><a href="#FDRandomWalkSampling-45"><span class="linenos"> 45</span></a><span class="sd">        Args:</span>
</span><span id="FDRandomWalkSampling-46"><a href="#FDRandomWalkSampling-46"><span class="linenos"> 46</span></a><span class="sd">            dom (str):</span>
</span><span id="FDRandomWalkSampling-47"><a href="#FDRandomWalkSampling-47"><span class="linenos"> 47</span></a><span class="sd">                The domain filename.</span>
</span><span id="FDRandomWalkSampling-48"><a href="#FDRandomWalkSampling-48"><span class="linenos"> 48</span></a><span class="sd">            prob (str):</span>
</span><span id="FDRandomWalkSampling-49"><a href="#FDRandomWalkSampling-49"><span class="linenos"> 49</span></a><span class="sd">                The problem filename.</span>
</span><span id="FDRandomWalkSampling-50"><a href="#FDRandomWalkSampling-50"><span class="linenos"> 50</span></a><span class="sd">            problem_id (int):</span>
</span><span id="FDRandomWalkSampling-51"><a href="#FDRandomWalkSampling-51"><span class="linenos"> 51</span></a><span class="sd">                The ID of the problem to access.</span>
</span><span id="FDRandomWalkSampling-52"><a href="#FDRandomWalkSampling-52"><span class="linenos"> 52</span></a><span class="sd">            observe_pres_effs (bool):</span>
</span><span id="FDRandomWalkSampling-53"><a href="#FDRandomWalkSampling-53"><span class="linenos"> 53</span></a><span class="sd">                Option to observe action preconditions and effects upon generation.</span>
</span><span id="FDRandomWalkSampling-54"><a href="#FDRandomWalkSampling-54"><span class="linenos"> 54</span></a><span class="sd">            max_time (float):</span>
</span><span id="FDRandomWalkSampling-55"><a href="#FDRandomWalkSampling-55"><span class="linenos"> 55</span></a><span class="sd">                The maximum time allowed for a trace to be generated.</span>
</span><span id="FDRandomWalkSampling-56"><a href="#FDRandomWalkSampling-56"><span class="linenos"> 56</span></a><span class="sd">            init_h (int):</span>
</span><span id="FDRandomWalkSampling-57"><a href="#FDRandomWalkSampling-57"><span class="linenos"> 57</span></a><span class="sd">                The estimated initial heuristic value. Defaults to 10.</span>
</span><span id="FDRandomWalkSampling-58"><a href="#FDRandomWalkSampling-58"><span class="linenos"> 58</span></a><span class="sd">            num_traces (int):</span>
</span><span id="FDRandomWalkSampling-59"><a href="#FDRandomWalkSampling-59"><span class="linenos"> 59</span></a><span class="sd">                The number of traces to generate. Defaults to 1.</span>
</span><span id="FDRandomWalkSampling-60"><a href="#FDRandomWalkSampling-60"><span class="linenos"> 60</span></a><span class="sd">            seed (int):</span>
</span><span id="FDRandomWalkSampling-61"><a href="#FDRandomWalkSampling-61"><span class="linenos"> 61</span></a><span class="sd">                The seed for the random number generator.</span>
</span><span id="FDRandomWalkSampling-62"><a href="#FDRandomWalkSampling-62"><span class="linenos"> 62</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FDRandomWalkSampling-63"><a href="#FDRandomWalkSampling-63"><span class="linenos"> 63</span></a>
</span><span id="FDRandomWalkSampling-64"><a href="#FDRandomWalkSampling-64"><span class="linenos"> 64</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="FDRandomWalkSampling-65"><a href="#FDRandomWalkSampling-65"><span class="linenos"> 65</span></a>            <span class="n">dom</span><span class="o">=</span><span class="n">dom</span><span class="p">,</span>
</span><span id="FDRandomWalkSampling-66"><a href="#FDRandomWalkSampling-66"><span class="linenos"> 66</span></a>            <span class="n">prob</span><span class="o">=</span><span class="n">prob</span><span class="p">,</span>
</span><span id="FDRandomWalkSampling-67"><a href="#FDRandomWalkSampling-67"><span class="linenos"> 67</span></a>            <span class="n">problem_id</span><span class="o">=</span><span class="n">problem_id</span><span class="p">,</span>
</span><span id="FDRandomWalkSampling-68"><a href="#FDRandomWalkSampling-68"><span class="linenos"> 68</span></a>            <span class="n">observe_pres_effs</span><span class="o">=</span><span class="n">observe_pres_effs</span><span class="p">,</span>
</span><span id="FDRandomWalkSampling-69"><a href="#FDRandomWalkSampling-69"><span class="linenos"> 69</span></a>            <span class="n">num_traces</span><span class="o">=</span><span class="n">num_traces</span><span class="p">,</span>
</span><span id="FDRandomWalkSampling-70"><a href="#FDRandomWalkSampling-70"><span class="linenos"> 70</span></a>            <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span>
</span><span id="FDRandomWalkSampling-71"><a href="#FDRandomWalkSampling-71"><span class="linenos"> 71</span></a>            <span class="n">max_time</span><span class="o">=</span><span class="n">max_time</span><span class="p">,</span>
</span><span id="FDRandomWalkSampling-72"><a href="#FDRandomWalkSampling-72"><span class="linenos"> 72</span></a>        <span class="p">)</span>
</span><span id="FDRandomWalkSampling-73"><a href="#FDRandomWalkSampling-73"><span class="linenos"> 73</span></a>
</span><span id="FDRandomWalkSampling-74"><a href="#FDRandomWalkSampling-74"><span class="linenos"> 74</span></a>        <span class="k">if</span> <span class="n">init_h</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FDRandomWalkSampling-75"><a href="#FDRandomWalkSampling-75"><span class="linenos"> 75</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">init_h</span> <span class="o">=</span> <span class="mi">10</span>
</span><span id="FDRandomWalkSampling-76"><a href="#FDRandomWalkSampling-76"><span class="linenos"> 76</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FDRandomWalkSampling-77"><a href="#FDRandomWalkSampling-77"><span class="linenos"> 77</span></a>            <span class="c1"># From the FastDownward planning system:</span>
</span><span id="FDRandomWalkSampling-78"><a href="#FDRandomWalkSampling-78"><span class="linenos"> 78</span></a>            <span class="c1">#</span>
</span><span id="FDRandomWalkSampling-79"><a href="#FDRandomWalkSampling-79"><span class="linenos"> 79</span></a>            <span class="c1">#   Convert heuristic value into an approximate number of actions</span>
</span><span id="FDRandomWalkSampling-80"><a href="#FDRandomWalkSampling-80"><span class="linenos"> 80</span></a>            <span class="c1">#   (does nothing on unit-cost problems).</span>
</span><span id="FDRandomWalkSampling-81"><a href="#FDRandomWalkSampling-81"><span class="linenos"> 81</span></a>            <span class="c1">#</span>
</span><span id="FDRandomWalkSampling-82"><a href="#FDRandomWalkSampling-82"><span class="linenos"> 82</span></a>            <span class="c1">#   The expected walk length is np = 2 * estimated number of solution steps.</span>
</span><span id="FDRandomWalkSampling-83"><a href="#FDRandomWalkSampling-83"><span class="linenos"> 83</span></a>            <span class="c1">#   (We multiply by 2 because the heuristic is underestimating.)</span>
</span><span id="FDRandomWalkSampling-84"><a href="#FDRandomWalkSampling-84"><span class="linenos"> 84</span></a>            <span class="n">avg_op_cost</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_avg_op_cost</span><span class="p">()</span>
</span><span id="FDRandomWalkSampling-85"><a href="#FDRandomWalkSampling-85"><span class="linenos"> 85</span></a>            <span class="k">assert</span> <span class="n">avg_op_cost</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Average operator cost must be greater than 0&quot;</span>
</span><span id="FDRandomWalkSampling-86"><a href="#FDRandomWalkSampling-86"><span class="linenos"> 86</span></a>            <span class="n">sol_steps</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">init_h</span> <span class="o">/</span> <span class="n">avg_op_cost</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.5</span><span class="p">)</span>
</span><span id="FDRandomWalkSampling-87"><a href="#FDRandomWalkSampling-87"><span class="linenos"> 87</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">init_h</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">sol_steps</span>
</span><span id="FDRandomWalkSampling-88"><a href="#FDRandomWalkSampling-88"><span class="linenos"> 88</span></a>
</span><span id="FDRandomWalkSampling-89"><a href="#FDRandomWalkSampling-89"><span class="linenos"> 89</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">plan_len</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plan_len</span>
</span><span id="FDRandomWalkSampling-90"><a href="#FDRandomWalkSampling-90"><span class="linenos"> 90</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">traces</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_traces</span><span class="p">()</span>
</span><span id="FDRandomWalkSampling-91"><a href="#FDRandomWalkSampling-91"><span class="linenos"> 91</span></a>
</span><span id="FDRandomWalkSampling-92"><a href="#FDRandomWalkSampling-92"><span class="linenos"> 92</span></a>    <span class="k">def</span> <span class="nf">_plan_len</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FDRandomWalkSampling-93"><a href="#FDRandomWalkSampling-93"><span class="linenos"> 93</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Samples the target plan length from the heuristic value&quot;&quot;&quot;</span>
</span><span id="FDRandomWalkSampling-94"><a href="#FDRandomWalkSampling-94"><span class="linenos"> 94</span></a>
</span><span id="FDRandomWalkSampling-95"><a href="#FDRandomWalkSampling-95"><span class="linenos"> 95</span></a>        <span class="n">p</span> <span class="o">=</span> <span class="mf">0.5</span>
</span><span id="FDRandomWalkSampling-96"><a href="#FDRandomWalkSampling-96"><span class="linenos"> 96</span></a>
</span><span id="FDRandomWalkSampling-97"><a href="#FDRandomWalkSampling-97"><span class="linenos"> 97</span></a>        <span class="c1"># Length is based on the binomial distribution</span>
</span><span id="FDRandomWalkSampling-98"><a href="#FDRandomWalkSampling-98"><span class="linenos"> 98</span></a>        <span class="n">depth</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="FDRandomWalkSampling-99"><a href="#FDRandomWalkSampling-99"><span class="linenos"> 99</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">init_h</span><span class="p">):</span>
</span><span id="FDRandomWalkSampling-100"><a href="#FDRandomWalkSampling-100"><span class="linenos">100</span></a>            <span class="k">if</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">p</span><span class="p">:</span>
</span><span id="FDRandomWalkSampling-101"><a href="#FDRandomWalkSampling-101"><span class="linenos">101</span></a>                <span class="n">depth</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="FDRandomWalkSampling-102"><a href="#FDRandomWalkSampling-102"><span class="linenos">102</span></a>        <span class="k">return</span> <span class="n">depth</span>
</span><span id="FDRandomWalkSampling-103"><a href="#FDRandomWalkSampling-103"><span class="linenos">103</span></a>
</span><span id="FDRandomWalkSampling-104"><a href="#FDRandomWalkSampling-104"><span class="linenos">104</span></a>    <span class="k">def</span> <span class="nf">_avg_op_cost</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FDRandomWalkSampling-105"><a href="#FDRandomWalkSampling-105"><span class="linenos">105</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Computes the average operator cost&quot;&quot;&quot;</span>
</span><span id="FDRandomWalkSampling-106"><a href="#FDRandomWalkSampling-106"><span class="linenos">106</span></a>
</span><span id="FDRandomWalkSampling-107"><a href="#FDRandomWalkSampling-107"><span class="linenos">107</span></a>        <span class="k">def</span> <span class="nf">_op_cost</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
</span><span id="FDRandomWalkSampling-108"><a href="#FDRandomWalkSampling-108"><span class="linenos">108</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="o">.</span><span class="n">get_action</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">cost</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FDRandomWalkSampling-109"><a href="#FDRandomWalkSampling-109"><span class="linenos">109</span></a>                <span class="k">return</span> <span class="mi">1</span>
</span><span id="FDRandomWalkSampling-110"><a href="#FDRandomWalkSampling-110"><span class="linenos">110</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="FDRandomWalkSampling-111"><a href="#FDRandomWalkSampling-111"><span class="linenos">111</span></a>                <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="o">.</span><span class="n">get_action</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">cost</span><span class="o">.</span><span class="n">symbol</span><span class="p">)</span>
</span><span id="FDRandomWalkSampling-112"><a href="#FDRandomWalkSampling-112"><span class="linenos">112</span></a>
</span><span id="FDRandomWalkSampling-113"><a href="#FDRandomWalkSampling-113"><span class="linenos">113</span></a>        <span class="n">costs</span> <span class="o">=</span> <span class="p">{</span><span class="n">a</span><span class="p">:</span> <span class="n">_op_cost</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="o">.</span><span class="n">actions</span><span class="p">}</span>
</span><span id="FDRandomWalkSampling-114"><a href="#FDRandomWalkSampling-114"><span class="linenos">114</span></a>        <span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="FDRandomWalkSampling-115"><a href="#FDRandomWalkSampling-115"><span class="linenos">115</span></a>        <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">instance</span><span class="o">.</span><span class="n">operators</span><span class="p">:</span>
</span><span id="FDRandomWalkSampling-116"><a href="#FDRandomWalkSampling-116"><span class="linenos">116</span></a>            <span class="n">total</span> <span class="o">+=</span> <span class="n">costs</span><span class="p">[</span><span class="n">o</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;(&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span>
</span><span id="FDRandomWalkSampling-117"><a href="#FDRandomWalkSampling-117"><span class="linenos">117</span></a>        <span class="k">return</span> <span class="n">total</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">instance</span><span class="o">.</span><span class="n">operators</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Random Walk Sampler -- inherits from the VanillaSampling base class.</p>

<p>Follows the method laid out in the FastDownward planning system for conducting state samples:</p>

<ul>
<li><a href="https://github.com/aibasel/downward/blob/main/src/search/task_utils/sampling.cc">https://github.com/aibasel/downward/blob/main/src/search/task_utils/sampling.cc</a></li>
</ul>

<p>Taken from the FastDownward planning system:
    The walk length is taken from a binomial distribution centered around the
    estimated plan length, which is computed as the ratio of the h value of
    the initial state divided by the average operator costs. Whenever a dead
    end is detected or a state has no successors, restart from the initial
    state. The 'init_h' value should be an estimate of the solution cost.</p>

<p>Attributes:
    max_time(float):
        The maximum time allowed for a trace to be generated.
    init_h(int):
        Initial estimate of the cost to the goal.
    num_traces (int):
        The number of traces to be generated.
    traces (TraceList):
        The list of traces generated.</p>
</div>


                            <div id="FDRandomWalkSampling.__init__" class="classattr">
                                        <input id="FDRandomWalkSampling.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">FDRandomWalkSampling</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">dom</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">prob</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">problem_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">observe_pres_effs</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">max_time</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">30</span>,</span><span class="param">	<span class="n">init_h</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">num_traces</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>,</span><span class="param">	<span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="FDRandomWalkSampling.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FDRandomWalkSampling.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FDRandomWalkSampling.__init__-31"><a href="#FDRandomWalkSampling.__init__-31"><span class="linenos">31</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="FDRandomWalkSampling.__init__-32"><a href="#FDRandomWalkSampling.__init__-32"><span class="linenos">32</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FDRandomWalkSampling.__init__-33"><a href="#FDRandomWalkSampling.__init__-33"><span class="linenos">33</span></a>        <span class="n">dom</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FDRandomWalkSampling.__init__-34"><a href="#FDRandomWalkSampling.__init__-34"><span class="linenos">34</span></a>        <span class="n">prob</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FDRandomWalkSampling.__init__-35"><a href="#FDRandomWalkSampling.__init__-35"><span class="linenos">35</span></a>        <span class="n">problem_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FDRandomWalkSampling.__init__-36"><a href="#FDRandomWalkSampling.__init__-36"><span class="linenos">36</span></a>        <span class="n">observe_pres_effs</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="FDRandomWalkSampling.__init__-37"><a href="#FDRandomWalkSampling.__init__-37"><span class="linenos">37</span></a>        <span class="n">max_time</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span>
</span><span id="FDRandomWalkSampling.__init__-38"><a href="#FDRandomWalkSampling.__init__-38"><span class="linenos">38</span></a>        <span class="n">init_h</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FDRandomWalkSampling.__init__-39"><a href="#FDRandomWalkSampling.__init__-39"><span class="linenos">39</span></a>        <span class="n">num_traces</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="FDRandomWalkSampling.__init__-40"><a href="#FDRandomWalkSampling.__init__-40"><span class="linenos">40</span></a>        <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FDRandomWalkSampling.__init__-41"><a href="#FDRandomWalkSampling.__init__-41"><span class="linenos">41</span></a>    <span class="p">):</span>
</span><span id="FDRandomWalkSampling.__init__-42"><a href="#FDRandomWalkSampling.__init__-42"><span class="linenos">42</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FDRandomWalkSampling.__init__-43"><a href="#FDRandomWalkSampling.__init__-43"><span class="linenos">43</span></a><span class="sd">        Initializes a the fd random walk sampler.</span>
</span><span id="FDRandomWalkSampling.__init__-44"><a href="#FDRandomWalkSampling.__init__-44"><span class="linenos">44</span></a>
</span><span id="FDRandomWalkSampling.__init__-45"><a href="#FDRandomWalkSampling.__init__-45"><span class="linenos">45</span></a><span class="sd">        Args:</span>
</span><span id="FDRandomWalkSampling.__init__-46"><a href="#FDRandomWalkSampling.__init__-46"><span class="linenos">46</span></a><span class="sd">            dom (str):</span>
</span><span id="FDRandomWalkSampling.__init__-47"><a href="#FDRandomWalkSampling.__init__-47"><span class="linenos">47</span></a><span class="sd">                The domain filename.</span>
</span><span id="FDRandomWalkSampling.__init__-48"><a href="#FDRandomWalkSampling.__init__-48"><span class="linenos">48</span></a><span class="sd">            prob (str):</span>
</span><span id="FDRandomWalkSampling.__init__-49"><a href="#FDRandomWalkSampling.__init__-49"><span class="linenos">49</span></a><span class="sd">                The problem filename.</span>
</span><span id="FDRandomWalkSampling.__init__-50"><a href="#FDRandomWalkSampling.__init__-50"><span class="linenos">50</span></a><span class="sd">            problem_id (int):</span>
</span><span id="FDRandomWalkSampling.__init__-51"><a href="#FDRandomWalkSampling.__init__-51"><span class="linenos">51</span></a><span class="sd">                The ID of the problem to access.</span>
</span><span id="FDRandomWalkSampling.__init__-52"><a href="#FDRandomWalkSampling.__init__-52"><span class="linenos">52</span></a><span class="sd">            observe_pres_effs (bool):</span>
</span><span id="FDRandomWalkSampling.__init__-53"><a href="#FDRandomWalkSampling.__init__-53"><span class="linenos">53</span></a><span class="sd">                Option to observe action preconditions and effects upon generation.</span>
</span><span id="FDRandomWalkSampling.__init__-54"><a href="#FDRandomWalkSampling.__init__-54"><span class="linenos">54</span></a><span class="sd">            max_time (float):</span>
</span><span id="FDRandomWalkSampling.__init__-55"><a href="#FDRandomWalkSampling.__init__-55"><span class="linenos">55</span></a><span class="sd">                The maximum time allowed for a trace to be generated.</span>
</span><span id="FDRandomWalkSampling.__init__-56"><a href="#FDRandomWalkSampling.__init__-56"><span class="linenos">56</span></a><span class="sd">            init_h (int):</span>
</span><span id="FDRandomWalkSampling.__init__-57"><a href="#FDRandomWalkSampling.__init__-57"><span class="linenos">57</span></a><span class="sd">                The estimated initial heuristic value. Defaults to 10.</span>
</span><span id="FDRandomWalkSampling.__init__-58"><a href="#FDRandomWalkSampling.__init__-58"><span class="linenos">58</span></a><span class="sd">            num_traces (int):</span>
</span><span id="FDRandomWalkSampling.__init__-59"><a href="#FDRandomWalkSampling.__init__-59"><span class="linenos">59</span></a><span class="sd">                The number of traces to generate. Defaults to 1.</span>
</span><span id="FDRandomWalkSampling.__init__-60"><a href="#FDRandomWalkSampling.__init__-60"><span class="linenos">60</span></a><span class="sd">            seed (int):</span>
</span><span id="FDRandomWalkSampling.__init__-61"><a href="#FDRandomWalkSampling.__init__-61"><span class="linenos">61</span></a><span class="sd">                The seed for the random number generator.</span>
</span><span id="FDRandomWalkSampling.__init__-62"><a href="#FDRandomWalkSampling.__init__-62"><span class="linenos">62</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FDRandomWalkSampling.__init__-63"><a href="#FDRandomWalkSampling.__init__-63"><span class="linenos">63</span></a>
</span><span id="FDRandomWalkSampling.__init__-64"><a href="#FDRandomWalkSampling.__init__-64"><span class="linenos">64</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="FDRandomWalkSampling.__init__-65"><a href="#FDRandomWalkSampling.__init__-65"><span class="linenos">65</span></a>            <span class="n">dom</span><span class="o">=</span><span class="n">dom</span><span class="p">,</span>
</span><span id="FDRandomWalkSampling.__init__-66"><a href="#FDRandomWalkSampling.__init__-66"><span class="linenos">66</span></a>            <span class="n">prob</span><span class="o">=</span><span class="n">prob</span><span class="p">,</span>
</span><span id="FDRandomWalkSampling.__init__-67"><a href="#FDRandomWalkSampling.__init__-67"><span class="linenos">67</span></a>            <span class="n">problem_id</span><span class="o">=</span><span class="n">problem_id</span><span class="p">,</span>
</span><span id="FDRandomWalkSampling.__init__-68"><a href="#FDRandomWalkSampling.__init__-68"><span class="linenos">68</span></a>            <span class="n">observe_pres_effs</span><span class="o">=</span><span class="n">observe_pres_effs</span><span class="p">,</span>
</span><span id="FDRandomWalkSampling.__init__-69"><a href="#FDRandomWalkSampling.__init__-69"><span class="linenos">69</span></a>            <span class="n">num_traces</span><span class="o">=</span><span class="n">num_traces</span><span class="p">,</span>
</span><span id="FDRandomWalkSampling.__init__-70"><a href="#FDRandomWalkSampling.__init__-70"><span class="linenos">70</span></a>            <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span>
</span><span id="FDRandomWalkSampling.__init__-71"><a href="#FDRandomWalkSampling.__init__-71"><span class="linenos">71</span></a>            <span class="n">max_time</span><span class="o">=</span><span class="n">max_time</span><span class="p">,</span>
</span><span id="FDRandomWalkSampling.__init__-72"><a href="#FDRandomWalkSampling.__init__-72"><span class="linenos">72</span></a>        <span class="p">)</span>
</span><span id="FDRandomWalkSampling.__init__-73"><a href="#FDRandomWalkSampling.__init__-73"><span class="linenos">73</span></a>
</span><span id="FDRandomWalkSampling.__init__-74"><a href="#FDRandomWalkSampling.__init__-74"><span class="linenos">74</span></a>        <span class="k">if</span> <span class="n">init_h</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FDRandomWalkSampling.__init__-75"><a href="#FDRandomWalkSampling.__init__-75"><span class="linenos">75</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">init_h</span> <span class="o">=</span> <span class="mi">10</span>
</span><span id="FDRandomWalkSampling.__init__-76"><a href="#FDRandomWalkSampling.__init__-76"><span class="linenos">76</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FDRandomWalkSampling.__init__-77"><a href="#FDRandomWalkSampling.__init__-77"><span class="linenos">77</span></a>            <span class="c1"># From the FastDownward planning system:</span>
</span><span id="FDRandomWalkSampling.__init__-78"><a href="#FDRandomWalkSampling.__init__-78"><span class="linenos">78</span></a>            <span class="c1">#</span>
</span><span id="FDRandomWalkSampling.__init__-79"><a href="#FDRandomWalkSampling.__init__-79"><span class="linenos">79</span></a>            <span class="c1">#   Convert heuristic value into an approximate number of actions</span>
</span><span id="FDRandomWalkSampling.__init__-80"><a href="#FDRandomWalkSampling.__init__-80"><span class="linenos">80</span></a>            <span class="c1">#   (does nothing on unit-cost problems).</span>
</span><span id="FDRandomWalkSampling.__init__-81"><a href="#FDRandomWalkSampling.__init__-81"><span class="linenos">81</span></a>            <span class="c1">#</span>
</span><span id="FDRandomWalkSampling.__init__-82"><a href="#FDRandomWalkSampling.__init__-82"><span class="linenos">82</span></a>            <span class="c1">#   The expected walk length is np = 2 * estimated number of solution steps.</span>
</span><span id="FDRandomWalkSampling.__init__-83"><a href="#FDRandomWalkSampling.__init__-83"><span class="linenos">83</span></a>            <span class="c1">#   (We multiply by 2 because the heuristic is underestimating.)</span>
</span><span id="FDRandomWalkSampling.__init__-84"><a href="#FDRandomWalkSampling.__init__-84"><span class="linenos">84</span></a>            <span class="n">avg_op_cost</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_avg_op_cost</span><span class="p">()</span>
</span><span id="FDRandomWalkSampling.__init__-85"><a href="#FDRandomWalkSampling.__init__-85"><span class="linenos">85</span></a>            <span class="k">assert</span> <span class="n">avg_op_cost</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Average operator cost must be greater than 0&quot;</span>
</span><span id="FDRandomWalkSampling.__init__-86"><a href="#FDRandomWalkSampling.__init__-86"><span class="linenos">86</span></a>            <span class="n">sol_steps</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">init_h</span> <span class="o">/</span> <span class="n">avg_op_cost</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.5</span><span class="p">)</span>
</span><span id="FDRandomWalkSampling.__init__-87"><a href="#FDRandomWalkSampling.__init__-87"><span class="linenos">87</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">init_h</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">sol_steps</span>
</span><span id="FDRandomWalkSampling.__init__-88"><a href="#FDRandomWalkSampling.__init__-88"><span class="linenos">88</span></a>
</span><span id="FDRandomWalkSampling.__init__-89"><a href="#FDRandomWalkSampling.__init__-89"><span class="linenos">89</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">plan_len</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plan_len</span>
</span><span id="FDRandomWalkSampling.__init__-90"><a href="#FDRandomWalkSampling.__init__-90"><span class="linenos">90</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">traces</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_traces</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Initializes a the fd random walk sampler.</p>

<p>Args:
    dom (str):
        The domain filename.
    prob (str):
        The problem filename.
    problem_id (int):
        The ID of the problem to access.
    observe_pres_effs (bool):
        Option to observe action preconditions and effects upon generation.
    max_time (float):
        The maximum time allowed for a trace to be generated.
    init_h (int):
        The estimated initial heuristic value. Defaults to 10.
    num_traces (int):
        The number of traces to generate. Defaults to 1.
    seed (int):
        The seed for the random number generator.</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#VanillaSampling">VanillaSampling</a></dt>
                                <dd id="FDRandomWalkSampling.generate_traces" class="function"><a href="#VanillaSampling.generate_traces">generate_traces</a></dd>
                <dd id="FDRandomWalkSampling.generate_single_trace_setup" class="function"><a href="#VanillaSampling.generate_single_trace_setup">generate_single_trace_setup</a></dd>

            </div>
            <div><dt><a href="#Generator">Generator</a></dt>
                                <dd id="FDRandomWalkSampling.extract_action_typing" class="function"><a href="#Generator.extract_action_typing">extract_action_typing</a></dd>
                <dd id="FDRandomWalkSampling.extract_predicate_typing" class="function"><a href="#Generator.extract_predicate_typing">extract_predicate_typing</a></dd>
                <dd id="FDRandomWalkSampling.tarski_state_to_macq" class="function"><a href="#Generator.tarski_state_to_macq">tarski_state_to_macq</a></dd>
                <dd id="FDRandomWalkSampling.tarski_act_to_macq" class="function"><a href="#Generator.tarski_act_to_macq">tarski_act_to_macq</a></dd>
                <dd id="FDRandomWalkSampling.change_init" class="function"><a href="#Generator.change_init">change_init</a></dd>
                <dd id="FDRandomWalkSampling.change_goal" class="function"><a href="#Generator.change_goal">change_goal</a></dd>
                <dd id="FDRandomWalkSampling.generate_plan" class="function"><a href="#Generator.generate_plan">generate_plan</a></dd>
                <dd id="FDRandomWalkSampling.generate_single_trace_from_plan" class="function"><a href="#Generator.generate_single_trace_from_plan">generate_single_trace_from_plan</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>